

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Compare models &#8212; pimms_workflow 0.2.0b0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01_2_performance_plots';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="NAGuide R methods" href="01_1_train_NAGuideR_TRKNN.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">pimms_workflow 0.2.0b0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Comparison Workflow Notebooks
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Split creation and data handling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_0_split_data.html">Experiment 03 - Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_0_transform_data_to_wide_format.html">Transfer data for NAGuideR format</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PIMMS models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_1_train_Median.html">Median</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_DAE.html">DAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_KNN.html">KNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_VAE.html">VAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_CF.html">CF</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">R models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_QRILC.html">QRILC</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_IMPSEQ.html">IMPSEQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_transfer_NAGuideR_pred.html">transfer NAGuideR pred</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_MICE-NORM.html">MICE-NORM</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_IRM.html">IRM</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_MSIMPUTE_MNAR.html">MNAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_ROWMEDIAN.html">ROWMEDIAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_GSIMP.html">GSIMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_MLE.html">MLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_SVDMETHOD.html">SVDMETHOD</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_SEQKNN.html">SEQKNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_RF.html">RF</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_KNN_IMPUTE.html">IMPUTE</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_1_train_NAGuideR_TRKNN.html">TRKNN</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Imputation model comparison</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Compare models</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/01_2_performance_plots.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Compare models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Compare models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-completeness-across-entire-data">data completeness across entire data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-specifications">Model specifications</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-predictions-on-validation-and-test-data-split">Load predictions on validation and test data split</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-data">Validation data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-top-n-for-plotting-and-set-colors">Select top N for plotting and set colors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-per-sample">Correlation per sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-plot">Error plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-by-non-decimal-number-of-intensity">Error by non-decimal number of intensity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-data">test data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intensity-distribution-as-histogram">Intensity distribution as histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Correlation per sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-per-feature">Correlation per feature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Error plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-error-by-median-feature-intensity">Plot error by median feature intensity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-model-selection">Custom model selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Error by non-decimal number of intensity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figures-dumped-to-disk">Figures dumped to disk</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="compare-models">
<h1>Compare models<a class="headerlink" href="#compare-models" title="Permalink to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Load available configurations</p></li>
<li><p>Load validation predictions</p>
<ul class="simple">
<li><p>calculate absolute error</p></li>
<li><p>select top N for plotting by MAE from smallest (best) to largest (worst) (top N as specified, default 5)</p></li>
<li><p>correlation per sample, correlation per feat, correlation overall</p></li>
<li><p>MAE plots</p></li>
</ul>
</li>
<li><p>Load test data predictions</p>
<ul class="simple">
<li><p>as for validation data</p></li>
<li><p>top N based on validation data</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">vaep</span>
<span class="kn">import</span> <span class="nn">vaep.imputation</span>
<span class="kn">import</span> <span class="nn">vaep.models</span>
<span class="kn">import</span> <span class="nn">vaep.nb</span>
<span class="kn">from</span> <span class="nn">vaep.analyzers</span> <span class="kn">import</span> <span class="n">compare_predictions</span>
<span class="kn">from</span> <span class="nn">vaep.io</span> <span class="kn">import</span> <span class="n">datasplits</span>
<span class="kn">from</span> <span class="nn">vaep.models.collect_dumps</span> <span class="kn">import</span> <span class="n">collect</span><span class="p">,</span> <span class="n">select_content</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">min_rows</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_colwidth</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)})</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">make_large_descriptors</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">setup_nb_logger</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;fontTools&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">load_config_file</span><span class="p">(</span><span class="n">fname</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">first_split</span><span class="o">=</span><span class="s1">&#39;config_&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">loaded</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">select_content</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span><span class="w"> </span><span class="n">first_split</span><span class="o">=</span><span class="n">first_split</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">loaded</span>


<span class="k">def</span> <span class="nf">build_text</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;latent_dim&quot;</span><span class="p">]):</span>
        <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;LD: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;latent_dim&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1"> &#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">]):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">])</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;HL: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># nan</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># catch passed parameters</span>
<span class="n">args</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Papermill script parameters:</p>
<div class="cell tag_parameters docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># files and folders</span>
<span class="c1"># Datasplit folder with data for experiment</span>
<span class="n">folder_experiment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;runs/example&#39;</span>
<span class="n">folder_data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># specify data directory if needed</span>
<span class="n">file_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;csv&#39;</span>  <span class="c1"># change default to pickled files</span>
<span class="c1"># Machine parsed metadata from rawfile workflow</span>
<span class="n">fn_rawfile_metadata</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv&#39;</span>
<span class="n">models</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Median,CF,DAE,VAE&#39;</span>  <span class="c1"># picked models to compare (comma separated)</span>
<span class="n">sel_models</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># user defined comparison (comma separated)</span>
<span class="c1"># Restrict plotting to top N methods for imputation based on error of validation data, maximum 10</span>
<span class="n">plot_to_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">feat_name_display</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># display name for feature name in plural (e.g. &#39;protein groups&#39;)</span>
<span class="n">save_agg_pred</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># save aggregated predictions of validation and test data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_injected-parameters docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">fn_rawfile_metadata</span> <span class="o">=</span> <span class="s2">&quot;data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv&quot;</span>
<span class="n">folder_experiment</span> <span class="o">=</span> <span class="s2">&quot;runs/example&quot;</span>
<span class="n">models</span> <span class="o">=</span> <span class="s2">&quot;Median,CF,DAE,VAE,KNN,ROWMEDIAN,KNN_IMPUTE,SEQKNN,RF,IMPSEQ,QRILC,SVDMETHOD,MICE-NORM,MLE,IRM,TRKNN,MSIMPUTE_MNAR,GSIMP&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Some argument transformations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">nb</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">())</span>
<span class="n">args</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root - INFO     Removed from global namespace: folder_experiment
root - INFO     Removed from global namespace: folder_data
root - INFO     Removed from global namespace: file_format
root - INFO     Removed from global namespace: fn_rawfile_metadata
root - INFO     Removed from global namespace: models
root - INFO     Removed from global namespace: sel_models
root - INFO     Removed from global namespace: plot_to_n
root - INFO     Removed from global namespace: feat_name_display
root - INFO     Removed from global namespace: save_agg_pred
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;folder_experiment&#39;: &#39;runs/example&#39;,
 &#39;folder_data&#39;: &#39;&#39;,
 &#39;file_format&#39;: &#39;csv&#39;,
 &#39;fn_rawfile_metadata&#39;: &#39;data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv&#39;,
 &#39;models&#39;: &#39;Median,CF,DAE,VAE,KNN,ROWMEDIAN,KNN_IMPUTE,SEQKNN,RF,IMPSEQ,QRILC,SVDMETHOD,MICE-NORM,MLE,IRM,TRKNN,MSIMPUTE_MNAR,GSIMP&#39;,
 &#39;sel_models&#39;: &#39;&#39;,
 &#39;plot_to_n&#39;: 5,
 &#39;feat_name_display&#39;: None,
 &#39;save_agg_pred&#39;: False}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">nb</span><span class="o">.</span><span class="n">args_from_dict</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="n">args</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;data&#39;: Path(&#39;runs/example/data&#39;),
 &#39;feat_name_display&#39;: None,
 &#39;file_format&#39;: &#39;csv&#39;,
 &#39;fn_rawfile_metadata&#39;: &#39;data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv&#39;,
 &#39;folder_data&#39;: &#39;&#39;,
 &#39;folder_experiment&#39;: Path(&#39;runs/example&#39;),
 &#39;models&#39;: &#39;Median,CF,DAE,VAE,KNN,ROWMEDIAN,KNN_IMPUTE,SEQKNN,RF,IMPSEQ,QRILC,SVDMETHOD,MICE-NORM,MLE,IRM,TRKNN,MSIMPUTE_MNAR,GSIMP&#39;,
 &#39;out_figures&#39;: Path(&#39;runs/example/figures&#39;),
 &#39;out_folder&#39;: Path(&#39;runs/example&#39;),
 &#39;out_metrics&#39;: Path(&#39;runs/example&#39;),
 &#39;out_models&#39;: Path(&#39;runs/example&#39;),
 &#39;out_preds&#39;: Path(&#39;runs/example/preds&#39;),
 &#39;plot_to_n&#39;: 5,
 &#39;save_agg_pred&#39;: False,
 &#39;sel_models&#39;: &#39;&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figures</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dumps</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TARGET_COL</span> <span class="o">=</span> <span class="s1">&#39;observed&#39;</span>
<span class="n">METRIC</span> <span class="o">=</span> <span class="s1">&#39;MAE&#39;</span>
<span class="n">MIN_FREQ</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">MODELS_PASSED</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">MODELS</span> <span class="o">=</span> <span class="n">MODELS_PASSED</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">FEAT_NAME_DISPLAY</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">feat_name_display</span>
<span class="n">SEL_MODELS</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sel_models</span><span class="p">:</span>
    <span class="n">SEL_MODELS</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">sel_models</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list(sns.color_palette().as_hex()) # string representation of colors</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">plot_to_n</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Set maximum of models to 10 (maximum)&quot;</span><span class="p">)</span>
    <span class="n">args</span><span class="o">.</span><span class="n">overwrite_entry</span><span class="p">(</span><span class="s1">&#39;plot_to_n&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">datasplits</span><span class="o">.</span><span class="n">DataSplits</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span>
    <span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">file_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.io.datasplits - INFO     Loaded &#39;train_X&#39; from file: runs/example/data/train_X.csv
vaep.io.datasplits - INFO     Loaded &#39;val_y&#39; from file: runs/example/data/val_y.csv
vaep.io.datasplits - INFO     Loaded &#39;test_y&#39; from file: runs/example/data/test_y.csv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">plot_observations</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">val_y</span><span class="o">.</span><span class="n">unstack</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Validation split&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">plot_observations</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">test_y</span><span class="o">.</span><span class="n">unstack</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Test split&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Simulated missing values per sample&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="c1"># hide axis and use only for common x label</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Samples ordered by identified </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">val_y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_fake_na_val_test_splits.png&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_fake_na_val_test_splits.png
</pre></div>
</div>
<img alt="_images/24ec23a46113246b93a17cfe2b55be8b90c892e2680c0fc76638587808c0f66a.png" src="_images/24ec23a46113246b93a17cfe2b55be8b90c892e2680c0fc76638587808c0f66a.png" />
</div>
</div>
<section id="data-completeness-across-entire-data">
<h2>data completeness across entire data<a class="headerlink" href="#data-completeness-across-entire-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load frequency of training features...</span>
<span class="c1"># needs to be pickle -&gt; index.name needed</span>
<span class="n">freq_feat</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">datasplits</span><span class="o">.</span><span class="n">load_freq</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s1">&#39;freq_features.json&#39;</span><span class="p">)</span>
<span class="n">freq_feat</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># training data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AAR2     45
ABCB6    35
ABHD11   30
ACAD9    50
ACTL6A   49
Name: freq, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="n">freq_feat</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">prop</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">val_y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Proportion of identification in samples&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Gene Names&#39;, ylabel=&#39;Proportion of identification in samples&#39;&gt;
</pre></div>
</div>
<img alt="_images/7b9145231941ced10d98af206b0c69e7d833fa2227b961bcb0bd615e1f2e5780.png" src="_images/7b9145231941ced10d98af206b0c69e7d833fa2227b961bcb0bd615e1f2e5780.png" />
</div>
</div>
<p>View training data in wide format</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_wide_format</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">train_X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Gene Names</th>
      <th>AAR2</th>
      <th>ABCB6</th>
      <th>ABHD11</th>
      <th>ACAD9</th>
      <th>ACTL6A</th>
      <th>ACTN1</th>
      <th>ACTR3</th>
      <th>ADAM10</th>
      <th>AHSA1</th>
      <th>AK3</th>
      <th>...</th>
      <th>WBSCR16</th>
      <th>WDR18</th>
      <th>WDR33</th>
      <th>WDR36</th>
      <th>WDR61</th>
      <th>WNK1</th>
      <th>YBX1</th>
      <th>YTHDF1</th>
      <th>YWHAH</th>
      <th>ZNF326</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>27.248</td>
      <td>24.472</td>
      <td>25.714</td>
      <td>28.542</td>
      <td>29.335</td>
      <td>30.837</td>
      <td>29.713</td>
      <td>26.702</td>
      <td>31.696</td>
      <td>26.337</td>
      <td>...</td>
      <td>26.360</td>
      <td>28.258</td>
      <td>25.507</td>
      <td>30.009</td>
      <td>28.345</td>
      <td>27.701</td>
      <td>32.374</td>
      <td>24.925</td>
      <td>29.609</td>
      <td>28.756</td>
    </tr>
    <tr>
      <th>2019_12_19_19_48_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>27.211</td>
      <td>23.775</td>
      <td>NaN</td>
      <td>28.437</td>
      <td>29.692</td>
      <td>30.635</td>
      <td>30.340</td>
      <td>25.929</td>
      <td>31.296</td>
      <td>25.415</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23.620</td>
      <td>29.348</td>
      <td>28.728</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>29.027</td>
      <td>28.393</td>
    </tr>
    <tr>
      <th>2019_12_20_14_15_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>27.377</td>
      <td>26.852</td>
      <td>26.046</td>
      <td>28.907</td>
      <td>30.369</td>
      <td>31.252</td>
      <td>30.715</td>
      <td>26.403</td>
      <td>NaN</td>
      <td>25.554</td>
      <td>...</td>
      <td>27.147</td>
      <td>28.335</td>
      <td>NaN</td>
      <td>30.563</td>
      <td>28.859</td>
      <td>28.405</td>
      <td>32.328</td>
      <td>25.498</td>
      <td>30.170</td>
      <td>29.208</td>
    </tr>
    <tr>
      <th>2019_12_27_12_29_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>NaN</td>
      <td>24.047</td>
      <td>24.788</td>
      <td>27.894</td>
      <td>29.359</td>
      <td>29.996</td>
      <td>29.686</td>
      <td>NaN</td>
      <td>30.882</td>
      <td>22.498</td>
      <td>...</td>
      <td>NaN</td>
      <td>28.228</td>
      <td>NaN</td>
      <td>29.497</td>
      <td>27.716</td>
      <td>27.349</td>
      <td>31.794</td>
      <td>24.701</td>
      <td>29.232</td>
      <td>28.139</td>
    </tr>
    <tr>
      <th>2019_12_29_15_06_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>26.520</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.164</td>
      <td>33.143</td>
      <td>30.985</td>
      <td>25.824</td>
      <td>31.145</td>
      <td>29.210</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26.818</td>
      <td>29.374</td>
      <td>29.407</td>
      <td>28.900</td>
      <td>32.443</td>
      <td>NaN</td>
      <td>30.615</td>
      <td>29.189</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020_05_27_13_57_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>28.294</td>
      <td>27.258</td>
      <td>27.386</td>
      <td>30.671</td>
      <td>31.671</td>
      <td>32.601</td>
      <td>32.223</td>
      <td>29.028</td>
      <td>NaN</td>
      <td>27.438</td>
      <td>...</td>
      <td>27.006</td>
      <td>30.132</td>
      <td>28.042</td>
      <td>31.767</td>
      <td>30.773</td>
      <td>29.513</td>
      <td>33.780</td>
      <td>26.050</td>
      <td>31.650</td>
      <td>30.839</td>
    </tr>
    <tr>
      <th>2020_05_28_04_06_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>28.023</td>
      <td>27.669</td>
      <td>NaN</td>
      <td>30.908</td>
      <td>32.045</td>
      <td>32.831</td>
      <td>32.357</td>
      <td>NaN</td>
      <td>32.790</td>
      <td>NaN</td>
      <td>...</td>
      <td>27.433</td>
      <td>30.005</td>
      <td>28.055</td>
      <td>31.617</td>
      <td>30.620</td>
      <td>30.399</td>
      <td>34.001</td>
      <td>28.353</td>
      <td>31.478</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020_06_01_10_22_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>27.885</td>
      <td>NaN</td>
      <td>32.261</td>
      <td>30.111</td>
      <td>NaN</td>
      <td>29.862</td>
      <td>27.587</td>
      <td>...</td>
      <td>25.167</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28.168</td>
      <td>26.706</td>
      <td>31.973</td>
      <td>26.948</td>
      <td>30.807</td>
      <td>25.095</td>
    </tr>
    <tr>
      <th>2020_06_01_15_41_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>29.800</td>
      <td>32.668</td>
      <td>31.480</td>
      <td>NaN</td>
      <td>31.124</td>
      <td>28.298</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.356</td>
      <td>28.607</td>
      <td>28.165</td>
      <td>32.737</td>
      <td>NaN</td>
      <td>31.865</td>
      <td>26.918</td>
    </tr>
    <tr>
      <th>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td>28.088</td>
      <td>24.144</td>
      <td>25.995</td>
      <td>28.922</td>
      <td>30.728</td>
      <td>NaN</td>
      <td>31.189</td>
      <td>27.327</td>
      <td>31.784</td>
      <td>27.253</td>
      <td>...</td>
      <td>24.591</td>
      <td>29.100</td>
      <td>26.001</td>
      <td>30.593</td>
      <td>29.545</td>
      <td>27.444</td>
      <td>32.605</td>
      <td>25.548</td>
      <td>30.419</td>
      <td>29.720</td>
    </tr>
  </tbody>
</table>
<p>50 rows  376 columns</p>
</div></div></div>
</div>
<p>Number of samples and features:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_SAMPLES</span><span class="p">,</span> <span class="n">M_FEAT</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N samples: </span><span class="si">{</span><span class="n">N_SAMPLES</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">, M features: </span><span class="si">{</span><span class="n">M_FEAT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>N samples: 50, M features: 376
</pre></div>
</div>
</div>
</div>
<p>Collect outputs in excel file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">folder_experiment</span> <span class="o">/</span> <span class="s1">&#39;01_2_performance_summary.xlsx&#39;</span>
<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saving to: runs/example/01_2_performance_summary.xlsx
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-specifications">
<h2>Model specifications<a class="headerlink" href="#model-specifications" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>used for bar plot annotations</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># model_key could be used as key from config file</span>
<span class="o">?</span> load <span class="n">only</span> <span class="n">specified</span> configs<span class="o">?</span>
<span class="o">?</span> case<span class="p">:</span> <span class="n">no</span> <span class="n">config</span> <span class="n">file</span> available<span class="o">?</span>
<span class="n">all_configs</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span>
    <span class="n">paths</span><span class="o">=</span><span class="p">(</span><span class="n">fname</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">out_models</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
           <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;.yaml&#39;</span>
           <span class="ow">and</span> <span class="s1">&#39;model_config&#39;</span> <span class="ow">in</span> <span class="n">fname</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
    <span class="n">load_fn</span><span class="o">=</span><span class="n">load_config_file</span>
<span class="p">)</span>
<span class="n">model_configs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_configs</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">model_configs</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;model_params&#39;</span><span class="p">)</span>
<span class="n">model_configs</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Object `configs` not found.
Object `available` not found.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>model</th>
      <th>CF</th>
      <th>VAE</th>
      <th>Median</th>
      <th>DAE</th>
      <th>KNN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>M</th>
      <td>376</td>
      <td>376</td>
      <td>376</td>
      <td>376</td>
      <td>376</td>
    </tr>
    <tr>
      <th>batch_size</th>
      <td>4,096.000</td>
      <td>10.000</td>
      <td>NaN</td>
      <td>10.000</td>
      <td>64.000</td>
    </tr>
    <tr>
      <th>cuda</th>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>data</th>
      <td>runs/example/data</td>
      <td>runs/example/data</td>
      <td>runs/example/data</td>
      <td>runs/example/data</td>
      <td>runs/example/data</td>
    </tr>
    <tr>
      <th>epoch_trained</th>
      <td>3.000</td>
      <td>5.000</td>
      <td>NaN</td>
      <td>5.000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>epochs_max</th>
      <td>3.000</td>
      <td>5.000</td>
      <td>NaN</td>
      <td>5.000</td>
      <td>50.000</td>
    </tr>
    <tr>
      <th>file_format</th>
      <td>csv</td>
      <td>csv</td>
      <td>csv</td>
      <td>csv</td>
      <td>csv</td>
    </tr>
    <tr>
      <th>fn_rawfile_metadata</th>
      <td>data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv</td>
      <td>data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv</td>
      <td>data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv</td>
      <td>data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv</td>
      <td>data/dev_datasets/HeLa_6070/files_selected_metadata_N50.csv</td>
    </tr>
    <tr>
      <th>folder_data</th>
      <td></td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>folder_experiment</th>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
    </tr>
    <tr>
      <th>latent_dim</th>
      <td>50.000</td>
      <td>25.000</td>
      <td>NaN</td>
      <td>10.000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_key</th>
      <td>CF</td>
      <td>VAE</td>
      <td>Median</td>
      <td>DAE</td>
      <td>KNN</td>
    </tr>
    <tr>
      <th>n_params</th>
      <td>21828</td>
      <td>864290</td>
      <td>376</td>
      <td>398722</td>
      <td>1</td>
    </tr>
    <tr>
      <th>out_figures</th>
      <td>runs/example/figures</td>
      <td>runs/example/figures</td>
      <td>runs/example/figures</td>
      <td>runs/example/figures</td>
      <td>runs/example/figures</td>
    </tr>
    <tr>
      <th>out_folder</th>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
    </tr>
    <tr>
      <th>out_metrics</th>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
    </tr>
    <tr>
      <th>out_models</th>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
      <td>runs/example</td>
    </tr>
    <tr>
      <th>out_preds</th>
      <td>runs/example/preds</td>
      <td>runs/example/preds</td>
      <td>runs/example/preds</td>
      <td>runs/example/preds</td>
      <td>runs/example/preds</td>
    </tr>
    <tr>
      <th>patience</th>
      <td>1.000</td>
      <td>50.000</td>
      <td>NaN</td>
      <td>25.000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>sample_idx_position</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>save_pred_real_na</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>id</th>
      <td>CF</td>
      <td>VAE</td>
      <td>Median</td>
      <td>DAE</td>
      <td>KNN</td>
    </tr>
    <tr>
      <th>hidden_layers</th>
      <td>NaN</td>
      <td>[512, 256]</td>
      <td>NaN</td>
      <td>[512]</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>meta_cat_col</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>meta_date_col</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pred_test_Median</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>runs/example/preds/pred_test_Median.csv</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>pred_val_Median</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>runs/example/preds/pred_val_Median.csv</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>force_train</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>True</td>
    </tr>
    <tr>
      <th>neighbors</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Set Feature name (columns are features, rows are samples)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># index name</span>
<span class="n">freq_feat</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># sample index name</span>
<span class="n">sample_index_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-predictions-on-validation-and-test-data-split">
<h1>Load predictions on validation and test data split<a class="headerlink" href="#load-predictions-on-validation-and-test-data-split" title="Permalink to this heading">#</a></h1>
<section id="validation-data">
<h2>Validation data<a class="headerlink" href="#validation-data" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>set top N models to plot based on validation data split</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_val</span> <span class="o">=</span> <span class="n">compare_predictions</span><span class="o">.</span><span class="n">load_split_prediction_by_modelkey</span><span class="p">(</span>
    <span class="n">experiment_folder</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">folder_experiment</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">,</span>
    <span class="n">model_keys</span><span class="o">=</span><span class="n">MODELS_PASSED</span><span class="p">,</span>
    <span class="n">shared_columns</span><span class="o">=</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">])</span>
<span class="n">SAMPLE_ID</span><span class="p">,</span> <span class="n">FEAT_NAME</span> <span class="o">=</span> <span class="n">pred_val</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">FEAT_NAME_DISPLAY</span><span class="p">:</span>
    <span class="n">FEAT_NAME_DISPLAY</span> <span class="o">=</span> <span class="n">FEAT_NAME</span>
<span class="n">pred_val</span><span class="p">[</span><span class="n">MODELS</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Median</th>
      <th>CF</th>
      <th>DAE</th>
      <th>VAE</th>
      <th>KNN</th>
      <th>ROWMEDIAN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>RF</th>
      <th>IMPSEQ</th>
      <th>QRILC</th>
      <th>SVDMETHOD</th>
      <th>MICE-NORM</th>
      <th>MLE</th>
      <th>IRM</th>
      <th>TRKNN</th>
      <th>MSIMPUTE_MNAR</th>
      <th>GSIMP</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GEMIN5</th>
      <td>30.547</td>
      <td>28.586</td>
      <td>30.968</td>
      <td>30.045</td>
      <td>31.027</td>
      <td>30.547</td>
      <td>30.783</td>
      <td>30.551</td>
      <td>30.665</td>
      <td>29.521</td>
      <td>26.902</td>
      <td>28.035</td>
      <td>30.902</td>
      <td>2,355.271</td>
      <td>30.758</td>
      <td>30.756</td>
      <td>27.635</td>
      <td>27.398</td>
    </tr>
    <tr>
      <th>2020_02_28_12_27_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>AAR2</th>
      <td>26.880</td>
      <td>28.365</td>
      <td>26.860</td>
      <td>26.514</td>
      <td>26.595</td>
      <td>26.880</td>
      <td>26.674</td>
      <td>26.599</td>
      <td>26.520</td>
      <td>26.302</td>
      <td>24.980</td>
      <td>27.960</td>
      <td>26.823</td>
      <td>26.870</td>
      <td>26.794</td>
      <td>26.961</td>
      <td>24.500</td>
      <td>23.830</td>
    </tr>
    <tr>
      <th>2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ADAM10</th>
      <td>26.528</td>
      <td>28.495</td>
      <td>28.891</td>
      <td>27.787</td>
      <td>28.650</td>
      <td>26.528</td>
      <td>28.596</td>
      <td>28.428</td>
      <td>28.585</td>
      <td>29.055</td>
      <td>24.400</td>
      <td>29.658</td>
      <td>28.842</td>
      <td>2,348.865</td>
      <td>28.911</td>
      <td>28.814</td>
      <td>25.745</td>
      <td>22.319</td>
    </tr>
    <tr>
      <th>2020_01_04_14_59_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>NDUFAF4</th>
      <td>27.521</td>
      <td>28.289</td>
      <td>24.814</td>
      <td>26.330</td>
      <td>26.630</td>
      <td>27.521</td>
      <td>24.573</td>
      <td>25.095</td>
      <td>26.551</td>
      <td>23.806</td>
      <td>24.058</td>
      <td>27.192</td>
      <td>25.472</td>
      <td>27.860</td>
      <td>25.891</td>
      <td>25.077</td>
      <td>23.474</td>
      <td>25.276</td>
    </tr>
    <tr>
      <th>2020_05_27_13_57_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>EPN1</th>
      <td>26.839</td>
      <td>28.397</td>
      <td>29.073</td>
      <td>29.615</td>
      <td>29.169</td>
      <td>26.839</td>
      <td>28.883</td>
      <td>28.931</td>
      <td>28.970</td>
      <td>28.563</td>
      <td>24.492</td>
      <td>29.782</td>
      <td>28.702</td>
      <td>2,288.717</td>
      <td>28.369</td>
      <td>29.564</td>
      <td>26.330</td>
      <td>22.695</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020_03_01_23_00_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PRRC2B</th>
      <td>25.077</td>
      <td>28.335</td>
      <td>24.519</td>
      <td>25.221</td>
      <td>24.616</td>
      <td>25.077</td>
      <td>24.958</td>
      <td>25.168</td>
      <td>24.502</td>
      <td>23.614</td>
      <td>22.225</td>
      <td>28.481</td>
      <td>24.419</td>
      <td>2,418.402</td>
      <td>23.864</td>
      <td>24.058</td>
      <td>22.365</td>
      <td>22.216</td>
    </tr>
    <tr>
      <th>2020_01_04_04_23_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ARGLU1</th>
      <td>27.816</td>
      <td>28.544</td>
      <td>28.647</td>
      <td>28.303</td>
      <td>28.777</td>
      <td>27.816</td>
      <td>28.949</td>
      <td>28.965</td>
      <td>28.703</td>
      <td>28.680</td>
      <td>25.409</td>
      <td>28.633</td>
      <td>29.740</td>
      <td>2,523.064</td>
      <td>29.102</td>
      <td>29.097</td>
      <td>25.545</td>
      <td>24.690</td>
    </tr>
    <tr>
      <th>2020_02_18_18_55_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GBF1</th>
      <td>28.381</td>
      <td>28.459</td>
      <td>29.250</td>
      <td>28.798</td>
      <td>29.269</td>
      <td>28.381</td>
      <td>28.976</td>
      <td>29.058</td>
      <td>29.248</td>
      <td>28.880</td>
      <td>25.916</td>
      <td>28.893</td>
      <td>29.235</td>
      <td>-719.987</td>
      <td>28.976</td>
      <td>29.213</td>
      <td>26.188</td>
      <td>24.650</td>
    </tr>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>DENR</th>
      <td>27.380</td>
      <td>28.312</td>
      <td>27.199</td>
      <td>27.009</td>
      <td>27.889</td>
      <td>27.380</td>
      <td>27.377</td>
      <td>27.731</td>
      <td>27.381</td>
      <td>27.311</td>
      <td>23.971</td>
      <td>28.033</td>
      <td>26.679</td>
      <td>2,355.271</td>
      <td>27.440</td>
      <td>27.107</td>
      <td>24.910</td>
      <td>23.957</td>
    </tr>
    <tr>
      <th>2020_05_12_21_07_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>SNRPF</th>
      <td>29.669</td>
      <td>28.544</td>
      <td>27.757</td>
      <td>28.737</td>
      <td>27.826</td>
      <td>29.669</td>
      <td>28.076</td>
      <td>28.127</td>
      <td>28.001</td>
      <td>27.666</td>
      <td>26.550</td>
      <td>26.690</td>
      <td>27.380</td>
      <td>26.635</td>
      <td>27.563</td>
      <td>27.898</td>
      <td>25.378</td>
      <td>27.020</td>
    </tr>
  </tbody>
</table>
<p>859 rows  18 columns</p>
</div></div></div>
</div>
<p>Describe absolute error</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_val</span>
              <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">TARGET_COL</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
              <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pred_val</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
              <span class="p">[</span><span class="n">MODELS</span><span class="p">])</span>
<span class="n">errors_val</span>  <span class="c1"># over all samples and all features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Median</th>
      <th>CF</th>
      <th>DAE</th>
      <th>VAE</th>
      <th>KNN</th>
      <th>ROWMEDIAN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>RF</th>
      <th>IMPSEQ</th>
      <th>QRILC</th>
      <th>SVDMETHOD</th>
      <th>MICE-NORM</th>
      <th>MLE</th>
      <th>IRM</th>
      <th>TRKNN</th>
      <th>MSIMPUTE_MNAR</th>
      <th>GSIMP</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GEMIN5</th>
      <td>-0.399</td>
      <td>-2.359</td>
      <td>0.022</td>
      <td>-0.901</td>
      <td>0.081</td>
      <td>-0.399</td>
      <td>-0.162</td>
      <td>-0.394</td>
      <td>-0.281</td>
      <td>-1.424</td>
      <td>-4.043</td>
      <td>-2.910</td>
      <td>-0.043</td>
      <td>2,324.325</td>
      <td>-0.187</td>
      <td>-0.189</td>
      <td>-3.311</td>
      <td>-3.548</td>
    </tr>
    <tr>
      <th>2020_02_28_12_27_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>AAR2</th>
      <td>-0.368</td>
      <td>1.117</td>
      <td>-0.388</td>
      <td>-0.734</td>
      <td>-0.653</td>
      <td>-0.368</td>
      <td>-0.574</td>
      <td>-0.649</td>
      <td>-0.728</td>
      <td>-0.946</td>
      <td>-2.268</td>
      <td>0.712</td>
      <td>-0.425</td>
      <td>-0.378</td>
      <td>-0.454</td>
      <td>-0.287</td>
      <td>-2.748</td>
      <td>-3.418</td>
    </tr>
    <tr>
      <th>2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ADAM10</th>
      <td>-2.782</td>
      <td>-0.815</td>
      <td>-0.418</td>
      <td>-1.523</td>
      <td>-0.660</td>
      <td>-2.782</td>
      <td>-0.713</td>
      <td>-0.882</td>
      <td>-0.724</td>
      <td>-0.255</td>
      <td>-4.910</td>
      <td>0.348</td>
      <td>-0.467</td>
      <td>2,319.555</td>
      <td>-0.399</td>
      <td>-0.496</td>
      <td>-3.565</td>
      <td>-6.990</td>
    </tr>
    <tr>
      <th>2020_01_04_14_59_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>NDUFAF4</th>
      <td>3.169</td>
      <td>3.937</td>
      <td>0.461</td>
      <td>1.978</td>
      <td>2.277</td>
      <td>3.169</td>
      <td>0.221</td>
      <td>0.743</td>
      <td>2.199</td>
      <td>-0.546</td>
      <td>-0.294</td>
      <td>2.840</td>
      <td>1.120</td>
      <td>3.508</td>
      <td>1.539</td>
      <td>0.725</td>
      <td>-0.878</td>
      <td>0.924</td>
    </tr>
    <tr>
      <th>2020_05_27_13_57_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>EPN1</th>
      <td>-2.412</td>
      <td>-0.854</td>
      <td>-0.178</td>
      <td>0.364</td>
      <td>-0.081</td>
      <td>-2.412</td>
      <td>-0.367</td>
      <td>-0.319</td>
      <td>-0.280</td>
      <td>-0.687</td>
      <td>-4.758</td>
      <td>0.531</td>
      <td>-0.549</td>
      <td>2,259.466</td>
      <td>-0.881</td>
      <td>0.313</td>
      <td>-2.921</td>
      <td>-6.555</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020_03_01_23_00_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PRRC2B</th>
      <td>0.784</td>
      <td>4.042</td>
      <td>0.225</td>
      <td>0.927</td>
      <td>0.322</td>
      <td>0.784</td>
      <td>0.664</td>
      <td>0.874</td>
      <td>0.208</td>
      <td>-0.679</td>
      <td>-2.069</td>
      <td>4.187</td>
      <td>0.125</td>
      <td>2,394.108</td>
      <td>-0.430</td>
      <td>-0.236</td>
      <td>-1.929</td>
      <td>-2.078</td>
    </tr>
    <tr>
      <th>2020_01_04_04_23_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ARGLU1</th>
      <td>-0.655</td>
      <td>0.073</td>
      <td>0.176</td>
      <td>-0.168</td>
      <td>0.306</td>
      <td>-0.655</td>
      <td>0.478</td>
      <td>0.494</td>
      <td>0.233</td>
      <td>0.209</td>
      <td>-3.062</td>
      <td>0.163</td>
      <td>1.270</td>
      <td>2,494.593</td>
      <td>0.631</td>
      <td>0.627</td>
      <td>-2.926</td>
      <td>-3.781</td>
    </tr>
    <tr>
      <th>2020_02_18_18_55_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GBF1</th>
      <td>-1.089</td>
      <td>-1.010</td>
      <td>-0.219</td>
      <td>-0.671</td>
      <td>-0.201</td>
      <td>-1.089</td>
      <td>-0.494</td>
      <td>-0.412</td>
      <td>-0.222</td>
      <td>-0.590</td>
      <td>-3.553</td>
      <td>-0.577</td>
      <td>-0.235</td>
      <td>-749.456</td>
      <td>-0.494</td>
      <td>-0.257</td>
      <td>-3.282</td>
      <td>-4.819</td>
    </tr>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>DENR</th>
      <td>-0.521</td>
      <td>0.411</td>
      <td>-0.703</td>
      <td>-0.892</td>
      <td>-0.013</td>
      <td>-0.521</td>
      <td>-0.525</td>
      <td>-0.171</td>
      <td>-0.520</td>
      <td>-0.590</td>
      <td>-3.930</td>
      <td>0.131</td>
      <td>-1.223</td>
      <td>2,327.369</td>
      <td>-0.462</td>
      <td>-0.795</td>
      <td>-2.992</td>
      <td>-3.945</td>
    </tr>
    <tr>
      <th>2020_05_12_21_07_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>SNRPF</th>
      <td>2.182</td>
      <td>1.057</td>
      <td>0.270</td>
      <td>1.250</td>
      <td>0.339</td>
      <td>2.182</td>
      <td>0.590</td>
      <td>0.640</td>
      <td>0.514</td>
      <td>0.179</td>
      <td>-0.937</td>
      <td>-0.797</td>
      <td>-0.107</td>
      <td>-0.852</td>
      <td>0.076</td>
      <td>0.411</td>
      <td>-2.108</td>
      <td>-0.466</td>
    </tr>
  </tbody>
</table>
<p>859 rows  18 columns</p>
</div></div></div>
</div>
<section id="select-top-n-for-plotting-and-set-colors">
<h3>Select top N for plotting and set colors<a class="headerlink" href="#select-top-n-for-plotting-and-set-colors" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ORDER_MODELS</span> <span class="o">=</span> <span class="p">(</span><span class="n">errors_val</span>
                <span class="o">.</span><span class="n">abs</span><span class="p">()</span>
                <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
                <span class="o">.</span><span class="n">index</span>
                <span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="n">ORDER_MODELS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;TRKNN&#39;,
 &#39;DAE&#39;,
 &#39;RF&#39;,
 &#39;KNN&#39;,
 &#39;KNN_IMPUTE&#39;,
 &#39;SEQKNN&#39;,
 &#39;MICE-NORM&#39;,
 &#39;IRM&#39;,
 &#39;VAE&#39;,
 &#39;IMPSEQ&#39;,
 &#39;ROWMEDIAN&#39;,
 &#39;Median&#39;,
 &#39;SVDMETHOD&#39;,
 &#39;CF&#39;,
 &#39;MSIMPUTE_MNAR&#39;,
 &#39;QRILC&#39;,
 &#39;GSIMP&#39;,
 &#39;MLE&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_val</span> <span class="o">=</span> <span class="n">pred_val</span><span class="p">[[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">ORDER_MODELS</span><span class="p">]</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">save_agg_pred</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">folder_experiment</span> <span class="o">/</span> <span class="s1">&#39;01_2_agg_pred_val.csv&#39;</span>
    <span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="n">pred_val</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved aggregated predictions to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pred_val</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>observed</th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GEMIN5</th>
      <td>30.946</td>
      <td>30.756</td>
      <td>30.968</td>
      <td>30.665</td>
      <td>31.027</td>
      <td>30.783</td>
      <td>30.551</td>
      <td>30.902</td>
      <td>30.758</td>
      <td>30.045</td>
      <td>29.521</td>
      <td>30.547</td>
      <td>30.547</td>
      <td>28.035</td>
      <td>28.586</td>
      <td>27.635</td>
      <td>26.902</td>
      <td>27.398</td>
      <td>2,355.271</td>
    </tr>
    <tr>
      <th>2020_02_28_12_27_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>AAR2</th>
      <td>27.248</td>
      <td>26.961</td>
      <td>26.860</td>
      <td>26.520</td>
      <td>26.595</td>
      <td>26.674</td>
      <td>26.599</td>
      <td>26.823</td>
      <td>26.794</td>
      <td>26.514</td>
      <td>26.302</td>
      <td>26.880</td>
      <td>26.880</td>
      <td>27.960</td>
      <td>28.365</td>
      <td>24.500</td>
      <td>24.980</td>
      <td>23.830</td>
      <td>26.870</td>
    </tr>
    <tr>
      <th>2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ADAM10</th>
      <td>29.310</td>
      <td>28.814</td>
      <td>28.891</td>
      <td>28.585</td>
      <td>28.650</td>
      <td>28.596</td>
      <td>28.428</td>
      <td>28.842</td>
      <td>28.911</td>
      <td>27.787</td>
      <td>29.055</td>
      <td>26.528</td>
      <td>26.528</td>
      <td>29.658</td>
      <td>28.495</td>
      <td>25.745</td>
      <td>24.400</td>
      <td>22.319</td>
      <td>2,348.865</td>
    </tr>
    <tr>
      <th>2020_01_04_14_59_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>NDUFAF4</th>
      <td>24.352</td>
      <td>25.077</td>
      <td>24.814</td>
      <td>26.551</td>
      <td>26.630</td>
      <td>24.573</td>
      <td>25.095</td>
      <td>25.472</td>
      <td>25.891</td>
      <td>26.330</td>
      <td>23.806</td>
      <td>27.521</td>
      <td>27.521</td>
      <td>27.192</td>
      <td>28.289</td>
      <td>23.474</td>
      <td>24.058</td>
      <td>25.276</td>
      <td>27.860</td>
    </tr>
    <tr>
      <th>2020_05_27_13_57_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>EPN1</th>
      <td>29.250</td>
      <td>29.564</td>
      <td>29.073</td>
      <td>28.970</td>
      <td>29.169</td>
      <td>28.883</td>
      <td>28.931</td>
      <td>28.702</td>
      <td>28.369</td>
      <td>29.615</td>
      <td>28.563</td>
      <td>26.839</td>
      <td>26.839</td>
      <td>29.782</td>
      <td>28.397</td>
      <td>26.330</td>
      <td>24.492</td>
      <td>22.695</td>
      <td>2,288.717</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020_03_01_23_00_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PRRC2B</th>
      <td>24.294</td>
      <td>24.058</td>
      <td>24.519</td>
      <td>24.502</td>
      <td>24.616</td>
      <td>24.958</td>
      <td>25.168</td>
      <td>24.419</td>
      <td>23.864</td>
      <td>25.221</td>
      <td>23.614</td>
      <td>25.077</td>
      <td>25.077</td>
      <td>28.481</td>
      <td>28.335</td>
      <td>22.365</td>
      <td>22.225</td>
      <td>22.216</td>
      <td>2,418.402</td>
    </tr>
    <tr>
      <th>2020_01_04_04_23_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ARGLU1</th>
      <td>28.471</td>
      <td>29.097</td>
      <td>28.647</td>
      <td>28.703</td>
      <td>28.777</td>
      <td>28.949</td>
      <td>28.965</td>
      <td>29.740</td>
      <td>29.102</td>
      <td>28.303</td>
      <td>28.680</td>
      <td>27.816</td>
      <td>27.816</td>
      <td>28.633</td>
      <td>28.544</td>
      <td>25.545</td>
      <td>25.409</td>
      <td>24.690</td>
      <td>2,523.064</td>
    </tr>
    <tr>
      <th>2020_02_18_18_55_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>GBF1</th>
      <td>29.470</td>
      <td>29.213</td>
      <td>29.250</td>
      <td>29.248</td>
      <td>29.269</td>
      <td>28.976</td>
      <td>29.058</td>
      <td>29.235</td>
      <td>28.976</td>
      <td>28.798</td>
      <td>28.880</td>
      <td>28.381</td>
      <td>28.381</td>
      <td>28.893</td>
      <td>28.459</td>
      <td>26.188</td>
      <td>25.916</td>
      <td>24.650</td>
      <td>-719.987</td>
    </tr>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>DENR</th>
      <td>27.902</td>
      <td>27.107</td>
      <td>27.199</td>
      <td>27.381</td>
      <td>27.889</td>
      <td>27.377</td>
      <td>27.731</td>
      <td>26.679</td>
      <td>27.440</td>
      <td>27.009</td>
      <td>27.311</td>
      <td>27.380</td>
      <td>27.380</td>
      <td>28.033</td>
      <td>28.312</td>
      <td>24.910</td>
      <td>23.971</td>
      <td>23.957</td>
      <td>2,355.271</td>
    </tr>
    <tr>
      <th>2020_05_12_21_07_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>SNRPF</th>
      <td>27.487</td>
      <td>27.898</td>
      <td>27.757</td>
      <td>28.001</td>
      <td>27.826</td>
      <td>28.076</td>
      <td>28.127</td>
      <td>27.380</td>
      <td>27.563</td>
      <td>28.737</td>
      <td>27.666</td>
      <td>29.669</td>
      <td>29.669</td>
      <td>26.690</td>
      <td>28.544</td>
      <td>25.378</td>
      <td>26.550</td>
      <td>27.020</td>
      <td>26.635</td>
    </tr>
  </tbody>
</table>
<p>859 rows  19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae_stats_ordered_val</span> <span class="o">=</span> <span class="n">errors_val</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="n">ORDER_MODELS</span><span class="p">]</span>
<span class="n">mae_stats_ordered_val</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;mae_stats_ordered_val&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mae_stats_ordered_val</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TRKNN</th>
      <td>859.000</td>
      <td>0.511</td>
      <td>0.604</td>
      <td>0.002</td>
      <td>0.155</td>
      <td>0.340</td>
      <td>0.663</td>
      <td>7.582</td>
    </tr>
    <tr>
      <th>DAE</th>
      <td>859.000</td>
      <td>0.535</td>
      <td>0.572</td>
      <td>0.000</td>
      <td>0.193</td>
      <td>0.379</td>
      <td>0.689</td>
      <td>6.492</td>
    </tr>
    <tr>
      <th>RF</th>
      <td>859.000</td>
      <td>0.536</td>
      <td>0.625</td>
      <td>0.000</td>
      <td>0.171</td>
      <td>0.367</td>
      <td>0.689</td>
      <td>7.249</td>
    </tr>
    <tr>
      <th>KNN</th>
      <td>859.000</td>
      <td>0.544</td>
      <td>0.612</td>
      <td>0.001</td>
      <td>0.160</td>
      <td>0.378</td>
      <td>0.696</td>
      <td>6.653</td>
    </tr>
    <tr>
      <th>KNN_IMPUTE</th>
      <td>859.000</td>
      <td>0.554</td>
      <td>0.624</td>
      <td>0.001</td>
      <td>0.165</td>
      <td>0.373</td>
      <td>0.712</td>
      <td>7.178</td>
    </tr>
    <tr>
      <th>SEQKNN</th>
      <td>859.000</td>
      <td>0.580</td>
      <td>0.665</td>
      <td>0.000</td>
      <td>0.165</td>
      <td>0.400</td>
      <td>0.775</td>
      <td>7.013</td>
    </tr>
    <tr>
      <th>MICE-NORM</th>
      <td>859.000</td>
      <td>0.593</td>
      <td>0.650</td>
      <td>0.000</td>
      <td>0.191</td>
      <td>0.422</td>
      <td>0.769</td>
      <td>8.729</td>
    </tr>
    <tr>
      <th>IRM</th>
      <td>859.000</td>
      <td>0.648</td>
      <td>0.679</td>
      <td>0.000</td>
      <td>0.203</td>
      <td>0.468</td>
      <td>0.868</td>
      <td>8.385</td>
    </tr>
    <tr>
      <th>VAE</th>
      <td>859.000</td>
      <td>0.717</td>
      <td>0.688</td>
      <td>0.001</td>
      <td>0.253</td>
      <td>0.527</td>
      <td>0.976</td>
      <td>6.662</td>
    </tr>
    <tr>
      <th>IMPSEQ</th>
      <td>859.000</td>
      <td>0.914</td>
      <td>1.037</td>
      <td>0.001</td>
      <td>0.271</td>
      <td>0.609</td>
      <td>1.164</td>
      <td>7.865</td>
    </tr>
    <tr>
      <th>ROWMEDIAN</th>
      <td>859.000</td>
      <td>1.028</td>
      <td>0.843</td>
      <td>0.006</td>
      <td>0.409</td>
      <td>0.846</td>
      <td>1.476</td>
      <td>6.386</td>
    </tr>
    <tr>
      <th>Median</th>
      <td>859.000</td>
      <td>1.028</td>
      <td>0.843</td>
      <td>0.006</td>
      <td>0.409</td>
      <td>0.846</td>
      <td>1.476</td>
      <td>6.386</td>
    </tr>
    <tr>
      <th>SVDMETHOD</th>
      <td>859.000</td>
      <td>1.763</td>
      <td>1.397</td>
      <td>0.000</td>
      <td>0.593</td>
      <td>1.459</td>
      <td>2.623</td>
      <td>8.031</td>
    </tr>
    <tr>
      <th>CF</th>
      <td>859.000</td>
      <td>1.905</td>
      <td>1.416</td>
      <td>0.006</td>
      <td>0.754</td>
      <td>1.655</td>
      <td>2.700</td>
      <td>7.825</td>
    </tr>
    <tr>
      <th>MSIMPUTE_MNAR</th>
      <td>859.000</td>
      <td>2.671</td>
      <td>0.999</td>
      <td>0.003</td>
      <td>2.131</td>
      <td>2.719</td>
      <td>3.276</td>
      <td>9.416</td>
    </tr>
    <tr>
      <th>QRILC</th>
      <td>859.000</td>
      <td>2.706</td>
      <td>1.556</td>
      <td>0.009</td>
      <td>1.592</td>
      <td>2.532</td>
      <td>3.567</td>
      <td>9.301</td>
    </tr>
    <tr>
      <th>GSIMP</th>
      <td>859.000</td>
      <td>2.994</td>
      <td>1.569</td>
      <td>0.048</td>
      <td>1.841</td>
      <td>2.834</td>
      <td>3.916</td>
      <td>10.067</td>
    </tr>
    <tr>
      <th>MLE</th>
      <td>859.000</td>
      <td>1,893.032</td>
      <td>968.191</td>
      <td>0.002</td>
      <td>2,221.099</td>
      <td>2,356.974</td>
      <td>2,438.467</td>
      <td>2,688.126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Some model have fixed colors, others are assigned randomly</p>
<blockquote>
<div><p>Note</p>
<ol class="arabic simple">
<li><p>The order of new models is important for the color assignment.</p></li>
<li><p>User defined model keys for the same model with two configuration will yield different colors.</p></li>
</ol>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">COLORS_TO_USE</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">assign_colors</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ORDER_MODELS</span><span class="p">))</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">ModelColorVisualizer</span><span class="p">(</span><span class="n">ORDER_MODELS</span><span class="p">,</span> <span class="n">COLORS_TO_USE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><svg  width="110" height="495.0"><rect x="0" y="0.0" width="110" height="27.5" style="fill:#33b07a;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="20.0" font-size="12" fill="black">TRKNN</text><rect x="0" y="27.5" width="110" height="27.5" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="47.5" font-size="12" fill="black">DAE</text><rect x="0" y="55.0" width="110" height="27.5" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="75.0" font-size="12" fill="black">RF</text><rect x="0" y="82.5" width="110" height="27.5" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="102.5" font-size="12" fill="black">KNN</text><rect x="0" y="110.0" width="110" height="27.5" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="130.0" font-size="12" fill="black">KNN_IMPUTE</text><rect x="0" y="137.5" width="110" height="27.5" style="fill:#c39532;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="157.5" font-size="12" fill="black">SEQKNN</text><rect x="0" y="165.0" width="110" height="27.5" style="fill:#dc8932;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="185.0" font-size="12" fill="black">MICE-NORM</text><rect x="0" y="192.5" width="110" height="27.5" style="fill:#36ada4;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="212.5" font-size="12" fill="black">IRM</text><rect x="0" y="220.0" width="110" height="27.5" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="240.0" font-size="12" fill="black">VAE</text><rect x="0" y="247.5" width="110" height="27.5" style="fill:#f77189;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="267.5" font-size="12" fill="black">IMPSEQ</text><rect x="0" y="275.0" width="110" height="27.5" style="fill:#37abb4;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="295.0" font-size="12" fill="black">ROWMEDIAN</text><rect x="0" y="302.5" width="110" height="27.5" style="fill:#38a9c5;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="322.5" font-size="12" fill="black">Median</text><rect x="0" y="330.0" width="110" height="27.5" style="fill:#35ae93;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="350.0" font-size="12" fill="black">SVDMETHOD</text><rect x="0" y="357.5" width="110" height="27.5" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="377.5" font-size="12" fill="black">CF</text><rect x="0" y="385.0" width="110" height="27.5" style="fill:#31b33e;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="405.0" font-size="12" fill="black">MSIMPUTE_MNAR</text><rect x="0" y="412.5" width="110" height="27.5" style="fill:#f7754f;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="432.5" font-size="12" fill="black">QRILC</text><rect x="0" y="440.0" width="110" height="27.5" style="fill:#97a431;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="460.0" font-size="12" fill="black">GSIMP</text><rect x="0" y="467.5" width="110" height="27.5" style="fill:#3aa5df;stroke-width:2;stroke:rgb(255,255,255)" metadata="tt"/><text x="4" y="487.5" font-size="12" fill="black">MLE</text></svg></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TOP_N_ORDER</span> <span class="o">=</span> <span class="n">ORDER_MODELS</span><span class="p">[:</span><span class="n">args</span><span class="o">.</span><span class="n">plot_to_n</span><span class="p">]</span>
<span class="n">TOP_N_COLOR_PALETTE</span> <span class="o">=</span> <span class="p">{</span><span class="n">model</span><span class="p">:</span> <span class="n">color</span> <span class="k">for</span> <span class="n">model</span><span class="p">,</span>
                       <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">TOP_N_ORDER</span><span class="p">,</span> <span class="n">COLORS_TO_USE</span><span class="p">)}</span>
<span class="n">TOP_N_ORDER</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;TRKNN&#39;, &#39;DAE&#39;, &#39;RF&#39;, &#39;KNN&#39;, &#39;KNN_IMPUTE&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlation-per-sample">
<h3>Correlation per sample<a class="headerlink" href="#correlation-per-sample" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_per_sample_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_val</span>
                       <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_index_name</span><span class="p">)</span>
                       <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
                           <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">]</span>
                       <span class="p">)[</span><span class="n">ORDER_MODELS</span><span class="p">])</span>

<span class="n">min_corr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">corr_per_sample_val</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">min_corr</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
              <span class="c1">#     boxprops=dict(linewidth=1.5),</span>
              <span class="n">flierprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
              <span class="c1"># title=&#39;Corr. betw. fake NA and model pred. per sample on validation data&#39;,</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;correlation per sample&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">corr_per_sample_val</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_pred_corr_val_per_sample.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_pred_corr_val_per_sample.xlsx&#39;</span>
<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">corr_per_sample_val</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>
    <span class="n">corr_per_sample_val</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;correlations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_pred_corr_val_per_sample.pdf
</pre></div>
</div>
<img alt="_images/c7119c92e486d950444990c83e5ca841681e624257eedc3f19cd25801013fdd2.png" src="_images/c7119c92e486d950444990c83e5ca841681e624257eedc3f19cd25801013fdd2.png" />
</div>
</div>
<p>identify samples which are below lower whisker for models</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treshold</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">get_lower_whiskers</span><span class="p">(</span>
    <span class="n">corr_per_sample_val</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_sample_val</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">treshold</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">corr_per_sample_val</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;Nothing to display&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_055b6_row0_col12, #T_055b6_row1_col17, #T_055b6_row2_col17, #T_055b6_row3_col17, #T_055b6_row4_col12 {
  background-color: yellow;
}
</style>
<table id="T_055b6">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_055b6_level0_col0" class="col_heading level0 col0" >TRKNN</th>
      <th id="T_055b6_level0_col1" class="col_heading level0 col1" >DAE</th>
      <th id="T_055b6_level0_col2" class="col_heading level0 col2" >RF</th>
      <th id="T_055b6_level0_col3" class="col_heading level0 col3" >KNN</th>
      <th id="T_055b6_level0_col4" class="col_heading level0 col4" >KNN_IMPUTE</th>
      <th id="T_055b6_level0_col5" class="col_heading level0 col5" >SEQKNN</th>
      <th id="T_055b6_level0_col6" class="col_heading level0 col6" >MICE-NORM</th>
      <th id="T_055b6_level0_col7" class="col_heading level0 col7" >IRM</th>
      <th id="T_055b6_level0_col8" class="col_heading level0 col8" >VAE</th>
      <th id="T_055b6_level0_col9" class="col_heading level0 col9" >IMPSEQ</th>
      <th id="T_055b6_level0_col10" class="col_heading level0 col10" >ROWMEDIAN</th>
      <th id="T_055b6_level0_col11" class="col_heading level0 col11" >Median</th>
      <th id="T_055b6_level0_col12" class="col_heading level0 col12" >SVDMETHOD</th>
      <th id="T_055b6_level0_col13" class="col_heading level0 col13" >CF</th>
      <th id="T_055b6_level0_col14" class="col_heading level0 col14" >MSIMPUTE_MNAR</th>
      <th id="T_055b6_level0_col15" class="col_heading level0 col15" >QRILC</th>
      <th id="T_055b6_level0_col16" class="col_heading level0 col16" >GSIMP</th>
      <th id="T_055b6_level0_col17" class="col_heading level0 col17" >MLE</th>
    </tr>
    <tr>
      <th class="index_name level0" >Sample ID</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
      <th class="blank col9" >&nbsp;</th>
      <th class="blank col10" >&nbsp;</th>
      <th class="blank col11" >&nbsp;</th>
      <th class="blank col12" >&nbsp;</th>
      <th class="blank col13" >&nbsp;</th>
      <th class="blank col14" >&nbsp;</th>
      <th class="blank col15" >&nbsp;</th>
      <th class="blank col16" >&nbsp;</th>
      <th class="blank col17" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_055b6_level0_row0" class="row_heading level0 row0" >2020_01_02_17_38_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_055b6_row0_col0" class="data row0 col0" >0.814638</td>
      <td id="T_055b6_row0_col1" class="data row0 col1" >0.863417</td>
      <td id="T_055b6_row0_col2" class="data row0 col2" >0.803283</td>
      <td id="T_055b6_row0_col3" class="data row0 col3" >0.872173</td>
      <td id="T_055b6_row0_col4" class="data row0 col4" >0.840552</td>
      <td id="T_055b6_row0_col5" class="data row0 col5" >0.814974</td>
      <td id="T_055b6_row0_col6" class="data row0 col6" >0.822477</td>
      <td id="T_055b6_row0_col7" class="data row0 col7" >0.832028</td>
      <td id="T_055b6_row0_col8" class="data row0 col8" >0.804373</td>
      <td id="T_055b6_row0_col9" class="data row0 col9" >0.734834</td>
      <td id="T_055b6_row0_col10" class="data row0 col10" >0.773389</td>
      <td id="T_055b6_row0_col11" class="data row0 col11" >0.773389</td>
      <td id="T_055b6_row0_col12" class="data row0 col12" >0.264915</td>
      <td id="T_055b6_row0_col13" class="data row0 col13" >0.679473</td>
      <td id="T_055b6_row0_col14" class="data row0 col14" >0.794515</td>
      <td id="T_055b6_row0_col15" class="data row0 col15" >0.663175</td>
      <td id="T_055b6_row0_col16" class="data row0 col16" >0.748406</td>
      <td id="T_055b6_row0_col17" class="data row0 col17" >0.282231</td>
    </tr>
    <tr>
      <th id="T_055b6_level0_row1" class="row_heading level0 row1" >2020_01_03_11_17_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_055b6_row1_col0" class="data row1 col0" >0.869520</td>
      <td id="T_055b6_row1_col1" class="data row1 col1" >0.816782</td>
      <td id="T_055b6_row1_col2" class="data row1 col2" >0.862776</td>
      <td id="T_055b6_row1_col3" class="data row1 col3" >0.861051</td>
      <td id="T_055b6_row1_col4" class="data row1 col4" >0.897441</td>
      <td id="T_055b6_row1_col5" class="data row1 col5" >0.847907</td>
      <td id="T_055b6_row1_col6" class="data row1 col6" >0.821011</td>
      <td id="T_055b6_row1_col7" class="data row1 col7" >0.741526</td>
      <td id="T_055b6_row1_col8" class="data row1 col8" >0.897495</td>
      <td id="T_055b6_row1_col9" class="data row1 col9" >0.787459</td>
      <td id="T_055b6_row1_col10" class="data row1 col10" >0.884240</td>
      <td id="T_055b6_row1_col11" class="data row1 col11" >0.884240</td>
      <td id="T_055b6_row1_col12" class="data row1 col12" >0.075518</td>
      <td id="T_055b6_row1_col13" class="data row1 col13" >0.693191</td>
      <td id="T_055b6_row1_col14" class="data row1 col14" >0.862744</td>
      <td id="T_055b6_row1_col15" class="data row1 col15" >0.827385</td>
      <td id="T_055b6_row1_col16" class="data row1 col16" >0.799853</td>
      <td id="T_055b6_row1_col17" class="data row1 col17" >0.034685</td>
    </tr>
    <tr>
      <th id="T_055b6_level0_row2" class="row_heading level0 row2" >2020_01_04_10_03_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_055b6_row2_col0" class="data row2 col0" >0.862972</td>
      <td id="T_055b6_row2_col1" class="data row2 col1" >0.872317</td>
      <td id="T_055b6_row2_col2" class="data row2 col2" >0.916324</td>
      <td id="T_055b6_row2_col3" class="data row2 col3" >0.815538</td>
      <td id="T_055b6_row2_col4" class="data row2 col4" >0.792961</td>
      <td id="T_055b6_row2_col5" class="data row2 col5" >0.854551</td>
      <td id="T_055b6_row2_col6" class="data row2 col6" >0.837722</td>
      <td id="T_055b6_row2_col7" class="data row2 col7" >0.754664</td>
      <td id="T_055b6_row2_col8" class="data row2 col8" >0.969428</td>
      <td id="T_055b6_row2_col9" class="data row2 col9" >0.893126</td>
      <td id="T_055b6_row2_col10" class="data row2 col10" >0.940723</td>
      <td id="T_055b6_row2_col11" class="data row2 col11" >0.940723</td>
      <td id="T_055b6_row2_col12" class="data row2 col12" >0.512767</td>
      <td id="T_055b6_row2_col13" class="data row2 col13" >0.601749</td>
      <td id="T_055b6_row2_col14" class="data row2 col14" >0.908134</td>
      <td id="T_055b6_row2_col15" class="data row2 col15" >0.920853</td>
      <td id="T_055b6_row2_col16" class="data row2 col16" >0.815317</td>
      <td id="T_055b6_row2_col17" class="data row2 col17" >-0.290724</td>
    </tr>
    <tr>
      <th id="T_055b6_level0_row3" class="row_heading level0 row3" >2020_01_09_11_07_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_055b6_row3_col0" class="data row3 col0" >0.333943</td>
      <td id="T_055b6_row3_col1" class="data row3 col1" >0.534029</td>
      <td id="T_055b6_row3_col2" class="data row3 col2" >0.348621</td>
      <td id="T_055b6_row3_col3" class="data row3 col3" >0.394118</td>
      <td id="T_055b6_row3_col4" class="data row3 col4" >0.309707</td>
      <td id="T_055b6_row3_col5" class="data row3 col5" >0.343051</td>
      <td id="T_055b6_row3_col6" class="data row3 col6" >0.231197</td>
      <td id="T_055b6_row3_col7" class="data row3 col7" >0.168237</td>
      <td id="T_055b6_row3_col8" class="data row3 col8" >0.269615</td>
      <td id="T_055b6_row3_col9" class="data row3 col9" >0.265304</td>
      <td id="T_055b6_row3_col10" class="data row3 col10" >0.265338</td>
      <td id="T_055b6_row3_col11" class="data row3 col11" >0.265338</td>
      <td id="T_055b6_row3_col12" class="data row3 col12" >-0.009020</td>
      <td id="T_055b6_row3_col13" class="data row3 col13" >0.202358</td>
      <td id="T_055b6_row3_col14" class="data row3 col14" >0.073737</td>
      <td id="T_055b6_row3_col15" class="data row3 col15" >0.242416</td>
      <td id="T_055b6_row3_col16" class="data row3 col16" >0.168980</td>
      <td id="T_055b6_row3_col17" class="data row3 col17" >-0.268213</td>
    </tr>
    <tr>
      <th id="T_055b6_level0_row4" class="row_heading level0 row4" >2020_05_20_15_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_055b6_row4_col0" class="data row4 col0" >0.804230</td>
      <td id="T_055b6_row4_col1" class="data row4 col1" >0.797798</td>
      <td id="T_055b6_row4_col2" class="data row4 col2" >0.840677</td>
      <td id="T_055b6_row4_col3" class="data row4 col3" >0.812842</td>
      <td id="T_055b6_row4_col4" class="data row4 col4" >0.841829</td>
      <td id="T_055b6_row4_col5" class="data row4 col5" >0.844776</td>
      <td id="T_055b6_row4_col6" class="data row4 col6" >0.739775</td>
      <td id="T_055b6_row4_col7" class="data row4 col7" >0.736699</td>
      <td id="T_055b6_row4_col8" class="data row4 col8" >0.883332</td>
      <td id="T_055b6_row4_col9" class="data row4 col9" >0.713875</td>
      <td id="T_055b6_row4_col10" class="data row4 col10" >0.877112</td>
      <td id="T_055b6_row4_col11" class="data row4 col11" >0.877112</td>
      <td id="T_055b6_row4_col12" class="data row4 col12" >-0.183033</td>
      <td id="T_055b6_row4_col13" class="data row4 col13" >0.707341</td>
      <td id="T_055b6_row4_col14" class="data row4 col14" >0.867014</td>
      <td id="T_055b6_row4_col15" class="data row4 col15" >0.778006</td>
      <td id="T_055b6_row4_col16" class="data row4 col16" >0.813223</td>
      <td id="T_055b6_row4_col17" class="data row4 col17" >nan</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="error-plot">
<h3>Error plot<a class="headerlink" href="#error-plot" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_error_min</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">errors_val</span><span class="p">[</span><span class="n">MODELS</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">c_error_min</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">errors_val</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Median</th>
      <th>CF</th>
      <th>DAE</th>
      <th>VAE</th>
      <th>KNN</th>
      <th>ROWMEDIAN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>RF</th>
      <th>IMPSEQ</th>
      <th>QRILC</th>
      <th>SVDMETHOD</th>
      <th>MICE-NORM</th>
      <th>MLE</th>
      <th>IRM</th>
      <th>TRKNN</th>
      <th>MSIMPUTE_MNAR</th>
      <th>GSIMP</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020_02_11_10_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>AAR2</th>
      <td>-1.802</td>
      <td>-0.179</td>
      <td>-0.873</td>
      <td>-1.422</td>
      <td>-0.119</td>
      <td>-1.802</td>
      <td>-0.674</td>
      <td>-0.474</td>
      <td>-0.514</td>
      <td>1.188</td>
      <td>-3.809</td>
      <td>0.291</td>
      <td>-0.124</td>
      <td>-0.338</td>
      <td>-0.191</td>
      <td>-0.523</td>
      <td>-3.330</td>
      <td>-4.735</td>
    </tr>
    <tr>
      <th>2020_01_09_11_07_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ABCB6</th>
      <td>-6.386</td>
      <td>-3.352</td>
      <td>-6.492</td>
      <td>-6.662</td>
      <td>-6.653</td>
      <td>-6.386</td>
      <td>-7.178</td>
      <td>-6.696</td>
      <td>-7.249</td>
      <td>-7.865</td>
      <td>-8.585</td>
      <td>-3.636</td>
      <td>-8.729</td>
      <td>2,546.526</td>
      <td>-8.385</td>
      <td>-7.582</td>
      <td>-9.416</td>
      <td>-10.067</td>
    </tr>
    <tr>
      <th>2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ABCB6</th>
      <td>-2.347</td>
      <td>0.885</td>
      <td>-0.431</td>
      <td>-0.628</td>
      <td>-0.342</td>
      <td>-2.347</td>
      <td>-0.146</td>
      <td>0.173</td>
      <td>-0.324</td>
      <td>-0.535</td>
      <td>-5.599</td>
      <td>2.063</td>
      <td>0.123</td>
      <td>2,321.266</td>
      <td>0.102</td>
      <td>0.040</td>
      <td>-3.378</td>
      <td>-5.833</td>
    </tr>
    <tr>
      <th>2020_05_14_17_28_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ABCB6</th>
      <td>0.861</td>
      <td>3.916</td>
      <td>-0.300</td>
      <td>0.627</td>
      <td>-0.853</td>
      <td>0.861</td>
      <td>-0.782</td>
      <td>-0.287</td>
      <td>-0.336</td>
      <td>-0.455</td>
      <td>-2.680</td>
      <td>2.496</td>
      <td>-0.474</td>
      <td>2,449.959</td>
      <td>-0.390</td>
      <td>-0.125</td>
      <td>-2.008</td>
      <td>-1.541</td>
    </tr>
    <tr>
      <th>2020_02_11_10_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ABHD11</th>
      <td>-1.686</td>
      <td>1.664</td>
      <td>-0.675</td>
      <td>-1.417</td>
      <td>-0.859</td>
      <td>-1.686</td>
      <td>-0.236</td>
      <td>-0.400</td>
      <td>-0.989</td>
      <td>0.523</td>
      <td>-5.735</td>
      <td>1.908</td>
      <td>-0.263</td>
      <td>2.605</td>
      <td>-0.075</td>
      <td>-0.621</td>
      <td>-3.521</td>
      <td>-4.139</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_val</span> <span class="o">=</span> <span class="n">errors_val</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">freq_feat</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># absolute error</span>
<span class="n">errors_val</span> <span class="o">=</span> <span class="n">errors_val</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">freq_feat</span><span class="p">)</span>
<span class="n">errors_val</span> <span class="o">=</span> <span class="n">errors_val</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">freq_feat</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">errors_val</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Median</th>
      <th>CF</th>
      <th>DAE</th>
      <th>VAE</th>
      <th>KNN</th>
      <th>ROWMEDIAN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>RF</th>
      <th>IMPSEQ</th>
      <th>QRILC</th>
      <th>SVDMETHOD</th>
      <th>MICE-NORM</th>
      <th>MLE</th>
      <th>IRM</th>
      <th>TRKNN</th>
      <th>MSIMPUTE_MNAR</th>
      <th>GSIMP</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SLC16A7</th>
      <td>1.253</td>
      <td>2.751</td>
      <td>0.462</td>
      <td>0.848</td>
      <td>0.576</td>
      <td>1.253</td>
      <td>1.506</td>
      <td>0.440</td>
      <td>0.507</td>
      <td>0.511</td>
      <td>3.028</td>
      <td>3.081</td>
      <td>0.289</td>
      <td>1,504.411</td>
      <td>0.256</td>
      <td>0.446</td>
      <td>2.829</td>
      <td>2.279</td>
      <td>30</td>
    </tr>
    <tr>
      <th>ABHD11</th>
      <td>1.532</td>
      <td>2.096</td>
      <td>0.617</td>
      <td>1.264</td>
      <td>0.903</td>
      <td>1.532</td>
      <td>0.403</td>
      <td>0.447</td>
      <td>0.870</td>
      <td>0.887</td>
      <td>4.914</td>
      <td>2.512</td>
      <td>0.422</td>
      <td>1,734.170</td>
      <td>0.605</td>
      <td>0.672</td>
      <td>3.242</td>
      <td>3.645</td>
      <td>30</td>
    </tr>
    <tr>
      <th>RPP38</th>
      <td>1.957</td>
      <td>4.033</td>
      <td>0.967</td>
      <td>1.369</td>
      <td>0.855</td>
      <td>1.957</td>
      <td>0.732</td>
      <td>0.547</td>
      <td>0.896</td>
      <td>0.494</td>
      <td>1.313</td>
      <td>3.221</td>
      <td>0.565</td>
      <td>1,650.202</td>
      <td>0.592</td>
      <td>0.874</td>
      <td>2.029</td>
      <td>1.482</td>
      <td>30</td>
    </tr>
    <tr>
      <th>LIPA</th>
      <td>0.704</td>
      <td>2.311</td>
      <td>0.269</td>
      <td>0.302</td>
      <td>0.422</td>
      <td>0.704</td>
      <td>0.500</td>
      <td>0.195</td>
      <td>0.571</td>
      <td>0.559</td>
      <td>3.292</td>
      <td>2.934</td>
      <td>0.563</td>
      <td>1,143.923</td>
      <td>0.764</td>
      <td>0.304</td>
      <td>2.091</td>
      <td>2.681</td>
      <td>30</td>
    </tr>
    <tr>
      <th>NSMCE2</th>
      <td>1.605</td>
      <td>1.333</td>
      <td>1.302</td>
      <td>1.044</td>
      <td>1.045</td>
      <td>1.605</td>
      <td>1.299</td>
      <td>1.372</td>
      <td>1.097</td>
      <td>1.006</td>
      <td>5.039</td>
      <td>1.117</td>
      <td>1.021</td>
      <td>1,530.014</td>
      <td>0.831</td>
      <td>1.152</td>
      <td>3.993</td>
      <td>3.899</td>
      <td>31</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_val</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="n">ORDER_MODELS</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># mean of means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TRKNN</th>
      <td>344.000</td>
      <td>0.525</td>
      <td>0.461</td>
      <td>0.008</td>
      <td>0.223</td>
      <td>0.415</td>
      <td>0.653</td>
      <td>3.672</td>
    </tr>
    <tr>
      <th>DAE</th>
      <td>344.000</td>
      <td>0.543</td>
      <td>0.432</td>
      <td>0.000</td>
      <td>0.266</td>
      <td>0.436</td>
      <td>0.677</td>
      <td>3.067</td>
    </tr>
    <tr>
      <th>RF</th>
      <td>344.000</td>
      <td>0.550</td>
      <td>0.486</td>
      <td>0.006</td>
      <td>0.260</td>
      <td>0.418</td>
      <td>0.700</td>
      <td>4.194</td>
    </tr>
    <tr>
      <th>KNN</th>
      <td>344.000</td>
      <td>0.551</td>
      <td>0.488</td>
      <td>0.001</td>
      <td>0.249</td>
      <td>0.423</td>
      <td>0.700</td>
      <td>3.905</td>
    </tr>
    <tr>
      <th>KNN_IMPUTE</th>
      <td>344.000</td>
      <td>0.578</td>
      <td>0.475</td>
      <td>0.001</td>
      <td>0.265</td>
      <td>0.460</td>
      <td>0.731</td>
      <td>3.361</td>
    </tr>
    <tr>
      <th>SEQKNN</th>
      <td>344.000</td>
      <td>0.617</td>
      <td>0.608</td>
      <td>0.011</td>
      <td>0.260</td>
      <td>0.460</td>
      <td>0.752</td>
      <td>7.013</td>
    </tr>
    <tr>
      <th>MICE-NORM</th>
      <td>344.000</td>
      <td>0.586</td>
      <td>0.461</td>
      <td>0.007</td>
      <td>0.287</td>
      <td>0.487</td>
      <td>0.713</td>
      <td>3.304</td>
    </tr>
    <tr>
      <th>IRM</th>
      <td>344.000</td>
      <td>0.664</td>
      <td>0.519</td>
      <td>0.000</td>
      <td>0.327</td>
      <td>0.543</td>
      <td>0.844</td>
      <td>3.917</td>
    </tr>
    <tr>
      <th>VAE</th>
      <td>344.000</td>
      <td>0.737</td>
      <td>0.546</td>
      <td>0.002</td>
      <td>0.346</td>
      <td>0.610</td>
      <td>0.976</td>
      <td>3.732</td>
    </tr>
    <tr>
      <th>IMPSEQ</th>
      <td>344.000</td>
      <td>0.975</td>
      <td>0.966</td>
      <td>0.008</td>
      <td>0.423</td>
      <td>0.705</td>
      <td>1.188</td>
      <td>7.120</td>
    </tr>
    <tr>
      <th>ROWMEDIAN</th>
      <td>344.000</td>
      <td>1.052</td>
      <td>0.674</td>
      <td>0.016</td>
      <td>0.628</td>
      <td>0.923</td>
      <td>1.365</td>
      <td>3.813</td>
    </tr>
    <tr>
      <th>Median</th>
      <td>344.000</td>
      <td>1.052</td>
      <td>0.674</td>
      <td>0.016</td>
      <td>0.628</td>
      <td>0.923</td>
      <td>1.365</td>
      <td>3.813</td>
    </tr>
    <tr>
      <th>SVDMETHOD</th>
      <td>344.000</td>
      <td>1.869</td>
      <td>1.355</td>
      <td>0.030</td>
      <td>0.845</td>
      <td>1.537</td>
      <td>2.629</td>
      <td>8.031</td>
    </tr>
    <tr>
      <th>CF</th>
      <td>344.000</td>
      <td>2.021</td>
      <td>1.331</td>
      <td>0.073</td>
      <td>1.019</td>
      <td>1.733</td>
      <td>2.741</td>
      <td>7.825</td>
    </tr>
    <tr>
      <th>MSIMPUTE_MNAR</th>
      <td>344.000</td>
      <td>2.622</td>
      <td>0.830</td>
      <td>0.003</td>
      <td>2.176</td>
      <td>2.601</td>
      <td>3.120</td>
      <td>6.400</td>
    </tr>
    <tr>
      <th>QRILC</th>
      <td>344.000</td>
      <td>2.726</td>
      <td>1.208</td>
      <td>0.082</td>
      <td>1.899</td>
      <td>2.597</td>
      <td>3.427</td>
      <td>7.575</td>
    </tr>
    <tr>
      <th>GSIMP</th>
      <td>344.000</td>
      <td>2.990</td>
      <td>1.302</td>
      <td>0.133</td>
      <td>2.005</td>
      <td>2.898</td>
      <td>3.891</td>
      <td>6.990</td>
    </tr>
    <tr>
      <th>MLE</th>
      <td>344.000</td>
      <td>1,865.720</td>
      <td>739.101</td>
      <td>0.033</td>
      <td>1,538.537</td>
      <td>2,312.849</td>
      <td>2,401.133</td>
      <td>2,581.958</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_avg_error</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">errors_val</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">c_avg_error</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">errors_val</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Median</th>
      <th>CF</th>
      <th>DAE</th>
      <th>VAE</th>
      <th>KNN</th>
      <th>ROWMEDIAN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>RF</th>
      <th>IMPSEQ</th>
      <th>QRILC</th>
      <th>SVDMETHOD</th>
      <th>MICE-NORM</th>
      <th>MLE</th>
      <th>IRM</th>
      <th>TRKNN</th>
      <th>MSIMPUTE_MNAR</th>
      <th>GSIMP</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TMEM261</th>
      <td>1.043</td>
      <td>3.719</td>
      <td>1.334</td>
      <td>1.126</td>
      <td>2.435</td>
      <td>1.043</td>
      <td>1.117</td>
      <td>1.365</td>
      <td>2.289</td>
      <td>1.746</td>
      <td>3.054</td>
      <td>3.838</td>
      <td>2.203</td>
      <td>2,407.758</td>
      <td>2.552</td>
      <td>2.050</td>
      <td>1.327</td>
      <td>2.101</td>
      <td>32</td>
    </tr>
    <tr>
      <th>UTRN</th>
      <td>3.318</td>
      <td>5.272</td>
      <td>1.734</td>
      <td>2.468</td>
      <td>1.608</td>
      <td>3.318</td>
      <td>2.404</td>
      <td>2.322</td>
      <td>2.129</td>
      <td>4.977</td>
      <td>5.434</td>
      <td>6.065</td>
      <td>2.249</td>
      <td>2,336.949</td>
      <td>2.146</td>
      <td>3.109</td>
      <td>0.365</td>
      <td>1.892</td>
      <td>32</td>
    </tr>
    <tr>
      <th>ARPC1A</th>
      <td>3.080</td>
      <td>1.219</td>
      <td>2.375</td>
      <td>2.927</td>
      <td>2.583</td>
      <td>3.080</td>
      <td>2.009</td>
      <td>2.418</td>
      <td>2.586</td>
      <td>1.927</td>
      <td>7.575</td>
      <td>1.572</td>
      <td>2.001</td>
      <td>2,427.903</td>
      <td>2.068</td>
      <td>2.064</td>
      <td>5.177</td>
      <td>6.573</td>
      <td>34</td>
    </tr>
    <tr>
      <th>ABCB6</th>
      <td>3.198</td>
      <td>2.718</td>
      <td>2.408</td>
      <td>2.639</td>
      <td>2.616</td>
      <td>3.198</td>
      <td>2.702</td>
      <td>2.385</td>
      <td>2.636</td>
      <td>2.951</td>
      <td>5.621</td>
      <td>2.732</td>
      <td>3.109</td>
      <td>2,439.250</td>
      <td>2.959</td>
      <td>2.583</td>
      <td>4.934</td>
      <td>5.814</td>
      <td>35</td>
    </tr>
    <tr>
      <th>MED4</th>
      <td>2.698</td>
      <td>6.215</td>
      <td>1.531</td>
      <td>1.438</td>
      <td>0.840</td>
      <td>2.698</td>
      <td>2.016</td>
      <td>1.974</td>
      <td>1.610</td>
      <td>0.916</td>
      <td>0.518</td>
      <td>4.656</td>
      <td>0.462</td>
      <td>2,363.715</td>
      <td>1.677</td>
      <td>1.533</td>
      <td>0.003</td>
      <td>0.624</td>
      <td>37</td>
    </tr>
    <tr>
      <th>EIF1B</th>
      <td>1.426</td>
      <td>2.498</td>
      <td>1.025</td>
      <td>0.199</td>
      <td>2.732</td>
      <td>1.426</td>
      <td>0.585</td>
      <td>0.240</td>
      <td>1.953</td>
      <td>7.120</td>
      <td>7.086</td>
      <td>2.282</td>
      <td>0.703</td>
      <td>2.564</td>
      <td>0.413</td>
      <td>0.972</td>
      <td>2.696</td>
      <td>3.552</td>
      <td>41</td>
    </tr>
    <tr>
      <th>PRPF38B</th>
      <td>1.906</td>
      <td>4.365</td>
      <td>2.193</td>
      <td>1.724</td>
      <td>2.077</td>
      <td>1.906</td>
      <td>1.668</td>
      <td>2.038</td>
      <td>1.927</td>
      <td>2.138</td>
      <td>1.900</td>
      <td>3.826</td>
      <td>2.569</td>
      <td>1,282.592</td>
      <td>2.146</td>
      <td>1.996</td>
      <td>1.552</td>
      <td>2.726</td>
      <td>47</td>
    </tr>
    <tr>
      <th>NDUFAF4</th>
      <td>3.523</td>
      <td>3.710</td>
      <td>0.667</td>
      <td>2.374</td>
      <td>2.212</td>
      <td>3.523</td>
      <td>1.004</td>
      <td>1.144</td>
      <td>2.196</td>
      <td>0.705</td>
      <td>2.250</td>
      <td>2.467</td>
      <td>0.888</td>
      <td>857.215</td>
      <td>1.279</td>
      <td>1.227</td>
      <td>1.925</td>
      <td>2.523</td>
      <td>48</td>
    </tr>
    <tr>
      <th>ATP13A1</th>
      <td>1.545</td>
      <td>1.665</td>
      <td>1.637</td>
      <td>1.557</td>
      <td>1.363</td>
      <td>1.545</td>
      <td>1.817</td>
      <td>1.952</td>
      <td>1.961</td>
      <td>2.475</td>
      <td>4.164</td>
      <td>2.122</td>
      <td>1.616</td>
      <td>1,659.080</td>
      <td>1.796</td>
      <td>2.097</td>
      <td>3.596</td>
      <td>4.221</td>
      <td>49</td>
    </tr>
    <tr>
      <th>HIGD2A</th>
      <td>3.190</td>
      <td>4.770</td>
      <td>2.776</td>
      <td>2.494</td>
      <td>2.976</td>
      <td>3.190</td>
      <td>2.979</td>
      <td>2.527</td>
      <td>2.712</td>
      <td>1.183</td>
      <td>0.082</td>
      <td>4.337</td>
      <td>1.258</td>
      <td>2.843</td>
      <td>1.591</td>
      <td>2.431</td>
      <td>0.787</td>
      <td>1.012</td>
      <td>49</td>
    </tr>
    <tr>
      <th>NUP107</th>
      <td>3.264</td>
      <td>3.451</td>
      <td>3.067</td>
      <td>3.732</td>
      <td>3.905</td>
      <td>3.264</td>
      <td>3.361</td>
      <td>3.888</td>
      <td>4.194</td>
      <td>6.044</td>
      <td>5.221</td>
      <td>4.206</td>
      <td>3.304</td>
      <td>6.655</td>
      <td>3.917</td>
      <td>3.672</td>
      <td>6.400</td>
      <td>4.897</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="error-by-non-decimal-number-of-intensity">
<h3>Error by non-decimal number of intensity<a class="headerlink" href="#error-by-non-decimal-number-of-intensity" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>number of observations in parentheses.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">,</span> <span class="n">errors_binned</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">plot_errors_by_median</span><span class="p">(</span>
    <span class="n">pred_val</span><span class="p">[</span>
        <span class="p">[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">TOP_N_ORDER</span>
    <span class="p">],</span>
    <span class="n">feat_medians</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">TOP_N_COLOR_PALETTE</span><span class="p">,</span>
    <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span><span class="p">,)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average error (</span><span class="si">{</span><span class="n">METRIC</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">TOP_N_ORDER</span><span class="p">))</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_errors_binned_by_feat_median_val.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_errors_binned_by_feat_median_val.pdf
</pre></div>
</div>
<img alt="_images/e6e04e0c4abfe663ad87d642da37cd2d4851bd2765e793f7b60909c345fe0293.png" src="_images/e6e04e0c4abfe663ad87d642da37cd2d4851bd2765e793f7b60909c345fe0293.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ! only used for reporting</span>
<span class="n">plotted</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get_data_for_errors_by_median</span><span class="p">(</span>
    <span class="n">errors</span><span class="o">=</span><span class="n">errors_binned</span><span class="p">,</span>
    <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
    <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span>
<span class="p">)</span>
<span class="n">plotted</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plotted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bin</th>
      <th>model</th>
      <th>mean</th>
      <th>ci_low</th>
      <th>ci_high</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24\n(N=12)</td>
      <td>TRKNN</td>
      <td>0.957</td>
      <td>0.603</td>
      <td>1.396</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24\n(N=12)</td>
      <td>DAE</td>
      <td>0.970</td>
      <td>0.639</td>
      <td>1.330</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24\n(N=12)</td>
      <td>RF</td>
      <td>1.144</td>
      <td>0.717</td>
      <td>1.572</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24\n(N=12)</td>
      <td>KNN</td>
      <td>1.039</td>
      <td>0.614</td>
      <td>1.577</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24\n(N=12)</td>
      <td>KNN_IMPUTE</td>
      <td>0.998</td>
      <td>0.569</td>
      <td>1.478</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>55</th>
      <td>35\n(N=1)</td>
      <td>TRKNN</td>
      <td>0.251</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>56</th>
      <td>35\n(N=1)</td>
      <td>DAE</td>
      <td>0.185</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>57</th>
      <td>35\n(N=1)</td>
      <td>RF</td>
      <td>0.231</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58</th>
      <td>35\n(N=1)</td>
      <td>KNN</td>
      <td>0.315</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>59</th>
      <td>35\n(N=1)</td>
      <td>KNN_IMPUTE</td>
      <td>1.338</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>60 rows  5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_binned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
<span class="n">errors_binned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
<span class="n">errors_binned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th>model</th>
      <th>MAE</th>
      <th>bin</th>
      <th>n_obs</th>
      <th>intensity binned by median of Gene Names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>GEMIN5</td>
      <td>TRKNN</td>
      <td>0.189</td>
      <td>30</td>
      <td>71</td>
      <td>30\n(N=71)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>GEMIN5</td>
      <td>DAE</td>
      <td>0.022</td>
      <td>30</td>
      <td>71</td>
      <td>30\n(N=71)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>GEMIN5</td>
      <td>RF</td>
      <td>0.281</td>
      <td>30</td>
      <td>71</td>
      <td>30\n(N=71)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>GEMIN5</td>
      <td>KNN</td>
      <td>0.081</td>
      <td>30</td>
      <td>71</td>
      <td>30\n(N=71)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>GEMIN5</td>
      <td>KNN_IMPUTE</td>
      <td>0.162</td>
      <td>30</td>
      <td>71</td>
      <td>30\n(N=71)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="test-data">
<h2>test data<a class="headerlink" href="#test-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_test</span> <span class="o">=</span> <span class="n">compare_predictions</span><span class="o">.</span><span class="n">load_split_prediction_by_modelkey</span><span class="p">(</span>
    <span class="n">experiment_folder</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">folder_experiment</span><span class="p">,</span>
    <span class="n">split</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span>
    <span class="n">model_keys</span><span class="o">=</span><span class="n">MODELS_PASSED</span><span class="p">,</span>
    <span class="n">shared_columns</span><span class="o">=</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">])</span>
<span class="n">pred_test</span> <span class="o">=</span> <span class="n">pred_test</span><span class="p">[[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">ORDER_MODELS</span><span class="p">]</span>
<span class="n">pred_test</span> <span class="o">=</span> <span class="n">pred_test</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">freq_feat</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">freq_feat</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">save_agg_pred</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">folder_experiment</span> <span class="o">/</span> <span class="s1">&#39;01_2_agg_pred_test.csv&#39;</span>
    <span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="n">pred_test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved aggregated predictions to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pred_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>observed</th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>ARAF</th>
      <td>23.248</td>
      <td>26.524</td>
      <td>26.138</td>
      <td>26.343</td>
      <td>25.862</td>
      <td>26.636</td>
      <td>26.451</td>
      <td>25.461</td>
      <td>25.433</td>
      <td>26.023</td>
      <td>25.582</td>
      <td>26.271</td>
      <td>26.271</td>
      <td>28.185</td>
      <td>28.307</td>
      <td>23.490</td>
      <td>23.118</td>
      <td>23.400</td>
      <td>2,355.271</td>
      <td>36</td>
    </tr>
    <tr>
      <th>CENPH</th>
      <td>25.045</td>
      <td>24.908</td>
      <td>24.529</td>
      <td>25.023</td>
      <td>25.215</td>
      <td>24.850</td>
      <td>25.172</td>
      <td>24.055</td>
      <td>24.354</td>
      <td>24.711</td>
      <td>25.715</td>
      <td>25.554</td>
      <td>25.554</td>
      <td>28.044</td>
      <td>28.308</td>
      <td>23.097</td>
      <td>22.083</td>
      <td>21.442</td>
      <td>2,355.271</td>
      <td>42</td>
    </tr>
    <tr>
      <th>CLPP</th>
      <td>27.745</td>
      <td>27.755</td>
      <td>27.541</td>
      <td>27.828</td>
      <td>27.337</td>
      <td>27.632</td>
      <td>27.572</td>
      <td>28.114</td>
      <td>28.425</td>
      <td>27.697</td>
      <td>27.532</td>
      <td>27.520</td>
      <td>27.520</td>
      <td>28.135</td>
      <td>28.372</td>
      <td>25.233</td>
      <td>25.854</td>
      <td>24.722</td>
      <td>2,355.271</td>
      <td>47</td>
    </tr>
    <tr>
      <th>GNAI1</th>
      <td>24.335</td>
      <td>25.691</td>
      <td>25.534</td>
      <td>25.602</td>
      <td>26.067</td>
      <td>26.550</td>
      <td>26.096</td>
      <td>25.747</td>
      <td>26.544</td>
      <td>26.390</td>
      <td>26.390</td>
      <td>26.363</td>
      <td>26.363</td>
      <td>28.038</td>
      <td>28.345</td>
      <td>24.430</td>
      <td>23.763</td>
      <td>23.945</td>
      <td>2,355.271</td>
      <td>49</td>
    </tr>
    <tr>
      <th>KIAA1143</th>
      <td>26.901</td>
      <td>26.690</td>
      <td>26.831</td>
      <td>26.456</td>
      <td>27.182</td>
      <td>26.642</td>
      <td>26.511</td>
      <td>26.744</td>
      <td>27.244</td>
      <td>26.941</td>
      <td>26.413</td>
      <td>26.734</td>
      <td>26.734</td>
      <td>27.967</td>
      <td>28.399</td>
      <td>24.289</td>
      <td>24.801</td>
      <td>24.382</td>
      <td>2,355.271</td>
      <td>47</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>NUDT9</th>
      <td>27.658</td>
      <td>27.421</td>
      <td>27.195</td>
      <td>27.418</td>
      <td>27.114</td>
      <td>26.919</td>
      <td>27.742</td>
      <td>27.356</td>
      <td>26.891</td>
      <td>27.110</td>
      <td>27.965</td>
      <td>26.930</td>
      <td>26.930</td>
      <td>28.881</td>
      <td>28.555</td>
      <td>25.286</td>
      <td>24.311</td>
      <td>23.340</td>
      <td>2,424.892</td>
      <td>49</td>
    </tr>
    <tr>
      <th>PTPN1</th>
      <td>29.024</td>
      <td>29.171</td>
      <td>28.882</td>
      <td>29.048</td>
      <td>28.058</td>
      <td>29.045</td>
      <td>29.134</td>
      <td>28.712</td>
      <td>28.398</td>
      <td>28.508</td>
      <td>29.765</td>
      <td>28.345</td>
      <td>28.345</td>
      <td>28.906</td>
      <td>28.561</td>
      <td>26.592</td>
      <td>26.062</td>
      <td>24.783</td>
      <td>2,424.892</td>
      <td>50</td>
    </tr>
    <tr>
      <th>RDH13</th>
      <td>28.720</td>
      <td>28.445</td>
      <td>28.269</td>
      <td>28.027</td>
      <td>28.008</td>
      <td>28.395</td>
      <td>28.380</td>
      <td>28.492</td>
      <td>28.249</td>
      <td>28.024</td>
      <td>27.895</td>
      <td>27.121</td>
      <td>27.121</td>
      <td>28.876</td>
      <td>28.513</td>
      <td>25.262</td>
      <td>23.672</td>
      <td>23.164</td>
      <td>2,424.892</td>
      <td>48</td>
    </tr>
    <tr>
      <th>RNASEH2C</th>
      <td>26.742</td>
      <td>26.920</td>
      <td>26.164</td>
      <td>26.362</td>
      <td>26.708</td>
      <td>26.698</td>
      <td>26.139</td>
      <td>26.181</td>
      <td>26.134</td>
      <td>26.423</td>
      <td>26.269</td>
      <td>25.688</td>
      <td>25.688</td>
      <td>28.890</td>
      <td>28.528</td>
      <td>23.862</td>
      <td>21.217</td>
      <td>23.437</td>
      <td>2,424.892</td>
      <td>34</td>
    </tr>
    <tr>
      <th>SH3BGRL3</th>
      <td>29.162</td>
      <td>29.086</td>
      <td>28.822</td>
      <td>29.214</td>
      <td>28.613</td>
      <td>29.118</td>
      <td>29.372</td>
      <td>28.936</td>
      <td>28.795</td>
      <td>29.229</td>
      <td>29.911</td>
      <td>28.934</td>
      <td>28.934</td>
      <td>28.903</td>
      <td>28.738</td>
      <td>27.186</td>
      <td>26.437</td>
      <td>27.091</td>
      <td>2,424.892</td>
      <td>49</td>
    </tr>
  </tbody>
</table>
<p>859 rows  20 columns</p>
</div></div></div>
</div>
<p>Write averages for all models to excel (from before?)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_test_mae</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">calc_errors</span><span class="o">.</span><span class="n">get_absolute_error</span><span class="p">(</span>
    <span class="n">pred_test</span>
<span class="p">)</span>
<span class="n">mae_stats_ordered_test</span> <span class="o">=</span> <span class="n">errors_test_mae</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="n">ORDER_MODELS</span><span class="p">]</span>
<span class="n">mae_stats_ordered_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.474</td>
      <td>0.521</td>
      <td>0.508</td>
      <td>0.513</td>
      <td>0.506</td>
      <td>0.524</td>
      <td>0.543</td>
      <td>0.598</td>
      <td>0.707</td>
      <td>0.850</td>
      <td>1.040</td>
      <td>1.040</td>
      <td>1.829</td>
      <td>1.986</td>
      <td>2.636</td>
      <td>2.726</td>
      <td>2.986</td>
      <td>1,890.152</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.533</td>
      <td>0.515</td>
      <td>0.519</td>
      <td>0.521</td>
      <td>0.528</td>
      <td>0.534</td>
      <td>0.540</td>
      <td>0.575</td>
      <td>0.649</td>
      <td>1.053</td>
      <td>0.824</td>
      <td>0.824</td>
      <td>1.396</td>
      <td>1.438</td>
      <td>0.976</td>
      <td>1.524</td>
      <td>1.600</td>
      <td>954.223</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.002</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.003</td>
      <td>0.003</td>
      <td>0.005</td>
      <td>0.002</td>
      <td>0.006</td>
      <td>0.011</td>
      <td>0.005</td>
      <td>0.017</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.133</td>
      <td>0.183</td>
      <td>0.166</td>
      <td>0.164</td>
      <td>0.156</td>
      <td>0.163</td>
      <td>0.180</td>
      <td>0.200</td>
      <td>0.251</td>
      <td>0.246</td>
      <td>0.394</td>
      <td>0.394</td>
      <td>0.690</td>
      <td>0.812</td>
      <td>2.063</td>
      <td>1.605</td>
      <td>1.847</td>
      <td>2,219.520</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.308</td>
      <td>0.352</td>
      <td>0.356</td>
      <td>0.372</td>
      <td>0.339</td>
      <td>0.368</td>
      <td>0.386</td>
      <td>0.447</td>
      <td>0.528</td>
      <td>0.527</td>
      <td>0.875</td>
      <td>0.875</td>
      <td>1.489</td>
      <td>1.731</td>
      <td>2.708</td>
      <td>2.588</td>
      <td>2.857</td>
      <td>2,352.386</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.615</td>
      <td>0.697</td>
      <td>0.650</td>
      <td>0.698</td>
      <td>0.656</td>
      <td>0.671</td>
      <td>0.730</td>
      <td>0.812</td>
      <td>0.941</td>
      <td>1.066</td>
      <td>1.521</td>
      <td>1.521</td>
      <td>2.696</td>
      <td>2.914</td>
      <td>3.210</td>
      <td>3.618</td>
      <td>3.991</td>
      <td>2,432.080</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.243</td>
      <td>3.368</td>
      <td>3.556</td>
      <td>3.662</td>
      <td>3.722</td>
      <td>3.295</td>
      <td>3.973</td>
      <td>3.591</td>
      <td>3.634</td>
      <td>11.928</td>
      <td>7.061</td>
      <td>7.061</td>
      <td>7.773</td>
      <td>7.191</td>
      <td>6.406</td>
      <td>12.789</td>
      <td>8.796</td>
      <td>2,683.112</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae_stats_ordered_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;mae_stats_ordered_test&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp_mean_perf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">mae_stats_ordered_val</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="n">mae_stats_ordered_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
<span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
<span class="n">cp_mean_perf</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;cp_mean_perf&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">cp_mean_perf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>val</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TRKNN</th>
      <td>0.511</td>
      <td>0.474</td>
    </tr>
    <tr>
      <th>DAE</th>
      <td>0.535</td>
      <td>0.521</td>
    </tr>
    <tr>
      <th>RF</th>
      <td>0.536</td>
      <td>0.508</td>
    </tr>
    <tr>
      <th>KNN</th>
      <td>0.544</td>
      <td>0.513</td>
    </tr>
    <tr>
      <th>KNN_IMPUTE</th>
      <td>0.554</td>
      <td>0.506</td>
    </tr>
    <tr>
      <th>SEQKNN</th>
      <td>0.580</td>
      <td>0.524</td>
    </tr>
    <tr>
      <th>MICE-NORM</th>
      <td>0.593</td>
      <td>0.543</td>
    </tr>
    <tr>
      <th>IRM</th>
      <td>0.648</td>
      <td>0.598</td>
    </tr>
    <tr>
      <th>VAE</th>
      <td>0.717</td>
      <td>0.707</td>
    </tr>
    <tr>
      <th>IMPSEQ</th>
      <td>0.914</td>
      <td>0.850</td>
    </tr>
    <tr>
      <th>ROWMEDIAN</th>
      <td>1.028</td>
      <td>1.040</td>
    </tr>
    <tr>
      <th>Median</th>
      <td>1.028</td>
      <td>1.040</td>
    </tr>
    <tr>
      <th>SVDMETHOD</th>
      <td>1.763</td>
      <td>1.829</td>
    </tr>
    <tr>
      <th>CF</th>
      <td>1.905</td>
      <td>1.986</td>
    </tr>
    <tr>
      <th>MSIMPUTE_MNAR</th>
      <td>2.671</td>
      <td>2.636</td>
    </tr>
    <tr>
      <th>QRILC</th>
      <td>2.706</td>
      <td>2.726</td>
    </tr>
    <tr>
      <th>GSIMP</th>
      <td>2.994</td>
      <td>2.986</td>
    </tr>
    <tr>
      <th>MLE</th>
      <td>1,893.032</td>
      <td>1,890.152</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="intensity-distribution-as-histogram">
<h3>Intensity distribution as histogram<a class="headerlink" href="#intensity-distribution-as-histogram" title="Permalink to this heading">#</a></h3>
<p>Plot top 4 models predictions for intensities in test data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_max</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">min_max</span><span class="p">(</span><span class="n">pred_test</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">])</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">ORDER_MODELS</span><span class="p">[:</span><span class="n">top_n</span><span class="p">],</span>
        <span class="n">COLORS_TO_USE</span><span class="p">[:</span><span class="n">top_n</span><span class="p">],</span>
        <span class="n">axes</span><span class="p">):</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">plot_histogram_intensities</span><span class="p">(</span>
        <span class="n">pred_test</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
        <span class="n">min_max</span><span class="o">=</span><span class="n">min_max</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">plot_histogram_intensities</span><span class="p">(</span>
        <span class="n">pred_test</span><span class="p">[</span><span class="n">model</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">min_max</span><span class="o">=</span><span class="n">min_max</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[(</span><span class="n">l_</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span>
         <span class="k">for</span> <span class="n">l_</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of observations&#39;</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_intensity_binned_top_</span><span class="si">{</span><span class="n">top_n</span><span class="si">}</span><span class="s1">_models_test.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_intensity_binned_top_4_models_test.pdf
</pre></div>
</div>
<img alt="_images/0a34116414f074abc68104a7053d1bd85fed090236f13b27bca4161e71e54c30.png" src="_images/0a34116414f074abc68104a7053d1bd85fed090236f13b27bca4161e71e54c30.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts_per_bin</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">get_counts_per_bin</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">pred_test</span><span class="p">,</span>
                                                <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
                                                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">,</span> <span class="o">*</span><span class="n">ORDER_MODELS</span><span class="p">[:</span><span class="n">top_n</span><span class="p">]])</span>

<span class="n">counts_per_bin</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">))</span>
<span class="n">counts_per_bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>observed</th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
    </tr>
    <tr>
      <th>bin</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(22, 23]</th>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>(23, 24]</th>
      <td>21</td>
      <td>8</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
    </tr>
    <tr>
      <th>(24, 25]</th>
      <td>52</td>
      <td>35</td>
      <td>34</td>
      <td>32</td>
      <td>32</td>
    </tr>
    <tr>
      <th>(25, 26]</th>
      <td>76</td>
      <td>97</td>
      <td>104</td>
      <td>100</td>
      <td>99</td>
    </tr>
    <tr>
      <th>(26, 27]</th>
      <td>123</td>
      <td>138</td>
      <td>148</td>
      <td>144</td>
      <td>131</td>
    </tr>
    <tr>
      <th>(27, 28]</th>
      <td>137</td>
      <td>142</td>
      <td>139</td>
      <td>141</td>
      <td>146</td>
    </tr>
    <tr>
      <th>(28, 29]</th>
      <td>122</td>
      <td>132</td>
      <td>123</td>
      <td>128</td>
      <td>134</td>
    </tr>
    <tr>
      <th>(29, 30]</th>
      <td>96</td>
      <td>94</td>
      <td>85</td>
      <td>93</td>
      <td>85</td>
    </tr>
    <tr>
      <th>(30, 31]</th>
      <td>85</td>
      <td>79</td>
      <td>92</td>
      <td>75</td>
      <td>86</td>
    </tr>
    <tr>
      <th>(31, 32]</th>
      <td>71</td>
      <td>64</td>
      <td>49</td>
      <td>69</td>
      <td>66</td>
    </tr>
    <tr>
      <th>(32, 33]</th>
      <td>30</td>
      <td>34</td>
      <td>41</td>
      <td>33</td>
      <td>26</td>
    </tr>
    <tr>
      <th>(33, 34]</th>
      <td>25</td>
      <td>22</td>
      <td>22</td>
      <td>18</td>
      <td>24</td>
    </tr>
    <tr>
      <th>(34, 35]</th>
      <td>8</td>
      <td>10</td>
      <td>5</td>
      <td>9</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id1">
<h3>Correlation per sample<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_per_sample_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_test</span>
                        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_index_name</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">])</span>
                        <span class="p">[</span><span class="n">ORDER_MODELS</span><span class="p">])</span>
<span class="n">corr_per_sample_test</span> <span class="o">=</span> <span class="n">corr_per_sample_test</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">pred_test</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_index_name</span><span class="p">)[</span><span class="n">TARGET_COL</span><span class="p">]</span>
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;n_obs&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">too_few_obs</span> <span class="o">=</span> <span class="n">corr_per_sample_test</span><span class="p">[</span><span class="s1">&#39;n_obs&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span>
<span class="n">corr_per_sample_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">too_few_obs</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>n_obs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>50.000</td>
      <td>29.000</td>
      <td>50.000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.951</td>
      <td>0.947</td>
      <td>0.950</td>
      <td>0.950</td>
      <td>0.949</td>
      <td>0.949</td>
      <td>0.940</td>
      <td>0.930</td>
      <td>0.925</td>
      <td>0.850</td>
      <td>0.928</td>
      <td>0.928</td>
      <td>0.238</td>
      <td>0.773</td>
      <td>0.925</td>
      <td>0.878</td>
      <td>0.864</td>
      <td>0.039</td>
      <td>17.180</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.043</td>
      <td>0.053</td>
      <td>0.042</td>
      <td>0.047</td>
      <td>0.044</td>
      <td>0.038</td>
      <td>0.049</td>
      <td>0.056</td>
      <td>0.058</td>
      <td>0.137</td>
      <td>0.061</td>
      <td>0.061</td>
      <td>0.344</td>
      <td>0.078</td>
      <td>0.052</td>
      <td>0.072</td>
      <td>0.076</td>
      <td>0.284</td>
      <td>4.241</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.776</td>
      <td>0.722</td>
      <td>0.784</td>
      <td>0.738</td>
      <td>0.797</td>
      <td>0.801</td>
      <td>0.804</td>
      <td>0.761</td>
      <td>0.679</td>
      <td>0.297</td>
      <td>0.730</td>
      <td>0.730</td>
      <td>-0.435</td>
      <td>0.538</td>
      <td>0.780</td>
      <td>0.627</td>
      <td>0.596</td>
      <td>-0.396</td>
      <td>10.000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.934</td>
      <td>0.939</td>
      <td>0.934</td>
      <td>0.939</td>
      <td>0.939</td>
      <td>0.934</td>
      <td>0.925</td>
      <td>0.918</td>
      <td>0.902</td>
      <td>0.808</td>
      <td>0.914</td>
      <td>0.914</td>
      <td>-0.035</td>
      <td>0.734</td>
      <td>0.910</td>
      <td>0.858</td>
      <td>0.816</td>
      <td>-0.176</td>
      <td>14.250</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.965</td>
      <td>0.962</td>
      <td>0.963</td>
      <td>0.962</td>
      <td>0.965</td>
      <td>0.961</td>
      <td>0.950</td>
      <td>0.947</td>
      <td>0.943</td>
      <td>0.881</td>
      <td>0.948</td>
      <td>0.948</td>
      <td>0.257</td>
      <td>0.789</td>
      <td>0.939</td>
      <td>0.889</td>
      <td>0.883</td>
      <td>0.020</td>
      <td>16.000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.978</td>
      <td>0.977</td>
      <td>0.976</td>
      <td>0.981</td>
      <td>0.979</td>
      <td>0.976</td>
      <td>0.977</td>
      <td>0.965</td>
      <td>0.964</td>
      <td>0.949</td>
      <td>0.964</td>
      <td>0.964</td>
      <td>0.463</td>
      <td>0.830</td>
      <td>0.963</td>
      <td>0.928</td>
      <td>0.919</td>
      <td>0.168</td>
      <td>20.000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.992</td>
      <td>0.995</td>
      <td>0.996</td>
      <td>0.994</td>
      <td>0.990</td>
      <td>0.989</td>
      <td>0.994</td>
      <td>0.988</td>
      <td>0.989</td>
      <td>0.984</td>
      <td>0.986</td>
      <td>0.986</td>
      <td>0.858</td>
      <td>0.914</td>
      <td>0.986</td>
      <td>0.971</td>
      <td>0.974</td>
      <td>0.740</td>
      <td>26.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ! add minimum</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
              <span class="n">flierprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
              <span class="c1"># title=&#39;Corr. betw. fake NA and model predictions per sample on test data&#39;,</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;correlation per sample&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_sample_test</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">too_few_obs</span><span class="p">,</span> <span class="n">TOP_N_ORDER</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span>
      <span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                   <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_pred_corr_test_per_sample.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>

<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">corr_per_sample_test</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>
    <span class="n">corr_per_sample_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;correlations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_pred_corr_test_per_sample.pdf
</pre></div>
</div>
<img alt="_images/87687c7a552aad0ba90782ffece06a9ec62a2643e7769be63ceaee5e104c3c98.png" src="_images/87687c7a552aad0ba90782ffece06a9ec62a2643e7769be63ceaee5e104c3c98.png" />
</div>
</div>
<p>identify samples which are below lower whisker for models</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treshold</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">get_lower_whiskers</span><span class="p">(</span>
    <span class="n">corr_per_sample_test</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_sample_test</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">treshold</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">corr_per_sample_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;Nothing to display&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_b20d5_row0_col17, #T_b20d5_row1_col12, #T_b20d5_row2_col12, #T_b20d5_row3_col17, #T_b20d5_row4_col17, #T_b20d5_row5_col12 {
  background-color: yellow;
}
</style>
<table id="T_b20d5">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_b20d5_level0_col0" class="col_heading level0 col0" >TRKNN</th>
      <th id="T_b20d5_level0_col1" class="col_heading level0 col1" >DAE</th>
      <th id="T_b20d5_level0_col2" class="col_heading level0 col2" >RF</th>
      <th id="T_b20d5_level0_col3" class="col_heading level0 col3" >KNN</th>
      <th id="T_b20d5_level0_col4" class="col_heading level0 col4" >KNN_IMPUTE</th>
      <th id="T_b20d5_level0_col5" class="col_heading level0 col5" >SEQKNN</th>
      <th id="T_b20d5_level0_col6" class="col_heading level0 col6" >MICE-NORM</th>
      <th id="T_b20d5_level0_col7" class="col_heading level0 col7" >IRM</th>
      <th id="T_b20d5_level0_col8" class="col_heading level0 col8" >VAE</th>
      <th id="T_b20d5_level0_col9" class="col_heading level0 col9" >IMPSEQ</th>
      <th id="T_b20d5_level0_col10" class="col_heading level0 col10" >ROWMEDIAN</th>
      <th id="T_b20d5_level0_col11" class="col_heading level0 col11" >Median</th>
      <th id="T_b20d5_level0_col12" class="col_heading level0 col12" >SVDMETHOD</th>
      <th id="T_b20d5_level0_col13" class="col_heading level0 col13" >CF</th>
      <th id="T_b20d5_level0_col14" class="col_heading level0 col14" >MSIMPUTE_MNAR</th>
      <th id="T_b20d5_level0_col15" class="col_heading level0 col15" >QRILC</th>
      <th id="T_b20d5_level0_col16" class="col_heading level0 col16" >GSIMP</th>
      <th id="T_b20d5_level0_col17" class="col_heading level0 col17" >MLE</th>
      <th id="T_b20d5_level0_col18" class="col_heading level0 col18" >n_obs</th>
    </tr>
    <tr>
      <th class="index_name level0" >Sample ID</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
      <th class="blank col9" >&nbsp;</th>
      <th class="blank col10" >&nbsp;</th>
      <th class="blank col11" >&nbsp;</th>
      <th class="blank col12" >&nbsp;</th>
      <th class="blank col13" >&nbsp;</th>
      <th class="blank col14" >&nbsp;</th>
      <th class="blank col15" >&nbsp;</th>
      <th class="blank col16" >&nbsp;</th>
      <th class="blank col17" >&nbsp;</th>
      <th class="blank col18" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_b20d5_level0_row0" class="row_heading level0 row0" >2019_12_29_18_18_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row0_col0" class="data row0 col0" >0.776238</td>
      <td id="T_b20d5_row0_col1" class="data row0 col1" >0.817640</td>
      <td id="T_b20d5_row0_col2" class="data row0 col2" >0.783987</td>
      <td id="T_b20d5_row0_col3" class="data row0 col3" >0.737708</td>
      <td id="T_b20d5_row0_col4" class="data row0 col4" >0.797078</td>
      <td id="T_b20d5_row0_col5" class="data row0 col5" >0.800713</td>
      <td id="T_b20d5_row0_col6" class="data row0 col6" >0.804018</td>
      <td id="T_b20d5_row0_col7" class="data row0 col7" >0.812781</td>
      <td id="T_b20d5_row0_col8" class="data row0 col8" >0.822720</td>
      <td id="T_b20d5_row0_col9" class="data row0 col9" >0.832118</td>
      <td id="T_b20d5_row0_col10" class="data row0 col10" >0.836822</td>
      <td id="T_b20d5_row0_col11" class="data row0 col11" >0.836822</td>
      <td id="T_b20d5_row0_col12" class="data row0 col12" >0.343059</td>
      <td id="T_b20d5_row0_col13" class="data row0 col13" >0.707304</td>
      <td id="T_b20d5_row0_col14" class="data row0 col14" >0.801520</td>
      <td id="T_b20d5_row0_col15" class="data row0 col15" >0.659998</td>
      <td id="T_b20d5_row0_col16" class="data row0 col16" >0.682637</td>
      <td id="T_b20d5_row0_col17" class="data row0 col17" >0.129713</td>
      <td id="T_b20d5_row0_col18" class="data row0 col18" >13</td>
    </tr>
    <tr>
      <th id="T_b20d5_level0_row1" class="row_heading level0 row1" >2020_01_03_16_58_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row1_col0" class="data row1 col0" >0.889112</td>
      <td id="T_b20d5_row1_col1" class="data row1 col1" >0.915725</td>
      <td id="T_b20d5_row1_col2" class="data row1 col2" >0.895187</td>
      <td id="T_b20d5_row1_col3" class="data row1 col3" >0.909160</td>
      <td id="T_b20d5_row1_col4" class="data row1 col4" >0.850543</td>
      <td id="T_b20d5_row1_col5" class="data row1 col5" >0.902232</td>
      <td id="T_b20d5_row1_col6" class="data row1 col6" >0.852995</td>
      <td id="T_b20d5_row1_col7" class="data row1 col7" >0.835085</td>
      <td id="T_b20d5_row1_col8" class="data row1 col8" >0.678979</td>
      <td id="T_b20d5_row1_col9" class="data row1 col9" >0.823477</td>
      <td id="T_b20d5_row1_col10" class="data row1 col10" >0.729742</td>
      <td id="T_b20d5_row1_col11" class="data row1 col11" >0.729742</td>
      <td id="T_b20d5_row1_col12" class="data row1 col12" >-0.098112</td>
      <td id="T_b20d5_row1_col13" class="data row1 col13" >0.636916</td>
      <td id="T_b20d5_row1_col14" class="data row1 col14" >0.780364</td>
      <td id="T_b20d5_row1_col15" class="data row1 col15" >0.706490</td>
      <td id="T_b20d5_row1_col16" class="data row1 col16" >0.739038</td>
      <td id="T_b20d5_row1_col17" class="data row1 col17" >0.020248</td>
      <td id="T_b20d5_row1_col18" class="data row1 col18" >19</td>
    </tr>
    <tr>
      <th id="T_b20d5_level0_row2" class="row_heading level0 row2" >2020_01_15_13_56_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row2_col0" class="data row2 col0" >0.860285</td>
      <td id="T_b20d5_row2_col1" class="data row2 col1" >0.791893</td>
      <td id="T_b20d5_row2_col2" class="data row2 col2" >0.871310</td>
      <td id="T_b20d5_row2_col3" class="data row2 col3" >0.838000</td>
      <td id="T_b20d5_row2_col4" class="data row2 col4" >0.896348</td>
      <td id="T_b20d5_row2_col5" class="data row2 col5" >0.897088</td>
      <td id="T_b20d5_row2_col6" class="data row2 col6" >0.809542</td>
      <td id="T_b20d5_row2_col7" class="data row2 col7" >0.794405</td>
      <td id="T_b20d5_row2_col8" class="data row2 col8" >0.859092</td>
      <td id="T_b20d5_row2_col9" class="data row2 col9" >0.791691</td>
      <td id="T_b20d5_row2_col10" class="data row2 col10" >0.913852</td>
      <td id="T_b20d5_row2_col11" class="data row2 col11" >0.913852</td>
      <td id="T_b20d5_row2_col12" class="data row2 col12" >0.171509</td>
      <td id="T_b20d5_row2_col13" class="data row2 col13" >0.537776</td>
      <td id="T_b20d5_row2_col14" class="data row2 col14" >0.807383</td>
      <td id="T_b20d5_row2_col15" class="data row2 col15" >0.778404</td>
      <td id="T_b20d5_row2_col16" class="data row2 col16" >0.770122</td>
      <td id="T_b20d5_row2_col17" class="data row2 col17" >nan</td>
      <td id="T_b20d5_row2_col18" class="data row2 col18" >11</td>
    </tr>
    <tr>
      <th id="T_b20d5_level0_row3" class="row_heading level0 row3" >2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row3_col0" class="data row3 col0" >0.933212</td>
      <td id="T_b20d5_row3_col1" class="data row3 col1" >0.939196</td>
      <td id="T_b20d5_row3_col2" class="data row3 col2" >0.968512</td>
      <td id="T_b20d5_row3_col3" class="data row3 col3" >0.979123</td>
      <td id="T_b20d5_row3_col4" class="data row3 col4" >0.864863</td>
      <td id="T_b20d5_row3_col5" class="data row3 col5" >0.883346</td>
      <td id="T_b20d5_row3_col6" class="data row3 col6" >0.921776</td>
      <td id="T_b20d5_row3_col7" class="data row3 col7" >0.898464</td>
      <td id="T_b20d5_row3_col8" class="data row3 col8" >0.875935</td>
      <td id="T_b20d5_row3_col9" class="data row3 col9" >0.889232</td>
      <td id="T_b20d5_row3_col10" class="data row3 col10" >0.745208</td>
      <td id="T_b20d5_row3_col11" class="data row3 col11" >0.745208</td>
      <td id="T_b20d5_row3_col12" class="data row3 col12" >-0.037288</td>
      <td id="T_b20d5_row3_col13" class="data row3 col13" >0.750479</td>
      <td id="T_b20d5_row3_col14" class="data row3 col14" >0.835676</td>
      <td id="T_b20d5_row3_col15" class="data row3 col15" >0.627233</td>
      <td id="T_b20d5_row3_col16" class="data row3 col16" >0.792675</td>
      <td id="T_b20d5_row3_col17" class="data row3 col17" >-0.176193</td>
      <td id="T_b20d5_row3_col18" class="data row3 col18" >20</td>
    </tr>
    <tr>
      <th id="T_b20d5_level0_row4" class="row_heading level0 row4" >2020_03_06_16_22_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row4_col0" class="data row4 col0" >0.828184</td>
      <td id="T_b20d5_row4_col1" class="data row4 col1" >0.825772</td>
      <td id="T_b20d5_row4_col2" class="data row4 col2" >0.856511</td>
      <td id="T_b20d5_row4_col3" class="data row4 col3" >0.846603</td>
      <td id="T_b20d5_row4_col4" class="data row4 col4" >0.834826</td>
      <td id="T_b20d5_row4_col5" class="data row4 col5" >0.870369</td>
      <td id="T_b20d5_row4_col6" class="data row4 col6" >0.851568</td>
      <td id="T_b20d5_row4_col7" class="data row4 col7" >0.761048</td>
      <td id="T_b20d5_row4_col8" class="data row4 col8" >0.803652</td>
      <td id="T_b20d5_row4_col9" class="data row4 col9" >0.711289</td>
      <td id="T_b20d5_row4_col10" class="data row4 col10" >0.732300</td>
      <td id="T_b20d5_row4_col11" class="data row4 col11" >0.732300</td>
      <td id="T_b20d5_row4_col12" class="data row4 col12" >0.213552</td>
      <td id="T_b20d5_row4_col13" class="data row4 col13" >0.669688</td>
      <td id="T_b20d5_row4_col14" class="data row4 col14" >0.794653</td>
      <td id="T_b20d5_row4_col15" class="data row4 col15" >0.735245</td>
      <td id="T_b20d5_row4_col16" class="data row4 col16" >0.596385</td>
      <td id="T_b20d5_row4_col17" class="data row4 col17" >-0.305829</td>
      <td id="T_b20d5_row4_col18" class="data row4 col18" >12</td>
    </tr>
    <tr>
      <th id="T_b20d5_level0_row5" class="row_heading level0 row5" >2020_05_14_14_46_Q-Exactive-HF-X-Orbitrap_6070</th>
      <td id="T_b20d5_row5_col0" class="data row5 col0" >0.902006</td>
      <td id="T_b20d5_row5_col1" class="data row5 col1" >0.721539</td>
      <td id="T_b20d5_row5_col2" class="data row5 col2" >0.857095</td>
      <td id="T_b20d5_row5_col3" class="data row5 col3" >0.840420</td>
      <td id="T_b20d5_row5_col4" class="data row5 col4" >0.835797</td>
      <td id="T_b20d5_row5_col5" class="data row5 col5" >0.845635</td>
      <td id="T_b20d5_row5_col6" class="data row5 col6" >0.832429</td>
      <td id="T_b20d5_row5_col7" class="data row5 col7" >0.764600</td>
      <td id="T_b20d5_row5_col8" class="data row5 col8" >0.809961</td>
      <td id="T_b20d5_row5_col9" class="data row5 col9" >0.828381</td>
      <td id="T_b20d5_row5_col10" class="data row5 col10" >0.890895</td>
      <td id="T_b20d5_row5_col11" class="data row5 col11" >0.890895</td>
      <td id="T_b20d5_row5_col12" class="data row5 col12" >0.458540</td>
      <td id="T_b20d5_row5_col13" class="data row5 col13" >0.723519</td>
      <td id="T_b20d5_row5_col14" class="data row5 col14" >0.938423</td>
      <td id="T_b20d5_row5_col15" class="data row5 col15" >0.810859</td>
      <td id="T_b20d5_row5_col16" class="data row5 col16" >0.747747</td>
      <td id="T_b20d5_row5_col17" class="data row5 col17" >nan</td>
      <td id="T_b20d5_row5_col18" class="data row5 col18" >10</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">pred_test</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="n">pred_test</span><span class="o">.</span><span class="n">index</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">pred_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>observed</th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PXN</th>
      <td>26.924</td>
      <td>26.945</td>
      <td>26.410</td>
      <td>26.569</td>
      <td>26.832</td>
      <td>26.647</td>
      <td>26.674</td>
      <td>26.529</td>
      <td>27.190</td>
      <td>26.969</td>
      <td>25.288</td>
      <td>26.827</td>
      <td>26.827</td>
      <td>28.061</td>
      <td>28.354</td>
      <td>24.770</td>
      <td>23.840</td>
      <td>25.305</td>
      <td>2,355.271</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2020_02_18_18_55_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PXN</th>
      <td>25.957</td>
      <td>27.319</td>
      <td>26.724</td>
      <td>27.150</td>
      <td>27.234</td>
      <td>27.442</td>
      <td>27.392</td>
      <td>27.043</td>
      <td>27.726</td>
      <td>27.448</td>
      <td>27.929</td>
      <td>26.827</td>
      <td>26.827</td>
      <td>27.949</td>
      <td>28.326</td>
      <td>24.909</td>
      <td>24.175</td>
      <td>25.289</td>
      <td>2,360.002</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2020_05_12_18_10_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PXN</th>
      <td>24.688</td>
      <td>25.146</td>
      <td>25.492</td>
      <td>25.606</td>
      <td>25.513</td>
      <td>25.393</td>
      <td>25.420</td>
      <td>25.246</td>
      <td>24.794</td>
      <td>25.788</td>
      <td>24.565</td>
      <td>26.827</td>
      <td>26.827</td>
      <td>26.779</td>
      <td>28.319</td>
      <td>23.513</td>
      <td>24.944</td>
      <td>25.178</td>
      <td>2,437.956</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2020_06_01_15_41_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>PXN</th>
      <td>26.945</td>
      <td>27.834</td>
      <td>27.479</td>
      <td>27.754</td>
      <td>27.949</td>
      <td>27.347</td>
      <td>27.649</td>
      <td>26.255</td>
      <td>26.858</td>
      <td>27.014</td>
      <td>30.326</td>
      <td>26.827</td>
      <td>26.827</td>
      <td>28.798</td>
      <td>28.447</td>
      <td>24.645</td>
      <td>24.351</td>
      <td>25.280</td>
      <td>26.579</td>
      <td>46</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">feature_names</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pred_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>observed</th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020_01_04_10_03_Q-Exactive-HF-X-Orbitrap_6070</th>
      <th>NUP62</th>
      <td>25.316</td>
      <td>26.453</td>
      <td>27.416</td>
      <td>26.988</td>
      <td>26.820</td>
      <td>25.606</td>
      <td>26.342</td>
      <td>27.299</td>
      <td>26.001</td>
      <td>27.821</td>
      <td>26.884</td>
      <td>28.702</td>
      <td>28.702</td>
      <td>26.926</td>
      <td>28.490</td>
      <td>23.553</td>
      <td>26.968</td>
      <td>25.839</td>
      <td>26.715</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="correlation-per-feature">
<h3>Correlation per feature<a class="headerlink" href="#correlation-per-feature" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_per_feat_test</span> <span class="o">=</span> <span class="n">pred_test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">FEAT_NAME</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">TARGET_COL</span><span class="p">])[</span><span class="n">ORDER_MODELS</span><span class="p">]</span>
<span class="n">corr_per_feat_test</span> <span class="o">=</span> <span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pred_test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">FEAT_NAME</span><span class="p">)[</span>
    <span class="n">TARGET_COL</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;n_obs&#39;</span><span class="p">))</span>

<span class="n">too_few_obs</span> <span class="o">=</span> <span class="n">corr_per_feat_test</span><span class="p">[</span><span class="s1">&#39;n_obs&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span>
<span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">too_few_obs</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>n_obs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
      <td>152.000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.837</td>
      <td>0.820</td>
      <td>0.808</td>
      <td>0.812</td>
      <td>0.827</td>
      <td>0.816</td>
      <td>0.772</td>
      <td>0.757</td>
      <td>0.736</td>
      <td>0.635</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.728</td>
      <td>0.604</td>
      <td>0.745</td>
      <td>-0.031</td>
      <td>0.159</td>
      <td>-0.012</td>
      <td>3.809</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.342</td>
      <td>0.363</td>
      <td>0.369</td>
      <td>0.340</td>
      <td>0.345</td>
      <td>0.348</td>
      <td>0.412</td>
      <td>0.413</td>
      <td>0.405</td>
      <td>0.498</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.397</td>
      <td>0.429</td>
      <td>0.409</td>
      <td>0.654</td>
      <td>0.658</td>
      <td>0.672</td>
      <td>1.059</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.774</td>
      <td>-0.972</td>
      <td>-0.996</td>
      <td>-0.959</td>
      <td>-0.953</td>
      <td>-0.798</td>
      <td>-0.934</td>
      <td>-0.990</td>
      <td>-0.991</td>
      <td>-0.942</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.865</td>
      <td>-0.918</td>
      <td>-0.958</td>
      <td>-0.999</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>3.000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.868</td>
      <td>0.842</td>
      <td>0.827</td>
      <td>0.805</td>
      <td>0.827</td>
      <td>0.809</td>
      <td>0.811</td>
      <td>0.760</td>
      <td>0.708</td>
      <td>0.530</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.650</td>
      <td>0.401</td>
      <td>0.724</td>
      <td>-0.555</td>
      <td>-0.413</td>
      <td>-0.682</td>
      <td>3.000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.961</td>
      <td>0.959</td>
      <td>0.939</td>
      <td>0.942</td>
      <td>0.960</td>
      <td>0.954</td>
      <td>0.927</td>
      <td>0.923</td>
      <td>0.907</td>
      <td>0.862</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.889</td>
      <td>0.804</td>
      <td>0.919</td>
      <td>-0.125</td>
      <td>0.324</td>
      <td>0.079</td>
      <td>4.000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.989</td>
      <td>0.989</td>
      <td>0.984</td>
      <td>0.984</td>
      <td>0.987</td>
      <td>0.989</td>
      <td>0.982</td>
      <td>0.978</td>
      <td>0.975</td>
      <td>0.951</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.969</td>
      <td>0.922</td>
      <td>0.986</td>
      <td>0.556</td>
      <td>0.757</td>
      <td>0.565</td>
      <td>4.000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.988</td>
      <td>8.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">too_few_obs</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
      <th>SEQKNN</th>
      <th>MICE-NORM</th>
      <th>IRM</th>
      <th>VAE</th>
      <th>IMPSEQ</th>
      <th>ROWMEDIAN</th>
      <th>Median</th>
      <th>SVDMETHOD</th>
      <th>CF</th>
      <th>MSIMPUTE_MNAR</th>
      <th>QRILC</th>
      <th>GSIMP</th>
      <th>MLE</th>
      <th>n_obs</th>
    </tr>
    <tr>
      <th>Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ACTN1</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ACTR3</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>AP2S1</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ATP1A1</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ATP5J</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>VCP</th>
      <td>-1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>VPS29</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>VPS33A</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>WDR33</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>WNK1</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>1.000</td>
      <td>-1.000</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>94 rows  19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
              <span class="n">flierprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;correlation per </span><span class="si">{</span><span class="n">FEAT_NAME_DISPLAY</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_feat_test</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">too_few_obs</span><span class="p">,</span> <span class="n">TOP_N_ORDER</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span>
      <span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
      <span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_pred_corr_test_per_feat.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">too_few_obs</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>
    <span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;correlations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_pred_corr_test_per_feat.pdf
</pre></div>
</div>
<img alt="_images/8ab3f97ac64777400ff54f6a68265f151b67092b65cde41f765099777ad2edb4.png" src="_images/8ab3f97ac64777400ff54f6a68265f151b67092b65cde41f765099777ad2edb4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feat_count_test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">test_y</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">FEAT_NAME</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">feat_count_test</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span>
<span class="n">feat_count_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gene Names
AAR2     3
ABHD11   1
ACAD9    7
ACTL6A   3
ACTN1    2
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">treshold</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">get_lower_whiskers</span><span class="p">(</span>
    <span class="n">corr_per_feat_test</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_feat_test</span><span class="p">[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">treshold</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">highlight_min</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">tolerence</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">s</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">tolerence</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;background-color: </span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<span class="n">view</span> <span class="o">=</span> <span class="p">(</span><span class="n">corr_per_feat_test</span>
        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">feat_count_test</span><span class="p">)</span>
        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">view</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">view</span>
            <span class="o">.</span><span class="n">style</span><span class="o">.</span>
            <span class="n">apply</span><span class="p">(</span><span class="n">highlight_min</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">subset</span><span class="o">=</span><span class="n">corr_per_feat_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;None found&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_bb2fb_row0_col4, #T_bb2fb_row0_col5, #T_bb2fb_row0_col6, #T_bb2fb_row0_col7, #T_bb2fb_row0_col8, #T_bb2fb_row0_col12, #T_bb2fb_row0_col13, #T_bb2fb_row0_col14, #T_bb2fb_row1_col0, #T_bb2fb_row1_col1, #T_bb2fb_row1_col2, #T_bb2fb_row1_col3, #T_bb2fb_row1_col4, #T_bb2fb_row1_col5, #T_bb2fb_row1_col6, #T_bb2fb_row1_col7, #T_bb2fb_row1_col9, #T_bb2fb_row1_col12, #T_bb2fb_row1_col13, #T_bb2fb_row1_col14, #T_bb2fb_row1_col16, #T_bb2fb_row1_col17, #T_bb2fb_row2_col1, #T_bb2fb_row2_col6, #T_bb2fb_row2_col9, #T_bb2fb_row3_col2, #T_bb2fb_row3_col3, #T_bb2fb_row3_col6, #T_bb2fb_row3_col9, #T_bb2fb_row3_col12, #T_bb2fb_row4_col2, #T_bb2fb_row4_col3, #T_bb2fb_row4_col5, #T_bb2fb_row4_col6, #T_bb2fb_row4_col8, #T_bb2fb_row4_col9, #T_bb2fb_row4_col13, #T_bb2fb_row4_col14, #T_bb2fb_row4_col17, #T_bb2fb_row5_col0, #T_bb2fb_row5_col1, #T_bb2fb_row5_col2, #T_bb2fb_row5_col3, #T_bb2fb_row5_col4, #T_bb2fb_row5_col5, #T_bb2fb_row5_col6, #T_bb2fb_row5_col7, #T_bb2fb_row5_col8, #T_bb2fb_row5_col12, #T_bb2fb_row5_col14, #T_bb2fb_row5_col16, #T_bb2fb_row5_col17, #T_bb2fb_row6_col3, #T_bb2fb_row6_col15, #T_bb2fb_row6_col17, #T_bb2fb_row7_col0, #T_bb2fb_row7_col1, #T_bb2fb_row7_col2, #T_bb2fb_row7_col8, #T_bb2fb_row7_col13, #T_bb2fb_row7_col14, #T_bb2fb_row7_col15, #T_bb2fb_row7_col17, #T_bb2fb_row8_col1, #T_bb2fb_row8_col2, #T_bb2fb_row8_col3, #T_bb2fb_row8_col4, #T_bb2fb_row8_col6, #T_bb2fb_row8_col17, #T_bb2fb_row9_col4, #T_bb2fb_row9_col8, #T_bb2fb_row9_col9, #T_bb2fb_row9_col12, #T_bb2fb_row9_col13, #T_bb2fb_row10_col1, #T_bb2fb_row10_col3, #T_bb2fb_row10_col5, #T_bb2fb_row10_col12, #T_bb2fb_row10_col15, #T_bb2fb_row11_col4, #T_bb2fb_row11_col6, #T_bb2fb_row11_col7, #T_bb2fb_row11_col8, #T_bb2fb_row11_col12, #T_bb2fb_row11_col14, #T_bb2fb_row11_col17, #T_bb2fb_row12_col2, #T_bb2fb_row12_col6, #T_bb2fb_row12_col7, #T_bb2fb_row12_col9, #T_bb2fb_row12_col15, #T_bb2fb_row12_col17, #T_bb2fb_row13_col2, #T_bb2fb_row13_col8, #T_bb2fb_row13_col17, #T_bb2fb_row14_col1, #T_bb2fb_row14_col3, #T_bb2fb_row14_col12, #T_bb2fb_row14_col15, #T_bb2fb_row14_col16, #T_bb2fb_row15_col3, #T_bb2fb_row15_col17, #T_bb2fb_row16_col0, #T_bb2fb_row16_col1, #T_bb2fb_row16_col2, #T_bb2fb_row16_col3, #T_bb2fb_row16_col4, #T_bb2fb_row16_col5, #T_bb2fb_row16_col6, #T_bb2fb_row16_col7, #T_bb2fb_row16_col8, #T_bb2fb_row16_col9, #T_bb2fb_row16_col12, #T_bb2fb_row16_col13, #T_bb2fb_row16_col14, #T_bb2fb_row16_col15, #T_bb2fb_row16_col16, #T_bb2fb_row17_col0, #T_bb2fb_row17_col2, #T_bb2fb_row17_col4, #T_bb2fb_row17_col5, #T_bb2fb_row17_col8, #T_bb2fb_row17_col9, #T_bb2fb_row17_col12, #T_bb2fb_row17_col13, #T_bb2fb_row17_col14, #T_bb2fb_row17_col15, #T_bb2fb_row17_col16, #T_bb2fb_row18_col0, #T_bb2fb_row18_col1, #T_bb2fb_row18_col2, #T_bb2fb_row18_col3, #T_bb2fb_row18_col4, #T_bb2fb_row18_col5, #T_bb2fb_row18_col6, #T_bb2fb_row18_col8, #T_bb2fb_row18_col12, #T_bb2fb_row18_col14, #T_bb2fb_row18_col15, #T_bb2fb_row18_col16, #T_bb2fb_row19_col0, #T_bb2fb_row19_col3, #T_bb2fb_row19_col4, #T_bb2fb_row19_col5, #T_bb2fb_row19_col8, #T_bb2fb_row19_col9, #T_bb2fb_row19_col12, #T_bb2fb_row19_col13, #T_bb2fb_row19_col15, #T_bb2fb_row20_col1, #T_bb2fb_row20_col4, #T_bb2fb_row20_col8, #T_bb2fb_row20_col12, #T_bb2fb_row20_col14, #T_bb2fb_row20_col15, #T_bb2fb_row20_col17, #T_bb2fb_row21_col4, #T_bb2fb_row21_col5, #T_bb2fb_row21_col15, #T_bb2fb_row21_col17, #T_bb2fb_row22_col3, #T_bb2fb_row22_col15, #T_bb2fb_row22_col16, #T_bb2fb_row23_col2, #T_bb2fb_row23_col3, #T_bb2fb_row23_col8, #T_bb2fb_row23_col13, #T_bb2fb_row23_col14, #T_bb2fb_row23_col15, #T_bb2fb_row23_col16, #T_bb2fb_row24_col0, #T_bb2fb_row24_col1, #T_bb2fb_row24_col2, #T_bb2fb_row24_col4, #T_bb2fb_row24_col5, #T_bb2fb_row24_col6, #T_bb2fb_row24_col7, #T_bb2fb_row24_col8, #T_bb2fb_row24_col9, #T_bb2fb_row24_col12, #T_bb2fb_row24_col13, #T_bb2fb_row24_col14, #T_bb2fb_row24_col15, #T_bb2fb_row24_col17, #T_bb2fb_row25_col0, #T_bb2fb_row25_col1, #T_bb2fb_row25_col2, #T_bb2fb_row25_col3, #T_bb2fb_row25_col4, #T_bb2fb_row25_col5, #T_bb2fb_row25_col6, #T_bb2fb_row25_col7, #T_bb2fb_row25_col8, #T_bb2fb_row25_col9, #T_bb2fb_row25_col13, #T_bb2fb_row25_col14, #T_bb2fb_row25_col15, #T_bb2fb_row25_col16, #T_bb2fb_row25_col17, #T_bb2fb_row26_col0, #T_bb2fb_row26_col1, #T_bb2fb_row26_col2, #T_bb2fb_row26_col3, #T_bb2fb_row26_col4, #T_bb2fb_row26_col5, #T_bb2fb_row26_col6, #T_bb2fb_row26_col7, #T_bb2fb_row26_col8, #T_bb2fb_row26_col9, #T_bb2fb_row26_col12, #T_bb2fb_row26_col13, #T_bb2fb_row26_col14, #T_bb2fb_row26_col15, #T_bb2fb_row26_col17, #T_bb2fb_row27_col1, #T_bb2fb_row27_col9, #T_bb2fb_row27_col16, #T_bb2fb_row27_col17, #T_bb2fb_row28_col1, #T_bb2fb_row28_col2, #T_bb2fb_row28_col3, #T_bb2fb_row28_col5, #T_bb2fb_row28_col7, #T_bb2fb_row28_col8, #T_bb2fb_row28_col9, #T_bb2fb_row28_col12, #T_bb2fb_row28_col16, #T_bb2fb_row29_col3, #T_bb2fb_row29_col5, #T_bb2fb_row29_col8, #T_bb2fb_row29_col12, #T_bb2fb_row29_col13, #T_bb2fb_row30_col9, #T_bb2fb_row31_col15, #T_bb2fb_row32_col16, #T_bb2fb_row33_col13, #T_bb2fb_row34_col3, #T_bb2fb_row35_col7, #T_bb2fb_row36_col9, #T_bb2fb_row37_col2, #T_bb2fb_row38_col13, #T_bb2fb_row39_col17, #T_bb2fb_row40_col17, #T_bb2fb_row41_col17, #T_bb2fb_row42_col16, #T_bb2fb_row43_col16, #T_bb2fb_row44_col15, #T_bb2fb_row45_col12, #T_bb2fb_row46_col14, #T_bb2fb_row47_col15, #T_bb2fb_row48_col17, #T_bb2fb_row49_col16, #T_bb2fb_row50_col3, #T_bb2fb_row51_col17, #T_bb2fb_row52_col6, #T_bb2fb_row53_col16, #T_bb2fb_row54_col2 {
  background-color: yellow;
}
</style>
<table id="T_bb2fb">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_bb2fb_level0_col0" class="col_heading level0 col0" >TRKNN</th>
      <th id="T_bb2fb_level0_col1" class="col_heading level0 col1" >DAE</th>
      <th id="T_bb2fb_level0_col2" class="col_heading level0 col2" >RF</th>
      <th id="T_bb2fb_level0_col3" class="col_heading level0 col3" >KNN</th>
      <th id="T_bb2fb_level0_col4" class="col_heading level0 col4" >KNN_IMPUTE</th>
      <th id="T_bb2fb_level0_col5" class="col_heading level0 col5" >SEQKNN</th>
      <th id="T_bb2fb_level0_col6" class="col_heading level0 col6" >MICE-NORM</th>
      <th id="T_bb2fb_level0_col7" class="col_heading level0 col7" >IRM</th>
      <th id="T_bb2fb_level0_col8" class="col_heading level0 col8" >VAE</th>
      <th id="T_bb2fb_level0_col9" class="col_heading level0 col9" >IMPSEQ</th>
      <th id="T_bb2fb_level0_col10" class="col_heading level0 col10" >ROWMEDIAN</th>
      <th id="T_bb2fb_level0_col11" class="col_heading level0 col11" >Median</th>
      <th id="T_bb2fb_level0_col12" class="col_heading level0 col12" >SVDMETHOD</th>
      <th id="T_bb2fb_level0_col13" class="col_heading level0 col13" >CF</th>
      <th id="T_bb2fb_level0_col14" class="col_heading level0 col14" >MSIMPUTE_MNAR</th>
      <th id="T_bb2fb_level0_col15" class="col_heading level0 col15" >QRILC</th>
      <th id="T_bb2fb_level0_col16" class="col_heading level0 col16" >GSIMP</th>
      <th id="T_bb2fb_level0_col17" class="col_heading level0 col17" >MLE</th>
      <th id="T_bb2fb_level0_col18" class="col_heading level0 col18" >n_obs</th>
      <th id="T_bb2fb_level0_col19" class="col_heading level0 col19" >count</th>
    </tr>
    <tr>
      <th class="index_name level0" >Gene Names</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
      <th class="blank col9" >&nbsp;</th>
      <th class="blank col10" >&nbsp;</th>
      <th class="blank col11" >&nbsp;</th>
      <th class="blank col12" >&nbsp;</th>
      <th class="blank col13" >&nbsp;</th>
      <th class="blank col14" >&nbsp;</th>
      <th class="blank col15" >&nbsp;</th>
      <th class="blank col16" >&nbsp;</th>
      <th class="blank col17" >&nbsp;</th>
      <th class="blank col18" >&nbsp;</th>
      <th class="blank col19" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_bb2fb_level0_row0" class="row_heading level0 row0" >ACTN1</th>
      <td id="T_bb2fb_row0_col0" class="data row0 col0" >1.000000</td>
      <td id="T_bb2fb_row0_col1" class="data row0 col1" >1.000000</td>
      <td id="T_bb2fb_row0_col2" class="data row0 col2" >1.000000</td>
      <td id="T_bb2fb_row0_col3" class="data row0 col3" >1.000000</td>
      <td id="T_bb2fb_row0_col4" class="data row0 col4" >-1.000000</td>
      <td id="T_bb2fb_row0_col5" class="data row0 col5" >-1.000000</td>
      <td id="T_bb2fb_row0_col6" class="data row0 col6" >-1.000000</td>
      <td id="T_bb2fb_row0_col7" class="data row0 col7" >-1.000000</td>
      <td id="T_bb2fb_row0_col8" class="data row0 col8" >-1.000000</td>
      <td id="T_bb2fb_row0_col9" class="data row0 col9" >1.000000</td>
      <td id="T_bb2fb_row0_col10" class="data row0 col10" >nan</td>
      <td id="T_bb2fb_row0_col11" class="data row0 col11" >nan</td>
      <td id="T_bb2fb_row0_col12" class="data row0 col12" >-1.000000</td>
      <td id="T_bb2fb_row0_col13" class="data row0 col13" >-1.000000</td>
      <td id="T_bb2fb_row0_col14" class="data row0 col14" >-1.000000</td>
      <td id="T_bb2fb_row0_col15" class="data row0 col15" >1.000000</td>
      <td id="T_bb2fb_row0_col16" class="data row0 col16" >1.000000</td>
      <td id="T_bb2fb_row0_col17" class="data row0 col17" >1.000000</td>
      <td id="T_bb2fb_row0_col18" class="data row0 col18" >2</td>
      <td id="T_bb2fb_row0_col19" class="data row0 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row1" class="row_heading level0 row1" >MPP6</th>
      <td id="T_bb2fb_row1_col0" class="data row1 col0" >-1.000000</td>
      <td id="T_bb2fb_row1_col1" class="data row1 col1" >-1.000000</td>
      <td id="T_bb2fb_row1_col2" class="data row1 col2" >-1.000000</td>
      <td id="T_bb2fb_row1_col3" class="data row1 col3" >-1.000000</td>
      <td id="T_bb2fb_row1_col4" class="data row1 col4" >-1.000000</td>
      <td id="T_bb2fb_row1_col5" class="data row1 col5" >-1.000000</td>
      <td id="T_bb2fb_row1_col6" class="data row1 col6" >-1.000000</td>
      <td id="T_bb2fb_row1_col7" class="data row1 col7" >-1.000000</td>
      <td id="T_bb2fb_row1_col8" class="data row1 col8" >1.000000</td>
      <td id="T_bb2fb_row1_col9" class="data row1 col9" >-1.000000</td>
      <td id="T_bb2fb_row1_col10" class="data row1 col10" >nan</td>
      <td id="T_bb2fb_row1_col11" class="data row1 col11" >nan</td>
      <td id="T_bb2fb_row1_col12" class="data row1 col12" >-1.000000</td>
      <td id="T_bb2fb_row1_col13" class="data row1 col13" >-1.000000</td>
      <td id="T_bb2fb_row1_col14" class="data row1 col14" >-1.000000</td>
      <td id="T_bb2fb_row1_col15" class="data row1 col15" >1.000000</td>
      <td id="T_bb2fb_row1_col16" class="data row1 col16" >-1.000000</td>
      <td id="T_bb2fb_row1_col17" class="data row1 col17" >-1.000000</td>
      <td id="T_bb2fb_row1_col18" class="data row1 col18" >2</td>
      <td id="T_bb2fb_row1_col19" class="data row1 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row2" class="row_heading level0 row2" >MSH3</th>
      <td id="T_bb2fb_row2_col0" class="data row2 col0" >1.000000</td>
      <td id="T_bb2fb_row2_col1" class="data row2 col1" >-1.000000</td>
      <td id="T_bb2fb_row2_col2" class="data row2 col2" >1.000000</td>
      <td id="T_bb2fb_row2_col3" class="data row2 col3" >1.000000</td>
      <td id="T_bb2fb_row2_col4" class="data row2 col4" >1.000000</td>
      <td id="T_bb2fb_row2_col5" class="data row2 col5" >1.000000</td>
      <td id="T_bb2fb_row2_col6" class="data row2 col6" >-1.000000</td>
      <td id="T_bb2fb_row2_col7" class="data row2 col7" >1.000000</td>
      <td id="T_bb2fb_row2_col8" class="data row2 col8" >1.000000</td>
      <td id="T_bb2fb_row2_col9" class="data row2 col9" >-1.000000</td>
      <td id="T_bb2fb_row2_col10" class="data row2 col10" >nan</td>
      <td id="T_bb2fb_row2_col11" class="data row2 col11" >nan</td>
      <td id="T_bb2fb_row2_col12" class="data row2 col12" >1.000000</td>
      <td id="T_bb2fb_row2_col13" class="data row2 col13" >1.000000</td>
      <td id="T_bb2fb_row2_col14" class="data row2 col14" >1.000000</td>
      <td id="T_bb2fb_row2_col15" class="data row2 col15" >1.000000</td>
      <td id="T_bb2fb_row2_col16" class="data row2 col16" >1.000000</td>
      <td id="T_bb2fb_row2_col17" class="data row2 col17" >1.000000</td>
      <td id="T_bb2fb_row2_col18" class="data row2 col18" >2</td>
      <td id="T_bb2fb_row2_col19" class="data row2 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row3" class="row_heading level0 row3" >NDUFAF3</th>
      <td id="T_bb2fb_row3_col0" class="data row3 col0" >1.000000</td>
      <td id="T_bb2fb_row3_col1" class="data row3 col1" >1.000000</td>
      <td id="T_bb2fb_row3_col2" class="data row3 col2" >-1.000000</td>
      <td id="T_bb2fb_row3_col3" class="data row3 col3" >-1.000000</td>
      <td id="T_bb2fb_row3_col4" class="data row3 col4" >1.000000</td>
      <td id="T_bb2fb_row3_col5" class="data row3 col5" >1.000000</td>
      <td id="T_bb2fb_row3_col6" class="data row3 col6" >-1.000000</td>
      <td id="T_bb2fb_row3_col7" class="data row3 col7" >1.000000</td>
      <td id="T_bb2fb_row3_col8" class="data row3 col8" >1.000000</td>
      <td id="T_bb2fb_row3_col9" class="data row3 col9" >-1.000000</td>
      <td id="T_bb2fb_row3_col10" class="data row3 col10" >nan</td>
      <td id="T_bb2fb_row3_col11" class="data row3 col11" >nan</td>
      <td id="T_bb2fb_row3_col12" class="data row3 col12" >-1.000000</td>
      <td id="T_bb2fb_row3_col13" class="data row3 col13" >1.000000</td>
      <td id="T_bb2fb_row3_col14" class="data row3 col14" >1.000000</td>
      <td id="T_bb2fb_row3_col15" class="data row3 col15" >1.000000</td>
      <td id="T_bb2fb_row3_col16" class="data row3 col16" >1.000000</td>
      <td id="T_bb2fb_row3_col17" class="data row3 col17" >1.000000</td>
      <td id="T_bb2fb_row3_col18" class="data row3 col18" >2</td>
      <td id="T_bb2fb_row3_col19" class="data row3 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row4" class="row_heading level0 row4" >POLR2J3;POLR2J;POLR2J2</th>
      <td id="T_bb2fb_row4_col0" class="data row4 col0" >1.000000</td>
      <td id="T_bb2fb_row4_col1" class="data row4 col1" >1.000000</td>
      <td id="T_bb2fb_row4_col2" class="data row4 col2" >-1.000000</td>
      <td id="T_bb2fb_row4_col3" class="data row4 col3" >-1.000000</td>
      <td id="T_bb2fb_row4_col4" class="data row4 col4" >1.000000</td>
      <td id="T_bb2fb_row4_col5" class="data row4 col5" >-1.000000</td>
      <td id="T_bb2fb_row4_col6" class="data row4 col6" >-1.000000</td>
      <td id="T_bb2fb_row4_col7" class="data row4 col7" >1.000000</td>
      <td id="T_bb2fb_row4_col8" class="data row4 col8" >-1.000000</td>
      <td id="T_bb2fb_row4_col9" class="data row4 col9" >-1.000000</td>
      <td id="T_bb2fb_row4_col10" class="data row4 col10" >nan</td>
      <td id="T_bb2fb_row4_col11" class="data row4 col11" >nan</td>
      <td id="T_bb2fb_row4_col12" class="data row4 col12" >1.000000</td>
      <td id="T_bb2fb_row4_col13" class="data row4 col13" >-1.000000</td>
      <td id="T_bb2fb_row4_col14" class="data row4 col14" >-1.000000</td>
      <td id="T_bb2fb_row4_col15" class="data row4 col15" >1.000000</td>
      <td id="T_bb2fb_row4_col16" class="data row4 col16" >1.000000</td>
      <td id="T_bb2fb_row4_col17" class="data row4 col17" >-1.000000</td>
      <td id="T_bb2fb_row4_col18" class="data row4 col18" >2</td>
      <td id="T_bb2fb_row4_col19" class="data row4 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row5" class="row_heading level0 row5" >PRKAA1</th>
      <td id="T_bb2fb_row5_col0" class="data row5 col0" >-1.000000</td>
      <td id="T_bb2fb_row5_col1" class="data row5 col1" >-1.000000</td>
      <td id="T_bb2fb_row5_col2" class="data row5 col2" >-1.000000</td>
      <td id="T_bb2fb_row5_col3" class="data row5 col3" >-1.000000</td>
      <td id="T_bb2fb_row5_col4" class="data row5 col4" >-1.000000</td>
      <td id="T_bb2fb_row5_col5" class="data row5 col5" >-1.000000</td>
      <td id="T_bb2fb_row5_col6" class="data row5 col6" >-1.000000</td>
      <td id="T_bb2fb_row5_col7" class="data row5 col7" >-1.000000</td>
      <td id="T_bb2fb_row5_col8" class="data row5 col8" >-1.000000</td>
      <td id="T_bb2fb_row5_col9" class="data row5 col9" >1.000000</td>
      <td id="T_bb2fb_row5_col10" class="data row5 col10" >nan</td>
      <td id="T_bb2fb_row5_col11" class="data row5 col11" >nan</td>
      <td id="T_bb2fb_row5_col12" class="data row5 col12" >-1.000000</td>
      <td id="T_bb2fb_row5_col13" class="data row5 col13" >1.000000</td>
      <td id="T_bb2fb_row5_col14" class="data row5 col14" >-1.000000</td>
      <td id="T_bb2fb_row5_col15" class="data row5 col15" >1.000000</td>
      <td id="T_bb2fb_row5_col16" class="data row5 col16" >-1.000000</td>
      <td id="T_bb2fb_row5_col17" class="data row5 col17" >-1.000000</td>
      <td id="T_bb2fb_row5_col18" class="data row5 col18" >2</td>
      <td id="T_bb2fb_row5_col19" class="data row5 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row6" class="row_heading level0 row6" >PRMT7</th>
      <td id="T_bb2fb_row6_col0" class="data row6 col0" >1.000000</td>
      <td id="T_bb2fb_row6_col1" class="data row6 col1" >1.000000</td>
      <td id="T_bb2fb_row6_col2" class="data row6 col2" >1.000000</td>
      <td id="T_bb2fb_row6_col3" class="data row6 col3" >-1.000000</td>
      <td id="T_bb2fb_row6_col4" class="data row6 col4" >1.000000</td>
      <td id="T_bb2fb_row6_col5" class="data row6 col5" >1.000000</td>
      <td id="T_bb2fb_row6_col6" class="data row6 col6" >1.000000</td>
      <td id="T_bb2fb_row6_col7" class="data row6 col7" >1.000000</td>
      <td id="T_bb2fb_row6_col8" class="data row6 col8" >1.000000</td>
      <td id="T_bb2fb_row6_col9" class="data row6 col9" >1.000000</td>
      <td id="T_bb2fb_row6_col10" class="data row6 col10" >nan</td>
      <td id="T_bb2fb_row6_col11" class="data row6 col11" >nan</td>
      <td id="T_bb2fb_row6_col12" class="data row6 col12" >1.000000</td>
      <td id="T_bb2fb_row6_col13" class="data row6 col13" >1.000000</td>
      <td id="T_bb2fb_row6_col14" class="data row6 col14" >1.000000</td>
      <td id="T_bb2fb_row6_col15" class="data row6 col15" >-1.000000</td>
      <td id="T_bb2fb_row6_col16" class="data row6 col16" >1.000000</td>
      <td id="T_bb2fb_row6_col17" class="data row6 col17" >-1.000000</td>
      <td id="T_bb2fb_row6_col18" class="data row6 col18" >2</td>
      <td id="T_bb2fb_row6_col19" class="data row6 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row7" class="row_heading level0 row7" >PROCR</th>
      <td id="T_bb2fb_row7_col0" class="data row7 col0" >-1.000000</td>
      <td id="T_bb2fb_row7_col1" class="data row7 col1" >-1.000000</td>
      <td id="T_bb2fb_row7_col2" class="data row7 col2" >-1.000000</td>
      <td id="T_bb2fb_row7_col3" class="data row7 col3" >1.000000</td>
      <td id="T_bb2fb_row7_col4" class="data row7 col4" >1.000000</td>
      <td id="T_bb2fb_row7_col5" class="data row7 col5" >1.000000</td>
      <td id="T_bb2fb_row7_col6" class="data row7 col6" >1.000000</td>
      <td id="T_bb2fb_row7_col7" class="data row7 col7" >1.000000</td>
      <td id="T_bb2fb_row7_col8" class="data row7 col8" >-1.000000</td>
      <td id="T_bb2fb_row7_col9" class="data row7 col9" >1.000000</td>
      <td id="T_bb2fb_row7_col10" class="data row7 col10" >nan</td>
      <td id="T_bb2fb_row7_col11" class="data row7 col11" >nan</td>
      <td id="T_bb2fb_row7_col12" class="data row7 col12" >1.000000</td>
      <td id="T_bb2fb_row7_col13" class="data row7 col13" >-1.000000</td>
      <td id="T_bb2fb_row7_col14" class="data row7 col14" >-1.000000</td>
      <td id="T_bb2fb_row7_col15" class="data row7 col15" >-1.000000</td>
      <td id="T_bb2fb_row7_col16" class="data row7 col16" >1.000000</td>
      <td id="T_bb2fb_row7_col17" class="data row7 col17" >-1.000000</td>
      <td id="T_bb2fb_row7_col18" class="data row7 col18" >2</td>
      <td id="T_bb2fb_row7_col19" class="data row7 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row8" class="row_heading level0 row8" >PSMD5</th>
      <td id="T_bb2fb_row8_col0" class="data row8 col0" >1.000000</td>
      <td id="T_bb2fb_row8_col1" class="data row8 col1" >-1.000000</td>
      <td id="T_bb2fb_row8_col2" class="data row8 col2" >-1.000000</td>
      <td id="T_bb2fb_row8_col3" class="data row8 col3" >-1.000000</td>
      <td id="T_bb2fb_row8_col4" class="data row8 col4" >-1.000000</td>
      <td id="T_bb2fb_row8_col5" class="data row8 col5" >1.000000</td>
      <td id="T_bb2fb_row8_col6" class="data row8 col6" >-1.000000</td>
      <td id="T_bb2fb_row8_col7" class="data row8 col7" >1.000000</td>
      <td id="T_bb2fb_row8_col8" class="data row8 col8" >1.000000</td>
      <td id="T_bb2fb_row8_col9" class="data row8 col9" >1.000000</td>
      <td id="T_bb2fb_row8_col10" class="data row8 col10" >nan</td>
      <td id="T_bb2fb_row8_col11" class="data row8 col11" >nan</td>
      <td id="T_bb2fb_row8_col12" class="data row8 col12" >1.000000</td>
      <td id="T_bb2fb_row8_col13" class="data row8 col13" >1.000000</td>
      <td id="T_bb2fb_row8_col14" class="data row8 col14" >1.000000</td>
      <td id="T_bb2fb_row8_col15" class="data row8 col15" >1.000000</td>
      <td id="T_bb2fb_row8_col16" class="data row8 col16" >1.000000</td>
      <td id="T_bb2fb_row8_col17" class="data row8 col17" >-1.000000</td>
      <td id="T_bb2fb_row8_col18" class="data row8 col18" >2</td>
      <td id="T_bb2fb_row8_col19" class="data row8 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row9" class="row_heading level0 row9" >RAB35</th>
      <td id="T_bb2fb_row9_col0" class="data row9 col0" >1.000000</td>
      <td id="T_bb2fb_row9_col1" class="data row9 col1" >1.000000</td>
      <td id="T_bb2fb_row9_col2" class="data row9 col2" >1.000000</td>
      <td id="T_bb2fb_row9_col3" class="data row9 col3" >1.000000</td>
      <td id="T_bb2fb_row9_col4" class="data row9 col4" >-1.000000</td>
      <td id="T_bb2fb_row9_col5" class="data row9 col5" >1.000000</td>
      <td id="T_bb2fb_row9_col6" class="data row9 col6" >1.000000</td>
      <td id="T_bb2fb_row9_col7" class="data row9 col7" >1.000000</td>
      <td id="T_bb2fb_row9_col8" class="data row9 col8" >-1.000000</td>
      <td id="T_bb2fb_row9_col9" class="data row9 col9" >-1.000000</td>
      <td id="T_bb2fb_row9_col10" class="data row9 col10" >nan</td>
      <td id="T_bb2fb_row9_col11" class="data row9 col11" >nan</td>
      <td id="T_bb2fb_row9_col12" class="data row9 col12" >-1.000000</td>
      <td id="T_bb2fb_row9_col13" class="data row9 col13" >-1.000000</td>
      <td id="T_bb2fb_row9_col14" class="data row9 col14" >1.000000</td>
      <td id="T_bb2fb_row9_col15" class="data row9 col15" >1.000000</td>
      <td id="T_bb2fb_row9_col16" class="data row9 col16" >1.000000</td>
      <td id="T_bb2fb_row9_col17" class="data row9 col17" >1.000000</td>
      <td id="T_bb2fb_row9_col18" class="data row9 col18" >2</td>
      <td id="T_bb2fb_row9_col19" class="data row9 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row10" class="row_heading level0 row10" >SEC23A</th>
      <td id="T_bb2fb_row10_col0" class="data row10 col0" >1.000000</td>
      <td id="T_bb2fb_row10_col1" class="data row10 col1" >-1.000000</td>
      <td id="T_bb2fb_row10_col2" class="data row10 col2" >1.000000</td>
      <td id="T_bb2fb_row10_col3" class="data row10 col3" >-1.000000</td>
      <td id="T_bb2fb_row10_col4" class="data row10 col4" >1.000000</td>
      <td id="T_bb2fb_row10_col5" class="data row10 col5" >-1.000000</td>
      <td id="T_bb2fb_row10_col6" class="data row10 col6" >1.000000</td>
      <td id="T_bb2fb_row10_col7" class="data row10 col7" >1.000000</td>
      <td id="T_bb2fb_row10_col8" class="data row10 col8" >1.000000</td>
      <td id="T_bb2fb_row10_col9" class="data row10 col9" >1.000000</td>
      <td id="T_bb2fb_row10_col10" class="data row10 col10" >nan</td>
      <td id="T_bb2fb_row10_col11" class="data row10 col11" >nan</td>
      <td id="T_bb2fb_row10_col12" class="data row10 col12" >-1.000000</td>
      <td id="T_bb2fb_row10_col13" class="data row10 col13" >1.000000</td>
      <td id="T_bb2fb_row10_col14" class="data row10 col14" >1.000000</td>
      <td id="T_bb2fb_row10_col15" class="data row10 col15" >-1.000000</td>
      <td id="T_bb2fb_row10_col16" class="data row10 col16" >1.000000</td>
      <td id="T_bb2fb_row10_col17" class="data row10 col17" >1.000000</td>
      <td id="T_bb2fb_row10_col18" class="data row10 col18" >2</td>
      <td id="T_bb2fb_row10_col19" class="data row10 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row11" class="row_heading level0 row11" >SLC25A19</th>
      <td id="T_bb2fb_row11_col0" class="data row11 col0" >1.000000</td>
      <td id="T_bb2fb_row11_col1" class="data row11 col1" >1.000000</td>
      <td id="T_bb2fb_row11_col2" class="data row11 col2" >1.000000</td>
      <td id="T_bb2fb_row11_col3" class="data row11 col3" >1.000000</td>
      <td id="T_bb2fb_row11_col4" class="data row11 col4" >-1.000000</td>
      <td id="T_bb2fb_row11_col5" class="data row11 col5" >1.000000</td>
      <td id="T_bb2fb_row11_col6" class="data row11 col6" >-1.000000</td>
      <td id="T_bb2fb_row11_col7" class="data row11 col7" >-1.000000</td>
      <td id="T_bb2fb_row11_col8" class="data row11 col8" >-1.000000</td>
      <td id="T_bb2fb_row11_col9" class="data row11 col9" >1.000000</td>
      <td id="T_bb2fb_row11_col10" class="data row11 col10" >nan</td>
      <td id="T_bb2fb_row11_col11" class="data row11 col11" >nan</td>
      <td id="T_bb2fb_row11_col12" class="data row11 col12" >-1.000000</td>
      <td id="T_bb2fb_row11_col13" class="data row11 col13" >1.000000</td>
      <td id="T_bb2fb_row11_col14" class="data row11 col14" >-1.000000</td>
      <td id="T_bb2fb_row11_col15" class="data row11 col15" >1.000000</td>
      <td id="T_bb2fb_row11_col16" class="data row11 col16" >1.000000</td>
      <td id="T_bb2fb_row11_col17" class="data row11 col17" >-1.000000</td>
      <td id="T_bb2fb_row11_col18" class="data row11 col18" >2</td>
      <td id="T_bb2fb_row11_col19" class="data row11 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row12" class="row_heading level0 row12" >SLC35A4</th>
      <td id="T_bb2fb_row12_col0" class="data row12 col0" >1.000000</td>
      <td id="T_bb2fb_row12_col1" class="data row12 col1" >1.000000</td>
      <td id="T_bb2fb_row12_col2" class="data row12 col2" >-1.000000</td>
      <td id="T_bb2fb_row12_col3" class="data row12 col3" >1.000000</td>
      <td id="T_bb2fb_row12_col4" class="data row12 col4" >1.000000</td>
      <td id="T_bb2fb_row12_col5" class="data row12 col5" >1.000000</td>
      <td id="T_bb2fb_row12_col6" class="data row12 col6" >-1.000000</td>
      <td id="T_bb2fb_row12_col7" class="data row12 col7" >-1.000000</td>
      <td id="T_bb2fb_row12_col8" class="data row12 col8" >1.000000</td>
      <td id="T_bb2fb_row12_col9" class="data row12 col9" >-1.000000</td>
      <td id="T_bb2fb_row12_col10" class="data row12 col10" >nan</td>
      <td id="T_bb2fb_row12_col11" class="data row12 col11" >nan</td>
      <td id="T_bb2fb_row12_col12" class="data row12 col12" >1.000000</td>
      <td id="T_bb2fb_row12_col13" class="data row12 col13" >1.000000</td>
      <td id="T_bb2fb_row12_col14" class="data row12 col14" >1.000000</td>
      <td id="T_bb2fb_row12_col15" class="data row12 col15" >-1.000000</td>
      <td id="T_bb2fb_row12_col16" class="data row12 col16" >1.000000</td>
      <td id="T_bb2fb_row12_col17" class="data row12 col17" >-1.000000</td>
      <td id="T_bb2fb_row12_col18" class="data row12 col18" >2</td>
      <td id="T_bb2fb_row12_col19" class="data row12 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row13" class="row_heading level0 row13" >SLC7A5</th>
      <td id="T_bb2fb_row13_col0" class="data row13 col0" >1.000000</td>
      <td id="T_bb2fb_row13_col1" class="data row13 col1" >1.000000</td>
      <td id="T_bb2fb_row13_col2" class="data row13 col2" >-1.000000</td>
      <td id="T_bb2fb_row13_col3" class="data row13 col3" >1.000000</td>
      <td id="T_bb2fb_row13_col4" class="data row13 col4" >1.000000</td>
      <td id="T_bb2fb_row13_col5" class="data row13 col5" >1.000000</td>
      <td id="T_bb2fb_row13_col6" class="data row13 col6" >1.000000</td>
      <td id="T_bb2fb_row13_col7" class="data row13 col7" >1.000000</td>
      <td id="T_bb2fb_row13_col8" class="data row13 col8" >-1.000000</td>
      <td id="T_bb2fb_row13_col9" class="data row13 col9" >1.000000</td>
      <td id="T_bb2fb_row13_col10" class="data row13 col10" >nan</td>
      <td id="T_bb2fb_row13_col11" class="data row13 col11" >nan</td>
      <td id="T_bb2fb_row13_col12" class="data row13 col12" >1.000000</td>
      <td id="T_bb2fb_row13_col13" class="data row13 col13" >1.000000</td>
      <td id="T_bb2fb_row13_col14" class="data row13 col14" >1.000000</td>
      <td id="T_bb2fb_row13_col15" class="data row13 col15" >1.000000</td>
      <td id="T_bb2fb_row13_col16" class="data row13 col16" >1.000000</td>
      <td id="T_bb2fb_row13_col17" class="data row13 col17" >-1.000000</td>
      <td id="T_bb2fb_row13_col18" class="data row13 col18" >2</td>
      <td id="T_bb2fb_row13_col19" class="data row13 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row14" class="row_heading level0 row14" >SUMO3</th>
      <td id="T_bb2fb_row14_col0" class="data row14 col0" >1.000000</td>
      <td id="T_bb2fb_row14_col1" class="data row14 col1" >-1.000000</td>
      <td id="T_bb2fb_row14_col2" class="data row14 col2" >1.000000</td>
      <td id="T_bb2fb_row14_col3" class="data row14 col3" >-1.000000</td>
      <td id="T_bb2fb_row14_col4" class="data row14 col4" >1.000000</td>
      <td id="T_bb2fb_row14_col5" class="data row14 col5" >1.000000</td>
      <td id="T_bb2fb_row14_col6" class="data row14 col6" >1.000000</td>
      <td id="T_bb2fb_row14_col7" class="data row14 col7" >1.000000</td>
      <td id="T_bb2fb_row14_col8" class="data row14 col8" >1.000000</td>
      <td id="T_bb2fb_row14_col9" class="data row14 col9" >1.000000</td>
      <td id="T_bb2fb_row14_col10" class="data row14 col10" >nan</td>
      <td id="T_bb2fb_row14_col11" class="data row14 col11" >nan</td>
      <td id="T_bb2fb_row14_col12" class="data row14 col12" >-1.000000</td>
      <td id="T_bb2fb_row14_col13" class="data row14 col13" >1.000000</td>
      <td id="T_bb2fb_row14_col14" class="data row14 col14" >1.000000</td>
      <td id="T_bb2fb_row14_col15" class="data row14 col15" >-1.000000</td>
      <td id="T_bb2fb_row14_col16" class="data row14 col16" >-1.000000</td>
      <td id="T_bb2fb_row14_col17" class="data row14 col17" >1.000000</td>
      <td id="T_bb2fb_row14_col18" class="data row14 col18" >2</td>
      <td id="T_bb2fb_row14_col19" class="data row14 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row15" class="row_heading level0 row15" >TRAF2</th>
      <td id="T_bb2fb_row15_col0" class="data row15 col0" >1.000000</td>
      <td id="T_bb2fb_row15_col1" class="data row15 col1" >1.000000</td>
      <td id="T_bb2fb_row15_col2" class="data row15 col2" >1.000000</td>
      <td id="T_bb2fb_row15_col3" class="data row15 col3" >-1.000000</td>
      <td id="T_bb2fb_row15_col4" class="data row15 col4" >1.000000</td>
      <td id="T_bb2fb_row15_col5" class="data row15 col5" >1.000000</td>
      <td id="T_bb2fb_row15_col6" class="data row15 col6" >1.000000</td>
      <td id="T_bb2fb_row15_col7" class="data row15 col7" >1.000000</td>
      <td id="T_bb2fb_row15_col8" class="data row15 col8" >1.000000</td>
      <td id="T_bb2fb_row15_col9" class="data row15 col9" >1.000000</td>
      <td id="T_bb2fb_row15_col10" class="data row15 col10" >nan</td>
      <td id="T_bb2fb_row15_col11" class="data row15 col11" >nan</td>
      <td id="T_bb2fb_row15_col12" class="data row15 col12" >1.000000</td>
      <td id="T_bb2fb_row15_col13" class="data row15 col13" >1.000000</td>
      <td id="T_bb2fb_row15_col14" class="data row15 col14" >1.000000</td>
      <td id="T_bb2fb_row15_col15" class="data row15 col15" >1.000000</td>
      <td id="T_bb2fb_row15_col16" class="data row15 col16" >1.000000</td>
      <td id="T_bb2fb_row15_col17" class="data row15 col17" >-1.000000</td>
      <td id="T_bb2fb_row15_col18" class="data row15 col18" >2</td>
      <td id="T_bb2fb_row15_col19" class="data row15 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row16" class="row_heading level0 row16" >UTRN</th>
      <td id="T_bb2fb_row16_col0" class="data row16 col0" >-1.000000</td>
      <td id="T_bb2fb_row16_col1" class="data row16 col1" >-1.000000</td>
      <td id="T_bb2fb_row16_col2" class="data row16 col2" >-1.000000</td>
      <td id="T_bb2fb_row16_col3" class="data row16 col3" >-1.000000</td>
      <td id="T_bb2fb_row16_col4" class="data row16 col4" >-1.000000</td>
      <td id="T_bb2fb_row16_col5" class="data row16 col5" >-1.000000</td>
      <td id="T_bb2fb_row16_col6" class="data row16 col6" >-1.000000</td>
      <td id="T_bb2fb_row16_col7" class="data row16 col7" >-1.000000</td>
      <td id="T_bb2fb_row16_col8" class="data row16 col8" >-1.000000</td>
      <td id="T_bb2fb_row16_col9" class="data row16 col9" >-1.000000</td>
      <td id="T_bb2fb_row16_col10" class="data row16 col10" >nan</td>
      <td id="T_bb2fb_row16_col11" class="data row16 col11" >nan</td>
      <td id="T_bb2fb_row16_col12" class="data row16 col12" >-1.000000</td>
      <td id="T_bb2fb_row16_col13" class="data row16 col13" >-1.000000</td>
      <td id="T_bb2fb_row16_col14" class="data row16 col14" >-1.000000</td>
      <td id="T_bb2fb_row16_col15" class="data row16 col15" >-1.000000</td>
      <td id="T_bb2fb_row16_col16" class="data row16 col16" >-1.000000</td>
      <td id="T_bb2fb_row16_col17" class="data row16 col17" >1.000000</td>
      <td id="T_bb2fb_row16_col18" class="data row16 col18" >2</td>
      <td id="T_bb2fb_row16_col19" class="data row16 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row17" class="row_heading level0 row17" >VCP</th>
      <td id="T_bb2fb_row17_col0" class="data row17 col0" >-1.000000</td>
      <td id="T_bb2fb_row17_col1" class="data row17 col1" >1.000000</td>
      <td id="T_bb2fb_row17_col2" class="data row17 col2" >-1.000000</td>
      <td id="T_bb2fb_row17_col3" class="data row17 col3" >1.000000</td>
      <td id="T_bb2fb_row17_col4" class="data row17 col4" >-1.000000</td>
      <td id="T_bb2fb_row17_col5" class="data row17 col5" >-1.000000</td>
      <td id="T_bb2fb_row17_col6" class="data row17 col6" >1.000000</td>
      <td id="T_bb2fb_row17_col7" class="data row17 col7" >1.000000</td>
      <td id="T_bb2fb_row17_col8" class="data row17 col8" >-1.000000</td>
      <td id="T_bb2fb_row17_col9" class="data row17 col9" >-1.000000</td>
      <td id="T_bb2fb_row17_col10" class="data row17 col10" >nan</td>
      <td id="T_bb2fb_row17_col11" class="data row17 col11" >nan</td>
      <td id="T_bb2fb_row17_col12" class="data row17 col12" >-1.000000</td>
      <td id="T_bb2fb_row17_col13" class="data row17 col13" >-1.000000</td>
      <td id="T_bb2fb_row17_col14" class="data row17 col14" >-1.000000</td>
      <td id="T_bb2fb_row17_col15" class="data row17 col15" >-1.000000</td>
      <td id="T_bb2fb_row17_col16" class="data row17 col16" >-1.000000</td>
      <td id="T_bb2fb_row17_col17" class="data row17 col17" >1.000000</td>
      <td id="T_bb2fb_row17_col18" class="data row17 col18" >2</td>
      <td id="T_bb2fb_row17_col19" class="data row17 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row18" class="row_heading level0 row18" >LUC7L3</th>
      <td id="T_bb2fb_row18_col0" class="data row18 col0" >-1.000000</td>
      <td id="T_bb2fb_row18_col1" class="data row18 col1" >-1.000000</td>
      <td id="T_bb2fb_row18_col2" class="data row18 col2" >-1.000000</td>
      <td id="T_bb2fb_row18_col3" class="data row18 col3" >-1.000000</td>
      <td id="T_bb2fb_row18_col4" class="data row18 col4" >-1.000000</td>
      <td id="T_bb2fb_row18_col5" class="data row18 col5" >-1.000000</td>
      <td id="T_bb2fb_row18_col6" class="data row18 col6" >-1.000000</td>
      <td id="T_bb2fb_row18_col7" class="data row18 col7" >1.000000</td>
      <td id="T_bb2fb_row18_col8" class="data row18 col8" >-1.000000</td>
      <td id="T_bb2fb_row18_col9" class="data row18 col9" >1.000000</td>
      <td id="T_bb2fb_row18_col10" class="data row18 col10" >nan</td>
      <td id="T_bb2fb_row18_col11" class="data row18 col11" >nan</td>
      <td id="T_bb2fb_row18_col12" class="data row18 col12" >-1.000000</td>
      <td id="T_bb2fb_row18_col13" class="data row18 col13" >1.000000</td>
      <td id="T_bb2fb_row18_col14" class="data row18 col14" >-1.000000</td>
      <td id="T_bb2fb_row18_col15" class="data row18 col15" >-1.000000</td>
      <td id="T_bb2fb_row18_col16" class="data row18 col16" >-1.000000</td>
      <td id="T_bb2fb_row18_col17" class="data row18 col17" >1.000000</td>
      <td id="T_bb2fb_row18_col18" class="data row18 col18" >2</td>
      <td id="T_bb2fb_row18_col19" class="data row18 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row19" class="row_heading level0 row19" >IPO11</th>
      <td id="T_bb2fb_row19_col0" class="data row19 col0" >-1.000000</td>
      <td id="T_bb2fb_row19_col1" class="data row19 col1" >1.000000</td>
      <td id="T_bb2fb_row19_col2" class="data row19 col2" >1.000000</td>
      <td id="T_bb2fb_row19_col3" class="data row19 col3" >-1.000000</td>
      <td id="T_bb2fb_row19_col4" class="data row19 col4" >-1.000000</td>
      <td id="T_bb2fb_row19_col5" class="data row19 col5" >-1.000000</td>
      <td id="T_bb2fb_row19_col6" class="data row19 col6" >1.000000</td>
      <td id="T_bb2fb_row19_col7" class="data row19 col7" >1.000000</td>
      <td id="T_bb2fb_row19_col8" class="data row19 col8" >-1.000000</td>
      <td id="T_bb2fb_row19_col9" class="data row19 col9" >-1.000000</td>
      <td id="T_bb2fb_row19_col10" class="data row19 col10" >nan</td>
      <td id="T_bb2fb_row19_col11" class="data row19 col11" >nan</td>
      <td id="T_bb2fb_row19_col12" class="data row19 col12" >-1.000000</td>
      <td id="T_bb2fb_row19_col13" class="data row19 col13" >-1.000000</td>
      <td id="T_bb2fb_row19_col14" class="data row19 col14" >1.000000</td>
      <td id="T_bb2fb_row19_col15" class="data row19 col15" >-1.000000</td>
      <td id="T_bb2fb_row19_col16" class="data row19 col16" >1.000000</td>
      <td id="T_bb2fb_row19_col17" class="data row19 col17" >1.000000</td>
      <td id="T_bb2fb_row19_col18" class="data row19 col18" >2</td>
      <td id="T_bb2fb_row19_col19" class="data row19 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row20" class="row_heading level0 row20" >NCAPD2</th>
      <td id="T_bb2fb_row20_col0" class="data row20 col0" >1.000000</td>
      <td id="T_bb2fb_row20_col1" class="data row20 col1" >-1.000000</td>
      <td id="T_bb2fb_row20_col2" class="data row20 col2" >1.000000</td>
      <td id="T_bb2fb_row20_col3" class="data row20 col3" >1.000000</td>
      <td id="T_bb2fb_row20_col4" class="data row20 col4" >-1.000000</td>
      <td id="T_bb2fb_row20_col5" class="data row20 col5" >1.000000</td>
      <td id="T_bb2fb_row20_col6" class="data row20 col6" >1.000000</td>
      <td id="T_bb2fb_row20_col7" class="data row20 col7" >1.000000</td>
      <td id="T_bb2fb_row20_col8" class="data row20 col8" >-1.000000</td>
      <td id="T_bb2fb_row20_col9" class="data row20 col9" >1.000000</td>
      <td id="T_bb2fb_row20_col10" class="data row20 col10" >nan</td>
      <td id="T_bb2fb_row20_col11" class="data row20 col11" >nan</td>
      <td id="T_bb2fb_row20_col12" class="data row20 col12" >-1.000000</td>
      <td id="T_bb2fb_row20_col13" class="data row20 col13" >1.000000</td>
      <td id="T_bb2fb_row20_col14" class="data row20 col14" >-1.000000</td>
      <td id="T_bb2fb_row20_col15" class="data row20 col15" >-1.000000</td>
      <td id="T_bb2fb_row20_col16" class="data row20 col16" >1.000000</td>
      <td id="T_bb2fb_row20_col17" class="data row20 col17" >-1.000000</td>
      <td id="T_bb2fb_row20_col18" class="data row20 col18" >2</td>
      <td id="T_bb2fb_row20_col19" class="data row20 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row21" class="row_heading level0 row21" >WNK1</th>
      <td id="T_bb2fb_row21_col0" class="data row21 col0" >1.000000</td>
      <td id="T_bb2fb_row21_col1" class="data row21 col1" >1.000000</td>
      <td id="T_bb2fb_row21_col2" class="data row21 col2" >1.000000</td>
      <td id="T_bb2fb_row21_col3" class="data row21 col3" >1.000000</td>
      <td id="T_bb2fb_row21_col4" class="data row21 col4" >-1.000000</td>
      <td id="T_bb2fb_row21_col5" class="data row21 col5" >-1.000000</td>
      <td id="T_bb2fb_row21_col6" class="data row21 col6" >1.000000</td>
      <td id="T_bb2fb_row21_col7" class="data row21 col7" >1.000000</td>
      <td id="T_bb2fb_row21_col8" class="data row21 col8" >1.000000</td>
      <td id="T_bb2fb_row21_col9" class="data row21 col9" >1.000000</td>
      <td id="T_bb2fb_row21_col10" class="data row21 col10" >nan</td>
      <td id="T_bb2fb_row21_col11" class="data row21 col11" >nan</td>
      <td id="T_bb2fb_row21_col12" class="data row21 col12" >1.000000</td>
      <td id="T_bb2fb_row21_col13" class="data row21 col13" >1.000000</td>
      <td id="T_bb2fb_row21_col14" class="data row21 col14" >1.000000</td>
      <td id="T_bb2fb_row21_col15" class="data row21 col15" >-1.000000</td>
      <td id="T_bb2fb_row21_col16" class="data row21 col16" >1.000000</td>
      <td id="T_bb2fb_row21_col17" class="data row21 col17" >-1.000000</td>
      <td id="T_bb2fb_row21_col18" class="data row21 col18" >2</td>
      <td id="T_bb2fb_row21_col19" class="data row21 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row22" class="row_heading level0 row22" >AP2S1</th>
      <td id="T_bb2fb_row22_col0" class="data row22 col0" >1.000000</td>
      <td id="T_bb2fb_row22_col1" class="data row22 col1" >1.000000</td>
      <td id="T_bb2fb_row22_col2" class="data row22 col2" >1.000000</td>
      <td id="T_bb2fb_row22_col3" class="data row22 col3" >-1.000000</td>
      <td id="T_bb2fb_row22_col4" class="data row22 col4" >1.000000</td>
      <td id="T_bb2fb_row22_col5" class="data row22 col5" >1.000000</td>
      <td id="T_bb2fb_row22_col6" class="data row22 col6" >1.000000</td>
      <td id="T_bb2fb_row22_col7" class="data row22 col7" >1.000000</td>
      <td id="T_bb2fb_row22_col8" class="data row22 col8" >1.000000</td>
      <td id="T_bb2fb_row22_col9" class="data row22 col9" >1.000000</td>
      <td id="T_bb2fb_row22_col10" class="data row22 col10" >nan</td>
      <td id="T_bb2fb_row22_col11" class="data row22 col11" >nan</td>
      <td id="T_bb2fb_row22_col12" class="data row22 col12" >1.000000</td>
      <td id="T_bb2fb_row22_col13" class="data row22 col13" >1.000000</td>
      <td id="T_bb2fb_row22_col14" class="data row22 col14" >1.000000</td>
      <td id="T_bb2fb_row22_col15" class="data row22 col15" >-1.000000</td>
      <td id="T_bb2fb_row22_col16" class="data row22 col16" >-1.000000</td>
      <td id="T_bb2fb_row22_col17" class="data row22 col17" >1.000000</td>
      <td id="T_bb2fb_row22_col18" class="data row22 col18" >2</td>
      <td id="T_bb2fb_row22_col19" class="data row22 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row23" class="row_heading level0 row23" >GGA2</th>
      <td id="T_bb2fb_row23_col0" class="data row23 col0" >1.000000</td>
      <td id="T_bb2fb_row23_col1" class="data row23 col1" >1.000000</td>
      <td id="T_bb2fb_row23_col2" class="data row23 col2" >-1.000000</td>
      <td id="T_bb2fb_row23_col3" class="data row23 col3" >-1.000000</td>
      <td id="T_bb2fb_row23_col4" class="data row23 col4" >1.000000</td>
      <td id="T_bb2fb_row23_col5" class="data row23 col5" >1.000000</td>
      <td id="T_bb2fb_row23_col6" class="data row23 col6" >1.000000</td>
      <td id="T_bb2fb_row23_col7" class="data row23 col7" >1.000000</td>
      <td id="T_bb2fb_row23_col8" class="data row23 col8" >-1.000000</td>
      <td id="T_bb2fb_row23_col9" class="data row23 col9" >1.000000</td>
      <td id="T_bb2fb_row23_col10" class="data row23 col10" >nan</td>
      <td id="T_bb2fb_row23_col11" class="data row23 col11" >nan</td>
      <td id="T_bb2fb_row23_col12" class="data row23 col12" >1.000000</td>
      <td id="T_bb2fb_row23_col13" class="data row23 col13" >-1.000000</td>
      <td id="T_bb2fb_row23_col14" class="data row23 col14" >-1.000000</td>
      <td id="T_bb2fb_row23_col15" class="data row23 col15" >-1.000000</td>
      <td id="T_bb2fb_row23_col16" class="data row23 col16" >-1.000000</td>
      <td id="T_bb2fb_row23_col17" class="data row23 col17" >1.000000</td>
      <td id="T_bb2fb_row23_col18" class="data row23 col18" >2</td>
      <td id="T_bb2fb_row23_col19" class="data row23 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row24" class="row_heading level0 row24" >FN3KRP</th>
      <td id="T_bb2fb_row24_col0" class="data row24 col0" >-1.000000</td>
      <td id="T_bb2fb_row24_col1" class="data row24 col1" >-1.000000</td>
      <td id="T_bb2fb_row24_col2" class="data row24 col2" >-1.000000</td>
      <td id="T_bb2fb_row24_col3" class="data row24 col3" >1.000000</td>
      <td id="T_bb2fb_row24_col4" class="data row24 col4" >-1.000000</td>
      <td id="T_bb2fb_row24_col5" class="data row24 col5" >-1.000000</td>
      <td id="T_bb2fb_row24_col6" class="data row24 col6" >-1.000000</td>
      <td id="T_bb2fb_row24_col7" class="data row24 col7" >-1.000000</td>
      <td id="T_bb2fb_row24_col8" class="data row24 col8" >-1.000000</td>
      <td id="T_bb2fb_row24_col9" class="data row24 col9" >-1.000000</td>
      <td id="T_bb2fb_row24_col10" class="data row24 col10" >nan</td>
      <td id="T_bb2fb_row24_col11" class="data row24 col11" >nan</td>
      <td id="T_bb2fb_row24_col12" class="data row24 col12" >-1.000000</td>
      <td id="T_bb2fb_row24_col13" class="data row24 col13" >-1.000000</td>
      <td id="T_bb2fb_row24_col14" class="data row24 col14" >-1.000000</td>
      <td id="T_bb2fb_row24_col15" class="data row24 col15" >-1.000000</td>
      <td id="T_bb2fb_row24_col16" class="data row24 col16" >1.000000</td>
      <td id="T_bb2fb_row24_col17" class="data row24 col17" >-1.000000</td>
      <td id="T_bb2fb_row24_col18" class="data row24 col18" >2</td>
      <td id="T_bb2fb_row24_col19" class="data row24 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row25" class="row_heading level0 row25" >CHCHD4</th>
      <td id="T_bb2fb_row25_col0" class="data row25 col0" >-1.000000</td>
      <td id="T_bb2fb_row25_col1" class="data row25 col1" >-1.000000</td>
      <td id="T_bb2fb_row25_col2" class="data row25 col2" >-1.000000</td>
      <td id="T_bb2fb_row25_col3" class="data row25 col3" >-1.000000</td>
      <td id="T_bb2fb_row25_col4" class="data row25 col4" >-1.000000</td>
      <td id="T_bb2fb_row25_col5" class="data row25 col5" >-1.000000</td>
      <td id="T_bb2fb_row25_col6" class="data row25 col6" >-1.000000</td>
      <td id="T_bb2fb_row25_col7" class="data row25 col7" >-1.000000</td>
      <td id="T_bb2fb_row25_col8" class="data row25 col8" >-1.000000</td>
      <td id="T_bb2fb_row25_col9" class="data row25 col9" >-1.000000</td>
      <td id="T_bb2fb_row25_col10" class="data row25 col10" >nan</td>
      <td id="T_bb2fb_row25_col11" class="data row25 col11" >nan</td>
      <td id="T_bb2fb_row25_col12" class="data row25 col12" >1.000000</td>
      <td id="T_bb2fb_row25_col13" class="data row25 col13" >-1.000000</td>
      <td id="T_bb2fb_row25_col14" class="data row25 col14" >-1.000000</td>
      <td id="T_bb2fb_row25_col15" class="data row25 col15" >-1.000000</td>
      <td id="T_bb2fb_row25_col16" class="data row25 col16" >-1.000000</td>
      <td id="T_bb2fb_row25_col17" class="data row25 col17" >-1.000000</td>
      <td id="T_bb2fb_row25_col18" class="data row25 col18" >2</td>
      <td id="T_bb2fb_row25_col19" class="data row25 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row26" class="row_heading level0 row26" >DNAJB4</th>
      <td id="T_bb2fb_row26_col0" class="data row26 col0" >-1.000000</td>
      <td id="T_bb2fb_row26_col1" class="data row26 col1" >-1.000000</td>
      <td id="T_bb2fb_row26_col2" class="data row26 col2" >-1.000000</td>
      <td id="T_bb2fb_row26_col3" class="data row26 col3" >-1.000000</td>
      <td id="T_bb2fb_row26_col4" class="data row26 col4" >-1.000000</td>
      <td id="T_bb2fb_row26_col5" class="data row26 col5" >-1.000000</td>
      <td id="T_bb2fb_row26_col6" class="data row26 col6" >-1.000000</td>
      <td id="T_bb2fb_row26_col7" class="data row26 col7" >-1.000000</td>
      <td id="T_bb2fb_row26_col8" class="data row26 col8" >-1.000000</td>
      <td id="T_bb2fb_row26_col9" class="data row26 col9" >-1.000000</td>
      <td id="T_bb2fb_row26_col10" class="data row26 col10" >nan</td>
      <td id="T_bb2fb_row26_col11" class="data row26 col11" >nan</td>
      <td id="T_bb2fb_row26_col12" class="data row26 col12" >-1.000000</td>
      <td id="T_bb2fb_row26_col13" class="data row26 col13" >-1.000000</td>
      <td id="T_bb2fb_row26_col14" class="data row26 col14" >-1.000000</td>
      <td id="T_bb2fb_row26_col15" class="data row26 col15" >-1.000000</td>
      <td id="T_bb2fb_row26_col16" class="data row26 col16" >1.000000</td>
      <td id="T_bb2fb_row26_col17" class="data row26 col17" >-1.000000</td>
      <td id="T_bb2fb_row26_col18" class="data row26 col18" >2</td>
      <td id="T_bb2fb_row26_col19" class="data row26 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row27" class="row_heading level0 row27" >FDXR</th>
      <td id="T_bb2fb_row27_col0" class="data row27 col0" >1.000000</td>
      <td id="T_bb2fb_row27_col1" class="data row27 col1" >-1.000000</td>
      <td id="T_bb2fb_row27_col2" class="data row27 col2" >1.000000</td>
      <td id="T_bb2fb_row27_col3" class="data row27 col3" >1.000000</td>
      <td id="T_bb2fb_row27_col4" class="data row27 col4" >1.000000</td>
      <td id="T_bb2fb_row27_col5" class="data row27 col5" >1.000000</td>
      <td id="T_bb2fb_row27_col6" class="data row27 col6" >1.000000</td>
      <td id="T_bb2fb_row27_col7" class="data row27 col7" >1.000000</td>
      <td id="T_bb2fb_row27_col8" class="data row27 col8" >1.000000</td>
      <td id="T_bb2fb_row27_col9" class="data row27 col9" >-1.000000</td>
      <td id="T_bb2fb_row27_col10" class="data row27 col10" >nan</td>
      <td id="T_bb2fb_row27_col11" class="data row27 col11" >nan</td>
      <td id="T_bb2fb_row27_col12" class="data row27 col12" >1.000000</td>
      <td id="T_bb2fb_row27_col13" class="data row27 col13" >1.000000</td>
      <td id="T_bb2fb_row27_col14" class="data row27 col14" >1.000000</td>
      <td id="T_bb2fb_row27_col15" class="data row27 col15" >1.000000</td>
      <td id="T_bb2fb_row27_col16" class="data row27 col16" >-1.000000</td>
      <td id="T_bb2fb_row27_col17" class="data row27 col17" >-1.000000</td>
      <td id="T_bb2fb_row27_col18" class="data row27 col18" >2</td>
      <td id="T_bb2fb_row27_col19" class="data row27 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row28" class="row_heading level0 row28" >CCDC50</th>
      <td id="T_bb2fb_row28_col0" class="data row28 col0" >1.000000</td>
      <td id="T_bb2fb_row28_col1" class="data row28 col1" >-1.000000</td>
      <td id="T_bb2fb_row28_col2" class="data row28 col2" >-1.000000</td>
      <td id="T_bb2fb_row28_col3" class="data row28 col3" >-1.000000</td>
      <td id="T_bb2fb_row28_col4" class="data row28 col4" >1.000000</td>
      <td id="T_bb2fb_row28_col5" class="data row28 col5" >-1.000000</td>
      <td id="T_bb2fb_row28_col6" class="data row28 col6" >1.000000</td>
      <td id="T_bb2fb_row28_col7" class="data row28 col7" >-1.000000</td>
      <td id="T_bb2fb_row28_col8" class="data row28 col8" >-1.000000</td>
      <td id="T_bb2fb_row28_col9" class="data row28 col9" >-1.000000</td>
      <td id="T_bb2fb_row28_col10" class="data row28 col10" >nan</td>
      <td id="T_bb2fb_row28_col11" class="data row28 col11" >nan</td>
      <td id="T_bb2fb_row28_col12" class="data row28 col12" >-1.000000</td>
      <td id="T_bb2fb_row28_col13" class="data row28 col13" >1.000000</td>
      <td id="T_bb2fb_row28_col14" class="data row28 col14" >1.000000</td>
      <td id="T_bb2fb_row28_col15" class="data row28 col15" >1.000000</td>
      <td id="T_bb2fb_row28_col16" class="data row28 col16" >-1.000000</td>
      <td id="T_bb2fb_row28_col17" class="data row28 col17" >1.000000</td>
      <td id="T_bb2fb_row28_col18" class="data row28 col18" >2</td>
      <td id="T_bb2fb_row28_col19" class="data row28 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row29" class="row_heading level0 row29" >CASP2</th>
      <td id="T_bb2fb_row29_col0" class="data row29 col0" >1.000000</td>
      <td id="T_bb2fb_row29_col1" class="data row29 col1" >1.000000</td>
      <td id="T_bb2fb_row29_col2" class="data row29 col2" >1.000000</td>
      <td id="T_bb2fb_row29_col3" class="data row29 col3" >-1.000000</td>
      <td id="T_bb2fb_row29_col4" class="data row29 col4" >1.000000</td>
      <td id="T_bb2fb_row29_col5" class="data row29 col5" >-1.000000</td>
      <td id="T_bb2fb_row29_col6" class="data row29 col6" >1.000000</td>
      <td id="T_bb2fb_row29_col7" class="data row29 col7" >1.000000</td>
      <td id="T_bb2fb_row29_col8" class="data row29 col8" >-1.000000</td>
      <td id="T_bb2fb_row29_col9" class="data row29 col9" >1.000000</td>
      <td id="T_bb2fb_row29_col10" class="data row29 col10" >nan</td>
      <td id="T_bb2fb_row29_col11" class="data row29 col11" >nan</td>
      <td id="T_bb2fb_row29_col12" class="data row29 col12" >-1.000000</td>
      <td id="T_bb2fb_row29_col13" class="data row29 col13" >-1.000000</td>
      <td id="T_bb2fb_row29_col14" class="data row29 col14" >1.000000</td>
      <td id="T_bb2fb_row29_col15" class="data row29 col15" >1.000000</td>
      <td id="T_bb2fb_row29_col16" class="data row29 col16" >1.000000</td>
      <td id="T_bb2fb_row29_col17" class="data row29 col17" >1.000000</td>
      <td id="T_bb2fb_row29_col18" class="data row29 col18" >2</td>
      <td id="T_bb2fb_row29_col19" class="data row29 col19" >2</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row30" class="row_heading level0 row30" >SLC25A5</th>
      <td id="T_bb2fb_row30_col0" class="data row30 col0" >0.994052</td>
      <td id="T_bb2fb_row30_col1" class="data row30 col1" >0.965552</td>
      <td id="T_bb2fb_row30_col2" class="data row30 col2" >0.346024</td>
      <td id="T_bb2fb_row30_col3" class="data row30 col3" >0.967949</td>
      <td id="T_bb2fb_row30_col4" class="data row30 col4" >0.989720</td>
      <td id="T_bb2fb_row30_col5" class="data row30 col5" >0.995082</td>
      <td id="T_bb2fb_row30_col6" class="data row30 col6" >0.224300</td>
      <td id="T_bb2fb_row30_col7" class="data row30 col7" >0.370644</td>
      <td id="T_bb2fb_row30_col8" class="data row30 col8" >0.992321</td>
      <td id="T_bb2fb_row30_col9" class="data row30 col9" >-0.939530</td>
      <td id="T_bb2fb_row30_col10" class="data row30 col10" >nan</td>
      <td id="T_bb2fb_row30_col11" class="data row30 col11" >nan</td>
      <td id="T_bb2fb_row30_col12" class="data row30 col12" >0.978388</td>
      <td id="T_bb2fb_row30_col13" class="data row30 col13" >0.252388</td>
      <td id="T_bb2fb_row30_col14" class="data row30 col14" >0.992239</td>
      <td id="T_bb2fb_row30_col15" class="data row30 col15" >-0.273709</td>
      <td id="T_bb2fb_row30_col16" class="data row30 col16" >0.998815</td>
      <td id="T_bb2fb_row30_col17" class="data row30 col17" >0.966856</td>
      <td id="T_bb2fb_row30_col18" class="data row30 col18" >3</td>
      <td id="T_bb2fb_row30_col19" class="data row30 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row31" class="row_heading level0 row31" >TMEM65</th>
      <td id="T_bb2fb_row31_col0" class="data row31 col0" >0.393524</td>
      <td id="T_bb2fb_row31_col1" class="data row31 col1" >0.496203</td>
      <td id="T_bb2fb_row31_col2" class="data row31 col2" >0.245073</td>
      <td id="T_bb2fb_row31_col3" class="data row31 col3" >0.609265</td>
      <td id="T_bb2fb_row31_col4" class="data row31 col4" >0.102515</td>
      <td id="T_bb2fb_row31_col5" class="data row31 col5" >0.371320</td>
      <td id="T_bb2fb_row31_col6" class="data row31 col6" >-0.292025</td>
      <td id="T_bb2fb_row31_col7" class="data row31 col7" >0.017794</td>
      <td id="T_bb2fb_row31_col8" class="data row31 col8" >-0.875113</td>
      <td id="T_bb2fb_row31_col9" class="data row31 col9" >0.250228</td>
      <td id="T_bb2fb_row31_col10" class="data row31 col10" >nan</td>
      <td id="T_bb2fb_row31_col11" class="data row31 col11" >nan</td>
      <td id="T_bb2fb_row31_col12" class="data row31 col12" >0.339350</td>
      <td id="T_bb2fb_row31_col13" class="data row31 col13" >-0.603503</td>
      <td id="T_bb2fb_row31_col14" class="data row31 col14" >0.133795</td>
      <td id="T_bb2fb_row31_col15" class="data row31 col15" >-0.897770</td>
      <td id="T_bb2fb_row31_col16" class="data row31 col16" >0.640413</td>
      <td id="T_bb2fb_row31_col17" class="data row31 col17" >0.415324</td>
      <td id="T_bb2fb_row31_col18" class="data row31 col18" >3</td>
      <td id="T_bb2fb_row31_col19" class="data row31 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row32" class="row_heading level0 row32" >SYNCRIP</th>
      <td id="T_bb2fb_row32_col0" class="data row32 col0" >-0.582286</td>
      <td id="T_bb2fb_row32_col1" class="data row32 col1" >-0.627672</td>
      <td id="T_bb2fb_row32_col2" class="data row32 col2" >-0.425775</td>
      <td id="T_bb2fb_row32_col3" class="data row32 col3" >-0.097334</td>
      <td id="T_bb2fb_row32_col4" class="data row32 col4" >-0.204294</td>
      <td id="T_bb2fb_row32_col5" class="data row32 col5" >-0.565874</td>
      <td id="T_bb2fb_row32_col6" class="data row32 col6" >0.966399</td>
      <td id="T_bb2fb_row32_col7" class="data row32 col7" >0.383229</td>
      <td id="T_bb2fb_row32_col8" class="data row32 col8" >0.912355</td>
      <td id="T_bb2fb_row32_col9" class="data row32 col9" >-0.777393</td>
      <td id="T_bb2fb_row32_col10" class="data row32 col10" >nan</td>
      <td id="T_bb2fb_row32_col11" class="data row32 col11" >nan</td>
      <td id="T_bb2fb_row32_col12" class="data row32 col12" >-0.864595</td>
      <td id="T_bb2fb_row32_col13" class="data row32 col13" >0.584623</td>
      <td id="T_bb2fb_row32_col14" class="data row32 col14" >-0.488617</td>
      <td id="T_bb2fb_row32_col15" class="data row32 col15" >-0.038016</td>
      <td id="T_bb2fb_row32_col16" class="data row32 col16" >-0.867197</td>
      <td id="T_bb2fb_row32_col17" class="data row32 col17" >-0.082684</td>
      <td id="T_bb2fb_row32_col18" class="data row32 col18" >3</td>
      <td id="T_bb2fb_row32_col19" class="data row32 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row33" class="row_heading level0 row33" >CRTAP</th>
      <td id="T_bb2fb_row33_col0" class="data row33 col0" >0.895713</td>
      <td id="T_bb2fb_row33_col1" class="data row33 col1" >0.808823</td>
      <td id="T_bb2fb_row33_col2" class="data row33 col2" >0.417069</td>
      <td id="T_bb2fb_row33_col3" class="data row33 col3" >0.993689</td>
      <td id="T_bb2fb_row33_col4" class="data row33 col4" >0.949628</td>
      <td id="T_bb2fb_row33_col5" class="data row33 col5" >0.900291</td>
      <td id="T_bb2fb_row33_col6" class="data row33 col6" >0.999980</td>
      <td id="T_bb2fb_row33_col7" class="data row33 col7" >0.547322</td>
      <td id="T_bb2fb_row33_col8" class="data row33 col8" >0.945123</td>
      <td id="T_bb2fb_row33_col9" class="data row33 col9" >0.750528</td>
      <td id="T_bb2fb_row33_col10" class="data row33 col10" >nan</td>
      <td id="T_bb2fb_row33_col11" class="data row33 col11" >nan</td>
      <td id="T_bb2fb_row33_col12" class="data row33 col12" >0.999975</td>
      <td id="T_bb2fb_row33_col13" class="data row33 col13" >-0.005764</td>
      <td id="T_bb2fb_row33_col14" class="data row33 col14" >0.366308</td>
      <td id="T_bb2fb_row33_col15" class="data row33 col15" >0.437315</td>
      <td id="T_bb2fb_row33_col16" class="data row33 col16" >0.126380</td>
      <td id="T_bb2fb_row33_col17" class="data row33 col17" >0.911047</td>
      <td id="T_bb2fb_row33_col18" class="data row33 col18" >3</td>
      <td id="T_bb2fb_row33_col19" class="data row33 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row34" class="row_heading level0 row34" >ARAF</th>
      <td id="T_bb2fb_row34_col0" class="data row34 col0" >0.622137</td>
      <td id="T_bb2fb_row34_col1" class="data row34 col1" >0.793350</td>
      <td id="T_bb2fb_row34_col2" class="data row34 col2" >0.726494</td>
      <td id="T_bb2fb_row34_col3" class="data row34 col3" >-0.546916</td>
      <td id="T_bb2fb_row34_col4" class="data row34 col4" >0.671221</td>
      <td id="T_bb2fb_row34_col5" class="data row34 col5" >0.805533</td>
      <td id="T_bb2fb_row34_col6" class="data row34 col6" >0.604399</td>
      <td id="T_bb2fb_row34_col7" class="data row34 col7" >0.939237</td>
      <td id="T_bb2fb_row34_col8" class="data row34 col8" >0.968784</td>
      <td id="T_bb2fb_row34_col9" class="data row34 col9" >0.508207</td>
      <td id="T_bb2fb_row34_col10" class="data row34 col10" >nan</td>
      <td id="T_bb2fb_row34_col11" class="data row34 col11" >nan</td>
      <td id="T_bb2fb_row34_col12" class="data row34 col12" >0.986170</td>
      <td id="T_bb2fb_row34_col13" class="data row34 col13" >0.891905</td>
      <td id="T_bb2fb_row34_col14" class="data row34 col14" >0.955406</td>
      <td id="T_bb2fb_row34_col15" class="data row34 col15" >0.999576</td>
      <td id="T_bb2fb_row34_col16" class="data row34 col16" >0.457456</td>
      <td id="T_bb2fb_row34_col17" class="data row34 col17" >0.472954</td>
      <td id="T_bb2fb_row34_col18" class="data row34 col18" >3</td>
      <td id="T_bb2fb_row34_col19" class="data row34 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row35" class="row_heading level0 row35" >TRMT5</th>
      <td id="T_bb2fb_row35_col0" class="data row35 col0" >-0.482080</td>
      <td id="T_bb2fb_row35_col1" class="data row35 col1" >-0.468456</td>
      <td id="T_bb2fb_row35_col2" class="data row35 col2" >-0.497170</td>
      <td id="T_bb2fb_row35_col3" class="data row35 col3" >-0.382323</td>
      <td id="T_bb2fb_row35_col4" class="data row35 col4" >-0.898176</td>
      <td id="T_bb2fb_row35_col5" class="data row35 col5" >-0.659654</td>
      <td id="T_bb2fb_row35_col6" class="data row35 col6" >-0.410847</td>
      <td id="T_bb2fb_row35_col7" class="data row35 col7" >-0.978811</td>
      <td id="T_bb2fb_row35_col8" class="data row35 col8" >-0.217629</td>
      <td id="T_bb2fb_row35_col9" class="data row35 col9" >-0.939168</td>
      <td id="T_bb2fb_row35_col10" class="data row35 col10" >nan</td>
      <td id="T_bb2fb_row35_col11" class="data row35 col11" >nan</td>
      <td id="T_bb2fb_row35_col12" class="data row35 col12" >-0.797585</td>
      <td id="T_bb2fb_row35_col13" class="data row35 col13" >-0.217182</td>
      <td id="T_bb2fb_row35_col14" class="data row35 col14" >-0.543990</td>
      <td id="T_bb2fb_row35_col15" class="data row35 col15" >-0.195657</td>
      <td id="T_bb2fb_row35_col16" class="data row35 col16" >0.710436</td>
      <td id="T_bb2fb_row35_col17" class="data row35 col17" >-0.753680</td>
      <td id="T_bb2fb_row35_col18" class="data row35 col18" >3</td>
      <td id="T_bb2fb_row35_col19" class="data row35 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row36" class="row_heading level0 row36" >AQR</th>
      <td id="T_bb2fb_row36_col0" class="data row36 col0" >0.952674</td>
      <td id="T_bb2fb_row36_col1" class="data row36 col1" >0.944784</td>
      <td id="T_bb2fb_row36_col2" class="data row36 col2" >0.934363</td>
      <td id="T_bb2fb_row36_col3" class="data row36 col3" >0.428657</td>
      <td id="T_bb2fb_row36_col4" class="data row36 col4" >0.926908</td>
      <td id="T_bb2fb_row36_col5" class="data row36 col5" >0.940562</td>
      <td id="T_bb2fb_row36_col6" class="data row36 col6" >0.828897</td>
      <td id="T_bb2fb_row36_col7" class="data row36 col7" >0.837181</td>
      <td id="T_bb2fb_row36_col8" class="data row36 col8" >0.735722</td>
      <td id="T_bb2fb_row36_col9" class="data row36 col9" >0.307051</td>
      <td id="T_bb2fb_row36_col10" class="data row36 col10" >nan</td>
      <td id="T_bb2fb_row36_col11" class="data row36 col11" >nan</td>
      <td id="T_bb2fb_row36_col12" class="data row36 col12" >0.620571</td>
      <td id="T_bb2fb_row36_col13" class="data row36 col13" >0.997364</td>
      <td id="T_bb2fb_row36_col14" class="data row36 col14" >0.816051</td>
      <td id="T_bb2fb_row36_col15" class="data row36 col15" >0.830920</td>
      <td id="T_bb2fb_row36_col16" class="data row36 col16" >0.880723</td>
      <td id="T_bb2fb_row36_col17" class="data row36 col17" >0.828332</td>
      <td id="T_bb2fb_row36_col18" class="data row36 col18" >3</td>
      <td id="T_bb2fb_row36_col19" class="data row36 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row37" class="row_heading level0 row37" >ASB6</th>
      <td id="T_bb2fb_row37_col0" class="data row37 col0" >-0.773689</td>
      <td id="T_bb2fb_row37_col1" class="data row37 col1" >-0.972303</td>
      <td id="T_bb2fb_row37_col2" class="data row37 col2" >-0.996157</td>
      <td id="T_bb2fb_row37_col3" class="data row37 col3" >-0.958558</td>
      <td id="T_bb2fb_row37_col4" class="data row37 col4" >-0.952671</td>
      <td id="T_bb2fb_row37_col5" class="data row37 col5" >-0.394998</td>
      <td id="T_bb2fb_row37_col6" class="data row37 col6" >-0.855589</td>
      <td id="T_bb2fb_row37_col7" class="data row37 col7" >-0.989601</td>
      <td id="T_bb2fb_row37_col8" class="data row37 col8" >-0.761966</td>
      <td id="T_bb2fb_row37_col9" class="data row37 col9" >-0.720228</td>
      <td id="T_bb2fb_row37_col10" class="data row37 col10" >nan</td>
      <td id="T_bb2fb_row37_col11" class="data row37 col11" >nan</td>
      <td id="T_bb2fb_row37_col12" class="data row37 col12" >-0.010154</td>
      <td id="T_bb2fb_row37_col13" class="data row37 col13" >-0.148591</td>
      <td id="T_bb2fb_row37_col14" class="data row37 col14" >-0.351896</td>
      <td id="T_bb2fb_row37_col15" class="data row37 col15" >-0.224133</td>
      <td id="T_bb2fb_row37_col16" class="data row37 col16" >-0.377033</td>
      <td id="T_bb2fb_row37_col17" class="data row37 col17" >-0.729966</td>
      <td id="T_bb2fb_row37_col18" class="data row37 col18" >3</td>
      <td id="T_bb2fb_row37_col19" class="data row37 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row38" class="row_heading level0 row38" >RPLP1</th>
      <td id="T_bb2fb_row38_col0" class="data row38 col0" >0.365195</td>
      <td id="T_bb2fb_row38_col1" class="data row38 col1" >0.290359</td>
      <td id="T_bb2fb_row38_col2" class="data row38 col2" >0.456661</td>
      <td id="T_bb2fb_row38_col3" class="data row38 col3" >0.535595</td>
      <td id="T_bb2fb_row38_col4" class="data row38 col4" >0.385231</td>
      <td id="T_bb2fb_row38_col5" class="data row38 col5" >0.305174</td>
      <td id="T_bb2fb_row38_col6" class="data row38 col6" >0.193344</td>
      <td id="T_bb2fb_row38_col7" class="data row38 col7" >0.192943</td>
      <td id="T_bb2fb_row38_col8" class="data row38 col8" >0.140800</td>
      <td id="T_bb2fb_row38_col9" class="data row38 col9" >0.941731</td>
      <td id="T_bb2fb_row38_col10" class="data row38 col10" >nan</td>
      <td id="T_bb2fb_row38_col11" class="data row38 col11" >nan</td>
      <td id="T_bb2fb_row38_col12" class="data row38 col12" >0.436672</td>
      <td id="T_bb2fb_row38_col13" class="data row38 col13" >-0.344952</td>
      <td id="T_bb2fb_row38_col14" class="data row38 col14" >0.425380</td>
      <td id="T_bb2fb_row38_col15" class="data row38 col15" >0.018270</td>
      <td id="T_bb2fb_row38_col16" class="data row38 col16" >0.454178</td>
      <td id="T_bb2fb_row38_col17" class="data row38 col17" >0.148723</td>
      <td id="T_bb2fb_row38_col18" class="data row38 col18" >3</td>
      <td id="T_bb2fb_row38_col19" class="data row38 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row39" class="row_heading level0 row39" >PTRH2</th>
      <td id="T_bb2fb_row39_col0" class="data row39 col0" >0.324163</td>
      <td id="T_bb2fb_row39_col1" class="data row39 col1" >0.588964</td>
      <td id="T_bb2fb_row39_col2" class="data row39 col2" >0.656452</td>
      <td id="T_bb2fb_row39_col3" class="data row39 col3" >0.819521</td>
      <td id="T_bb2fb_row39_col4" class="data row39 col4" >-0.180604</td>
      <td id="T_bb2fb_row39_col5" class="data row39 col5" >0.047116</td>
      <td id="T_bb2fb_row39_col6" class="data row39 col6" >-0.216909</td>
      <td id="T_bb2fb_row39_col7" class="data row39 col7" >-0.217641</td>
      <td id="T_bb2fb_row39_col8" class="data row39 col8" >-0.283708</td>
      <td id="T_bb2fb_row39_col9" class="data row39 col9" >-0.060867</td>
      <td id="T_bb2fb_row39_col10" class="data row39 col10" >nan</td>
      <td id="T_bb2fb_row39_col11" class="data row39 col11" >nan</td>
      <td id="T_bb2fb_row39_col12" class="data row39 col12" >0.490242</td>
      <td id="T_bb2fb_row39_col13" class="data row39 col13" >-0.293778</td>
      <td id="T_bb2fb_row39_col14" class="data row39 col14" >-0.241205</td>
      <td id="T_bb2fb_row39_col15" class="data row39 col15" >-0.082352</td>
      <td id="T_bb2fb_row39_col16" class="data row39 col16" >0.375168</td>
      <td id="T_bb2fb_row39_col17" class="data row39 col17" >-0.839647</td>
      <td id="T_bb2fb_row39_col18" class="data row39 col18" >3</td>
      <td id="T_bb2fb_row39_col19" class="data row39 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row40" class="row_heading level0 row40" >HSPH1</th>
      <td id="T_bb2fb_row40_col0" class="data row40 col0" >0.976083</td>
      <td id="T_bb2fb_row40_col1" class="data row40 col1" >0.999827</td>
      <td id="T_bb2fb_row40_col2" class="data row40 col2" >0.950835</td>
      <td id="T_bb2fb_row40_col3" class="data row40 col3" >0.985628</td>
      <td id="T_bb2fb_row40_col4" class="data row40 col4" >0.502827</td>
      <td id="T_bb2fb_row40_col5" class="data row40 col5" >0.535423</td>
      <td id="T_bb2fb_row40_col6" class="data row40 col6" >0.995927</td>
      <td id="T_bb2fb_row40_col7" class="data row40 col7" >0.917857</td>
      <td id="T_bb2fb_row40_col8" class="data row40 col8" >0.711874</td>
      <td id="T_bb2fb_row40_col9" class="data row40 col9" >0.937056</td>
      <td id="T_bb2fb_row40_col10" class="data row40 col10" >nan</td>
      <td id="T_bb2fb_row40_col11" class="data row40 col11" >nan</td>
      <td id="T_bb2fb_row40_col12" class="data row40 col12" >0.573686</td>
      <td id="T_bb2fb_row40_col13" class="data row40 col13" >0.999170</td>
      <td id="T_bb2fb_row40_col14" class="data row40 col14" >0.356447</td>
      <td id="T_bb2fb_row40_col15" class="data row40 col15" >0.763662</td>
      <td id="T_bb2fb_row40_col16" class="data row40 col16" >0.586966</td>
      <td id="T_bb2fb_row40_col17" class="data row40 col17" >-0.887349</td>
      <td id="T_bb2fb_row40_col18" class="data row40 col18" >3</td>
      <td id="T_bb2fb_row40_col19" class="data row40 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row41" class="row_heading level0 row41" >DENR</th>
      <td id="T_bb2fb_row41_col0" class="data row41 col0" >-0.466443</td>
      <td id="T_bb2fb_row41_col1" class="data row41 col1" >-0.100599</td>
      <td id="T_bb2fb_row41_col2" class="data row41 col2" >0.955343</td>
      <td id="T_bb2fb_row41_col3" class="data row41 col3" >0.995954</td>
      <td id="T_bb2fb_row41_col4" class="data row41 col4" >0.689903</td>
      <td id="T_bb2fb_row41_col5" class="data row41 col5" >0.707107</td>
      <td id="T_bb2fb_row41_col6" class="data row41 col6" >0.414360</td>
      <td id="T_bb2fb_row41_col7" class="data row41 col7" >-0.531637</td>
      <td id="T_bb2fb_row41_col8" class="data row41 col8" >-0.064234</td>
      <td id="T_bb2fb_row41_col9" class="data row41 col9" >-0.193002</td>
      <td id="T_bb2fb_row41_col10" class="data row41 col10" >nan</td>
      <td id="T_bb2fb_row41_col11" class="data row41 col11" >nan</td>
      <td id="T_bb2fb_row41_col12" class="data row41 col12" >-0.034275</td>
      <td id="T_bb2fb_row41_col13" class="data row41 col13" >0.968847</td>
      <td id="T_bb2fb_row41_col14" class="data row41 col14" >0.685922</td>
      <td id="T_bb2fb_row41_col15" class="data row41 col15" >-0.187914</td>
      <td id="T_bb2fb_row41_col16" class="data row41 col16" >-0.614547</td>
      <td id="T_bb2fb_row41_col17" class="data row41 col17" >-0.998362</td>
      <td id="T_bb2fb_row41_col18" class="data row41 col18" >3</td>
      <td id="T_bb2fb_row41_col19" class="data row41 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row42" class="row_heading level0 row42" >PITHD1</th>
      <td id="T_bb2fb_row42_col0" class="data row42 col0" >0.643642</td>
      <td id="T_bb2fb_row42_col1" class="data row42 col1" >-0.812058</td>
      <td id="T_bb2fb_row42_col2" class="data row42 col2" >0.877317</td>
      <td id="T_bb2fb_row42_col3" class="data row42 col3" >0.630444</td>
      <td id="T_bb2fb_row42_col4" class="data row42 col4" >0.823757</td>
      <td id="T_bb2fb_row42_col5" class="data row42 col5" >0.125686</td>
      <td id="T_bb2fb_row42_col6" class="data row42 col6" >-0.934111</td>
      <td id="T_bb2fb_row42_col7" class="data row42 col7" >-0.823405</td>
      <td id="T_bb2fb_row42_col8" class="data row42 col8" >0.763794</td>
      <td id="T_bb2fb_row42_col9" class="data row42 col9" >0.637975</td>
      <td id="T_bb2fb_row42_col10" class="data row42 col10" >nan</td>
      <td id="T_bb2fb_row42_col11" class="data row42 col11" >nan</td>
      <td id="T_bb2fb_row42_col12" class="data row42 col12" >0.973651</td>
      <td id="T_bb2fb_row42_col13" class="data row42 col13" >0.732246</td>
      <td id="T_bb2fb_row42_col14" class="data row42 col14" >0.999910</td>
      <td id="T_bb2fb_row42_col15" class="data row42 col15" >0.472220</td>
      <td id="T_bb2fb_row42_col16" class="data row42 col16" >-0.991171</td>
      <td id="T_bb2fb_row42_col17" class="data row42 col17" >0.744749</td>
      <td id="T_bb2fb_row42_col18" class="data row42 col18" >3</td>
      <td id="T_bb2fb_row42_col19" class="data row42 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row43" class="row_heading level0 row43" >CUL4A</th>
      <td id="T_bb2fb_row43_col0" class="data row43 col0" >0.894764</td>
      <td id="T_bb2fb_row43_col1" class="data row43 col1" >0.146663</td>
      <td id="T_bb2fb_row43_col2" class="data row43 col2" >-0.417002</td>
      <td id="T_bb2fb_row43_col3" class="data row43 col3" >0.038046</td>
      <td id="T_bb2fb_row43_col4" class="data row43 col4" >0.703885</td>
      <td id="T_bb2fb_row43_col5" class="data row43 col5" >0.869630</td>
      <td id="T_bb2fb_row43_col6" class="data row43 col6" >0.650261</td>
      <td id="T_bb2fb_row43_col7" class="data row43 col7" >0.458128</td>
      <td id="T_bb2fb_row43_col8" class="data row43 col8" >0.970907</td>
      <td id="T_bb2fb_row43_col9" class="data row43 col9" >0.847791</td>
      <td id="T_bb2fb_row43_col10" class="data row43 col10" >nan</td>
      <td id="T_bb2fb_row43_col11" class="data row43 col11" >nan</td>
      <td id="T_bb2fb_row43_col12" class="data row43 col12" >0.646914</td>
      <td id="T_bb2fb_row43_col13" class="data row43 col13" >0.817580</td>
      <td id="T_bb2fb_row43_col14" class="data row43 col14" >0.210638</td>
      <td id="T_bb2fb_row43_col15" class="data row43 col15" >0.035858</td>
      <td id="T_bb2fb_row43_col16" class="data row43 col16" >-0.867187</td>
      <td id="T_bb2fb_row43_col17" class="data row43 col17" >0.100295</td>
      <td id="T_bb2fb_row43_col18" class="data row43 col18" >3</td>
      <td id="T_bb2fb_row43_col19" class="data row43 col19" >3</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row44" class="row_heading level0 row44" >RRP1B</th>
      <td id="T_bb2fb_row44_col0" class="data row44 col0" >0.217347</td>
      <td id="T_bb2fb_row44_col1" class="data row44 col1" >-0.036692</td>
      <td id="T_bb2fb_row44_col2" class="data row44 col2" >0.381912</td>
      <td id="T_bb2fb_row44_col3" class="data row44 col3" >0.120473</td>
      <td id="T_bb2fb_row44_col4" class="data row44 col4" >0.114247</td>
      <td id="T_bb2fb_row44_col5" class="data row44 col5" >0.377799</td>
      <td id="T_bb2fb_row44_col6" class="data row44 col6" >-0.109575</td>
      <td id="T_bb2fb_row44_col7" class="data row44 col7" >-0.517243</td>
      <td id="T_bb2fb_row44_col8" class="data row44 col8" >0.332883</td>
      <td id="T_bb2fb_row44_col9" class="data row44 col9" >0.336654</td>
      <td id="T_bb2fb_row44_col10" class="data row44 col10" >nan</td>
      <td id="T_bb2fb_row44_col11" class="data row44 col11" >nan</td>
      <td id="T_bb2fb_row44_col12" class="data row44 col12" >0.535186</td>
      <td id="T_bb2fb_row44_col13" class="data row44 col13" >0.339185</td>
      <td id="T_bb2fb_row44_col14" class="data row44 col14" >0.642441</td>
      <td id="T_bb2fb_row44_col15" class="data row44 col15" >-0.773109</td>
      <td id="T_bb2fb_row44_col16" class="data row44 col16" >0.579098</td>
      <td id="T_bb2fb_row44_col17" class="data row44 col17" >0.256311</td>
      <td id="T_bb2fb_row44_col18" class="data row44 col18" >4</td>
      <td id="T_bb2fb_row44_col19" class="data row44 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row45" class="row_heading level0 row45" >DYNLL2</th>
      <td id="T_bb2fb_row45_col0" class="data row45 col0" >0.572126</td>
      <td id="T_bb2fb_row45_col1" class="data row45 col1" >0.894802</td>
      <td id="T_bb2fb_row45_col2" class="data row45 col2" >0.249184</td>
      <td id="T_bb2fb_row45_col3" class="data row45 col3" >0.359622</td>
      <td id="T_bb2fb_row45_col4" class="data row45 col4" >0.532478</td>
      <td id="T_bb2fb_row45_col5" class="data row45 col5" >0.684387</td>
      <td id="T_bb2fb_row45_col6" class="data row45 col6" >0.587453</td>
      <td id="T_bb2fb_row45_col7" class="data row45 col7" >0.643839</td>
      <td id="T_bb2fb_row45_col8" class="data row45 col8" >0.059697</td>
      <td id="T_bb2fb_row45_col9" class="data row45 col9" >0.491175</td>
      <td id="T_bb2fb_row45_col10" class="data row45 col10" >nan</td>
      <td id="T_bb2fb_row45_col11" class="data row45 col11" >nan</td>
      <td id="T_bb2fb_row45_col12" class="data row45 col12" >-0.323270</td>
      <td id="T_bb2fb_row45_col13" class="data row45 col13" >-0.304920</td>
      <td id="T_bb2fb_row45_col14" class="data row45 col14" >0.548115</td>
      <td id="T_bb2fb_row45_col15" class="data row45 col15" >0.921882</td>
      <td id="T_bb2fb_row45_col16" class="data row45 col16" >0.797989</td>
      <td id="T_bb2fb_row45_col17" class="data row45 col17" >0.000060</td>
      <td id="T_bb2fb_row45_col18" class="data row45 col18" >4</td>
      <td id="T_bb2fb_row45_col19" class="data row45 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row46" class="row_heading level0 row46" >PPP1R13L</th>
      <td id="T_bb2fb_row46_col0" class="data row46 col0" >0.662013</td>
      <td id="T_bb2fb_row46_col1" class="data row46 col1" >0.703147</td>
      <td id="T_bb2fb_row46_col2" class="data row46 col2" >-0.240774</td>
      <td id="T_bb2fb_row46_col3" class="data row46 col3" >-0.352527</td>
      <td id="T_bb2fb_row46_col4" class="data row46 col4" >0.641443</td>
      <td id="T_bb2fb_row46_col5" class="data row46 col5" >-0.214791</td>
      <td id="T_bb2fb_row46_col6" class="data row46 col6" >0.476551</td>
      <td id="T_bb2fb_row46_col7" class="data row46 col7" >0.737168</td>
      <td id="T_bb2fb_row46_col8" class="data row46 col8" >-0.593214</td>
      <td id="T_bb2fb_row46_col9" class="data row46 col9" >0.537129</td>
      <td id="T_bb2fb_row46_col10" class="data row46 col10" >nan</td>
      <td id="T_bb2fb_row46_col11" class="data row46 col11" >nan</td>
      <td id="T_bb2fb_row46_col12" class="data row46 col12" >0.634546</td>
      <td id="T_bb2fb_row46_col13" class="data row46 col13" >-0.441498</td>
      <td id="T_bb2fb_row46_col14" class="data row46 col14" >-0.686966</td>
      <td id="T_bb2fb_row46_col15" class="data row46 col15" >0.716442</td>
      <td id="T_bb2fb_row46_col16" class="data row46 col16" >0.588829</td>
      <td id="T_bb2fb_row46_col17" class="data row46 col17" >-0.677617</td>
      <td id="T_bb2fb_row46_col18" class="data row46 col18" >4</td>
      <td id="T_bb2fb_row46_col19" class="data row46 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row47" class="row_heading level0 row47" >ERAP1</th>
      <td id="T_bb2fb_row47_col0" class="data row47 col0" >-0.743053</td>
      <td id="T_bb2fb_row47_col1" class="data row47 col1" >-0.326642</td>
      <td id="T_bb2fb_row47_col2" class="data row47 col2" >-0.895814</td>
      <td id="T_bb2fb_row47_col3" class="data row47 col3" >-0.292870</td>
      <td id="T_bb2fb_row47_col4" class="data row47 col4" >-0.690411</td>
      <td id="T_bb2fb_row47_col5" class="data row47 col5" >-0.798090</td>
      <td id="T_bb2fb_row47_col6" class="data row47 col6" >-0.505261</td>
      <td id="T_bb2fb_row47_col7" class="data row47 col7" >-0.390735</td>
      <td id="T_bb2fb_row47_col8" class="data row47 col8" >-0.991269</td>
      <td id="T_bb2fb_row47_col9" class="data row47 col9" >-0.767112</td>
      <td id="T_bb2fb_row47_col10" class="data row47 col10" >nan</td>
      <td id="T_bb2fb_row47_col11" class="data row47 col11" >nan</td>
      <td id="T_bb2fb_row47_col12" class="data row47 col12" >-0.833228</td>
      <td id="T_bb2fb_row47_col13" class="data row47 col13" >-0.918371</td>
      <td id="T_bb2fb_row47_col14" class="data row47 col14" >-0.958131</td>
      <td id="T_bb2fb_row47_col15" class="data row47 col15" >-0.999088</td>
      <td id="T_bb2fb_row47_col16" class="data row47 col16" >0.115032</td>
      <td id="T_bb2fb_row47_col17" class="data row47 col17" >-0.568022</td>
      <td id="T_bb2fb_row47_col18" class="data row47 col18" >4</td>
      <td id="T_bb2fb_row47_col19" class="data row47 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row48" class="row_heading level0 row48" >P4HA1</th>
      <td id="T_bb2fb_row48_col0" class="data row48 col0" >0.727774</td>
      <td id="T_bb2fb_row48_col1" class="data row48 col1" >0.555055</td>
      <td id="T_bb2fb_row48_col2" class="data row48 col2" >0.825964</td>
      <td id="T_bb2fb_row48_col3" class="data row48 col3" >0.897842</td>
      <td id="T_bb2fb_row48_col4" class="data row48 col4" >0.808511</td>
      <td id="T_bb2fb_row48_col5" class="data row48 col5" >0.860966</td>
      <td id="T_bb2fb_row48_col6" class="data row48 col6" >0.853237</td>
      <td id="T_bb2fb_row48_col7" class="data row48 col7" >0.480295</td>
      <td id="T_bb2fb_row48_col8" class="data row48 col8" >0.849070</td>
      <td id="T_bb2fb_row48_col9" class="data row48 col9" >0.744796</td>
      <td id="T_bb2fb_row48_col10" class="data row48 col10" >nan</td>
      <td id="T_bb2fb_row48_col11" class="data row48 col11" >nan</td>
      <td id="T_bb2fb_row48_col12" class="data row48 col12" >0.595644</td>
      <td id="T_bb2fb_row48_col13" class="data row48 col13" >-0.106732</td>
      <td id="T_bb2fb_row48_col14" class="data row48 col14" >0.990567</td>
      <td id="T_bb2fb_row48_col15" class="data row48 col15" >0.872227</td>
      <td id="T_bb2fb_row48_col16" class="data row48 col16" >0.988537</td>
      <td id="T_bb2fb_row48_col17" class="data row48 col17" >-0.323703</td>
      <td id="T_bb2fb_row48_col18" class="data row48 col18" >4</td>
      <td id="T_bb2fb_row48_col19" class="data row48 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row49" class="row_heading level0 row49" >MRPS26</th>
      <td id="T_bb2fb_row49_col0" class="data row49 col0" >0.732317</td>
      <td id="T_bb2fb_row49_col1" class="data row49 col1" >0.828377</td>
      <td id="T_bb2fb_row49_col2" class="data row49 col2" >0.926403</td>
      <td id="T_bb2fb_row49_col3" class="data row49 col3" >0.371997</td>
      <td id="T_bb2fb_row49_col4" class="data row49 col4" >0.771589</td>
      <td id="T_bb2fb_row49_col5" class="data row49 col5" >0.768853</td>
      <td id="T_bb2fb_row49_col6" class="data row49 col6" >0.534741</td>
      <td id="T_bb2fb_row49_col7" class="data row49 col7" >0.571562</td>
      <td id="T_bb2fb_row49_col8" class="data row49 col8" >0.657936</td>
      <td id="T_bb2fb_row49_col9" class="data row49 col9" >0.481949</td>
      <td id="T_bb2fb_row49_col10" class="data row49 col10" >nan</td>
      <td id="T_bb2fb_row49_col11" class="data row49 col11" >nan</td>
      <td id="T_bb2fb_row49_col12" class="data row49 col12" >0.647548</td>
      <td id="T_bb2fb_row49_col13" class="data row49 col13" >0.928550</td>
      <td id="T_bb2fb_row49_col14" class="data row49 col14" >0.747258</td>
      <td id="T_bb2fb_row49_col15" class="data row49 col15" >0.176399</td>
      <td id="T_bb2fb_row49_col16" class="data row49 col16" >-0.781175</td>
      <td id="T_bb2fb_row49_col17" class="data row49 col17" >-0.753443</td>
      <td id="T_bb2fb_row49_col18" class="data row49 col18" >4</td>
      <td id="T_bb2fb_row49_col19" class="data row49 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row50" class="row_heading level0 row50" >LIMCH1</th>
      <td id="T_bb2fb_row50_col0" class="data row50 col0" >0.750080</td>
      <td id="T_bb2fb_row50_col1" class="data row50 col1" >0.555946</td>
      <td id="T_bb2fb_row50_col2" class="data row50 col2" >0.413017</td>
      <td id="T_bb2fb_row50_col3" class="data row50 col3" >-0.593756</td>
      <td id="T_bb2fb_row50_col4" class="data row50 col4" >0.972344</td>
      <td id="T_bb2fb_row50_col5" class="data row50 col5" >0.899648</td>
      <td id="T_bb2fb_row50_col6" class="data row50 col6" >-0.533938</td>
      <td id="T_bb2fb_row50_col7" class="data row50 col7" >0.673636</td>
      <td id="T_bb2fb_row50_col8" class="data row50 col8" >0.949258</td>
      <td id="T_bb2fb_row50_col9" class="data row50 col9" >-0.128246</td>
      <td id="T_bb2fb_row50_col10" class="data row50 col10" >nan</td>
      <td id="T_bb2fb_row50_col11" class="data row50 col11" >nan</td>
      <td id="T_bb2fb_row50_col12" class="data row50 col12" >0.453558</td>
      <td id="T_bb2fb_row50_col13" class="data row50 col13" >0.366565</td>
      <td id="T_bb2fb_row50_col14" class="data row50 col14" >0.965754</td>
      <td id="T_bb2fb_row50_col15" class="data row50 col15" >0.976372</td>
      <td id="T_bb2fb_row50_col16" class="data row50 col16" >-0.592472</td>
      <td id="T_bb2fb_row50_col17" class="data row50 col17" >0.987502</td>
      <td id="T_bb2fb_row50_col18" class="data row50 col18" >4</td>
      <td id="T_bb2fb_row50_col19" class="data row50 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row51" class="row_heading level0 row51" >KIF4A</th>
      <td id="T_bb2fb_row51_col0" class="data row51 col0" >-0.257297</td>
      <td id="T_bb2fb_row51_col1" class="data row51 col1" >-0.252338</td>
      <td id="T_bb2fb_row51_col2" class="data row51 col2" >-0.317735</td>
      <td id="T_bb2fb_row51_col3" class="data row51 col3" >0.111547</td>
      <td id="T_bb2fb_row51_col4" class="data row51 col4" >-0.416171</td>
      <td id="T_bb2fb_row51_col5" class="data row51 col5" >-0.416843</td>
      <td id="T_bb2fb_row51_col6" class="data row51 col6" >-0.478815</td>
      <td id="T_bb2fb_row51_col7" class="data row51 col7" >0.067665</td>
      <td id="T_bb2fb_row51_col8" class="data row51 col8" >-0.644237</td>
      <td id="T_bb2fb_row51_col9" class="data row51 col9" >0.345383</td>
      <td id="T_bb2fb_row51_col10" class="data row51 col10" >nan</td>
      <td id="T_bb2fb_row51_col11" class="data row51 col11" >nan</td>
      <td id="T_bb2fb_row51_col12" class="data row51 col12" >-0.659569</td>
      <td id="T_bb2fb_row51_col13" class="data row51 col13" >-0.558404</td>
      <td id="T_bb2fb_row51_col14" class="data row51 col14" >-0.694862</td>
      <td id="T_bb2fb_row51_col15" class="data row51 col15" >0.211410</td>
      <td id="T_bb2fb_row51_col16" class="data row51 col16" >0.619611</td>
      <td id="T_bb2fb_row51_col17" class="data row51 col17" >-0.955320</td>
      <td id="T_bb2fb_row51_col18" class="data row51 col18" >4</td>
      <td id="T_bb2fb_row51_col19" class="data row51 col19" >4</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row52" class="row_heading level0 row52" >WDR18</th>
      <td id="T_bb2fb_row52_col0" class="data row52 col0" >0.218228</td>
      <td id="T_bb2fb_row52_col1" class="data row52 col1" >0.007275</td>
      <td id="T_bb2fb_row52_col2" class="data row52 col2" >0.138607</td>
      <td id="T_bb2fb_row52_col3" class="data row52 col3" >0.354514</td>
      <td id="T_bb2fb_row52_col4" class="data row52 col4" >0.217249</td>
      <td id="T_bb2fb_row52_col5" class="data row52 col5" >0.328759</td>
      <td id="T_bb2fb_row52_col6" class="data row52 col6" >-0.769249</td>
      <td id="T_bb2fb_row52_col7" class="data row52 col7" >0.188621</td>
      <td id="T_bb2fb_row52_col8" class="data row52 col8" >-0.098427</td>
      <td id="T_bb2fb_row52_col9" class="data row52 col9" >0.709124</td>
      <td id="T_bb2fb_row52_col10" class="data row52 col10" >nan</td>
      <td id="T_bb2fb_row52_col11" class="data row52 col11" >nan</td>
      <td id="T_bb2fb_row52_col12" class="data row52 col12" >0.132233</td>
      <td id="T_bb2fb_row52_col13" class="data row52 col13" >0.162242</td>
      <td id="T_bb2fb_row52_col14" class="data row52 col14" >0.335389</td>
      <td id="T_bb2fb_row52_col15" class="data row52 col15" >-0.319678</td>
      <td id="T_bb2fb_row52_col16" class="data row52 col16" >0.829313</td>
      <td id="T_bb2fb_row52_col17" class="data row52 col17" >-0.289306</td>
      <td id="T_bb2fb_row52_col18" class="data row52 col18" >5</td>
      <td id="T_bb2fb_row52_col19" class="data row52 col19" >5</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row53" class="row_heading level0 row53" >FLYWCH2</th>
      <td id="T_bb2fb_row53_col0" class="data row53 col0" >0.755016</td>
      <td id="T_bb2fb_row53_col1" class="data row53 col1" >0.476263</td>
      <td id="T_bb2fb_row53_col2" class="data row53 col2" >0.889170</td>
      <td id="T_bb2fb_row53_col3" class="data row53 col3" >0.805521</td>
      <td id="T_bb2fb_row53_col4" class="data row53 col4" >0.734781</td>
      <td id="T_bb2fb_row53_col5" class="data row53 col5" >0.720826</td>
      <td id="T_bb2fb_row53_col6" class="data row53 col6" >0.871801</td>
      <td id="T_bb2fb_row53_col7" class="data row53 col7" >0.714895</td>
      <td id="T_bb2fb_row53_col8" class="data row53 col8" >0.570247</td>
      <td id="T_bb2fb_row53_col9" class="data row53 col9" >0.933310</td>
      <td id="T_bb2fb_row53_col10" class="data row53 col10" >nan</td>
      <td id="T_bb2fb_row53_col11" class="data row53 col11" >nan</td>
      <td id="T_bb2fb_row53_col12" class="data row53 col12" >0.648702</td>
      <td id="T_bb2fb_row53_col13" class="data row53 col13" >0.538246</td>
      <td id="T_bb2fb_row53_col14" class="data row53 col14" >0.480313</td>
      <td id="T_bb2fb_row53_col15" class="data row53 col15" >0.628604</td>
      <td id="T_bb2fb_row53_col16" class="data row53 col16" >-0.158622</td>
      <td id="T_bb2fb_row53_col17" class="data row53 col17" >0.703576</td>
      <td id="T_bb2fb_row53_col18" class="data row53 col18" >5</td>
      <td id="T_bb2fb_row53_col19" class="data row53 col19" >5</td>
    </tr>
    <tr>
      <th id="T_bb2fb_level0_row54" class="row_heading level0 row54" >DNAJA4</th>
      <td id="T_bb2fb_row54_col0" class="data row54 col0" >-0.595016</td>
      <td id="T_bb2fb_row54_col1" class="data row54 col1" >-0.506425</td>
      <td id="T_bb2fb_row54_col2" class="data row54 col2" >-0.804084</td>
      <td id="T_bb2fb_row54_col3" class="data row54 col3" >0.058263</td>
      <td id="T_bb2fb_row54_col4" class="data row54 col4" >-0.381985</td>
      <td id="T_bb2fb_row54_col5" class="data row54 col5" >-0.555050</td>
      <td id="T_bb2fb_row54_col6" class="data row54 col6" >0.542100</td>
      <td id="T_bb2fb_row54_col7" class="data row54 col7" >0.606794</td>
      <td id="T_bb2fb_row54_col8" class="data row54 col8" >-0.092005</td>
      <td id="T_bb2fb_row54_col9" class="data row54 col9" >0.113192</td>
      <td id="T_bb2fb_row54_col10" class="data row54 col10" >nan</td>
      <td id="T_bb2fb_row54_col11" class="data row54 col11" >nan</td>
      <td id="T_bb2fb_row54_col12" class="data row54 col12" >-0.681984</td>
      <td id="T_bb2fb_row54_col13" class="data row54 col13" >-0.117238</td>
      <td id="T_bb2fb_row54_col14" class="data row54 col14" >-0.445367</td>
      <td id="T_bb2fb_row54_col15" class="data row54 col15" >-0.354684</td>
      <td id="T_bb2fb_row54_col16" class="data row54 col16" >0.471298</td>
      <td id="T_bb2fb_row54_col17" class="data row54 col17" >-0.166946</td>
      <td id="T_bb2fb_row54_col18" class="data row54 col18" >6</td>
      <td id="T_bb2fb_row54_col19" class="data row54 col19" >6</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="id2">
<h3>Error plot<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Metrics</span><span class="p">()</span>
<span class="n">test_metrics</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">add_metrics</span><span class="p">(</span>
    <span class="n">pred_test</span><span class="p">[[</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">TOP_N_ORDER</span><span class="p">]],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;test data&#39;</span><span class="p">)</span>
<span class="n">test_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_metrics</span><span class="p">)[</span><span class="n">TOP_N_ORDER</span><span class="p">]</span>
<span class="n">test_metrics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Selected as truth to compare to: observed
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MSE</th>
      <td>0.507</td>
      <td>0.535</td>
      <td>0.528</td>
      <td>0.534</td>
      <td>0.534</td>
    </tr>
    <tr>
      <th>MAE</th>
      <td>0.474</td>
      <td>0.521</td>
      <td>0.508</td>
      <td>0.513</td>
      <td>0.506</td>
    </tr>
    <tr>
      <th>N</th>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
      <td>859.000</td>
    </tr>
    <tr>
      <th>prop</th>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_in_comparison</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">test_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">n_in_comparison</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>859
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_to_plot</span> <span class="o">=</span> <span class="n">test_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">METRIC</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">_to_plot</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="n">_to_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Gene Names</th>
      <td>0.474</td>
      <td>0.521</td>
      <td>0.508</td>
      <td>0.513</td>
      <td>0.506</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">model_configs</span><span class="p">[[</span><span class="s2">&quot;latent_dim&quot;</span><span class="p">,</span> <span class="s2">&quot;hidden_layers&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">build_text</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No PIMMS models in comparsion. Using empty text&quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">model_configs</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
<span class="n">_to_plot</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">_to_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRKNN</th>
      <th>DAE</th>
      <th>RF</th>
      <th>KNN</th>
      <th>KNN_IMPUTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Gene Names</th>
      <td>0.474</td>
      <td>0.521</td>
      <td>0.508</td>
      <td>0.513</td>
      <td>0.506</td>
    </tr>
    <tr>
      <th>text</th>
      <td></td>
      <td>LD: 10 HL: 512</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># size of the plot can be adjusted</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">METRIC</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">FEAT_NAME_DISPLAY</span><span class="si">}</span><span class="se">\n</span><span class="s2">(</span><span class="si">{</span><span class="n">n_in_comparison</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> intensities)&quot;</span><span class="p">,</span>
    <span class="c1"># title=f&#39;performance on test data (based on {n_in_comparison:,} measurements)&#39;,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">COLORS_TO_USE</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">add_height_to_barplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">add_text_to_barplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_performance_test.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_performance_test.pdf
</pre></div>
</div>
<img alt="_images/134be4a94cc86683556b1b16d5e474631173a4a3c252798f266ef0268e744f1e.png" src="_images/134be4a94cc86683556b1b16d5e474631173a4a3c252798f266ef0268e744f1e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
<span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">T</span>
<span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot_long</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s1">&#39;metric_value&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_to_plot_long</span><span class="p">[</span><span class="s1">&#39;data level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature_names</span><span class="o">.</span><span class="n">name</span>
<span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot_long</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;data level&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_to_plot_long</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-error-by-median-feature-intensity">
<h3>Plot error by median feature intensity<a class="headerlink" href="#plot-error-by-median-feature-intensity" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">make_large_descriptors</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">ax</span><span class="p">,</span> <span class="n">errors_binned</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">plot_errors_by_median</span><span class="p">(</span>
    <span class="n">pred</span><span class="o">=</span><span class="n">pred_test</span><span class="p">[</span>
        <span class="p">[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">TOP_N_ORDER</span>
    <span class="p">],</span>
    <span class="n">feat_medians</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
    <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">COLORS_TO_USE</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">TOP_N_ORDER</span><span class="p">))</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">make_large_descriptors</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_test_errors_binned_by_feat_medians.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>

<span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
<span class="n">errors_binned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
<span class="n">errors_binned</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_test_errors_binned_by_feat_medians.pdf
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th>model</th>
      <th>MAE</th>
      <th>bin</th>
      <th>n_obs</th>
      <th>intensity binned by median of Gene Names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>TRKNN</td>
      <td>3.276</td>
      <td>26</td>
      <td>173</td>
      <td>26\n(N=173)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>DAE</td>
      <td>2.890</td>
      <td>26</td>
      <td>173</td>
      <td>26\n(N=173)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>RF</td>
      <td>3.095</td>
      <td>26</td>
      <td>173</td>
      <td>26\n(N=173)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>KNN</td>
      <td>2.614</td>
      <td>26</td>
      <td>173</td>
      <td>26\n(N=173)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>KNN_IMPUTE</td>
      <td>3.388</td>
      <td>26</td>
      <td>173</td>
      <td>26\n(N=173)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4,290</th>
      <td>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SH3BGRL3</td>
      <td>TRKNN</td>
      <td>0.076</td>
      <td>28</td>
      <td>140</td>
      <td>28\n(N=140)</td>
    </tr>
    <tr>
      <th>4,291</th>
      <td>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SH3BGRL3</td>
      <td>DAE</td>
      <td>0.340</td>
      <td>28</td>
      <td>140</td>
      <td>28\n(N=140)</td>
    </tr>
    <tr>
      <th>4,292</th>
      <td>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SH3BGRL3</td>
      <td>RF</td>
      <td>0.052</td>
      <td>28</td>
      <td>140</td>
      <td>28\n(N=140)</td>
    </tr>
    <tr>
      <th>4,293</th>
      <td>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SH3BGRL3</td>
      <td>KNN</td>
      <td>0.550</td>
      <td>28</td>
      <td>140</td>
      <td>28\n(N=140)</td>
    </tr>
    <tr>
      <th>4,294</th>
      <td>2020_06_02_09_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SH3BGRL3</td>
      <td>KNN_IMPUTE</td>
      <td>0.044</td>
      <td>28</td>
      <td>140</td>
      <td>28\n(N=140)</td>
    </tr>
  </tbody>
</table>
<p>4295 rows  7 columns</p>
</div></div><img alt="_images/1b05a9469e36034e0879f3107b65172dc4d9fabb7e94bc09eda7f746f604623a.png" src="_images/1b05a9469e36034e0879f3107b65172dc4d9fabb7e94bc09eda7f746f604623a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ! only used for reporting</span>
<span class="n">plotted</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get_data_for_errors_by_median</span><span class="p">(</span>
    <span class="n">errors</span><span class="o">=</span><span class="n">errors_binned</span><span class="p">,</span>
    <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
    <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span>
<span class="p">)</span>
<span class="n">plotted</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plotted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bin</th>
      <th>model</th>
      <th>mean</th>
      <th>ci_low</th>
      <th>ci_high</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24\n(N=16)</td>
      <td>TRKNN</td>
      <td>0.738</td>
      <td>0.419</td>
      <td>1.079</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24\n(N=16)</td>
      <td>DAE</td>
      <td>0.885</td>
      <td>0.484</td>
      <td>1.338</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24\n(N=16)</td>
      <td>RF</td>
      <td>0.698</td>
      <td>0.430</td>
      <td>0.980</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24\n(N=16)</td>
      <td>KNN</td>
      <td>0.523</td>
      <td>0.278</td>
      <td>0.851</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24\n(N=16)</td>
      <td>KNN_IMPUTE</td>
      <td>0.982</td>
      <td>0.511</td>
      <td>1.522</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>55</th>
      <td>35\n(N=3)</td>
      <td>TRKNN</td>
      <td>0.044</td>
      <td>0.018</td>
      <td>0.074</td>
    </tr>
    <tr>
      <th>56</th>
      <td>35\n(N=3)</td>
      <td>DAE</td>
      <td>0.209</td>
      <td>0.021</td>
      <td>0.340</td>
    </tr>
    <tr>
      <th>57</th>
      <td>35\n(N=3)</td>
      <td>RF</td>
      <td>0.097</td>
      <td>0.006</td>
      <td>0.184</td>
    </tr>
    <tr>
      <th>58</th>
      <td>35\n(N=3)</td>
      <td>KNN</td>
      <td>0.131</td>
      <td>0.090</td>
      <td>0.164</td>
    </tr>
    <tr>
      <th>59</th>
      <td>35\n(N=3)</td>
      <td>KNN_IMPUTE</td>
      <td>1.420</td>
      <td>1.135</td>
      <td>1.791</td>
    </tr>
  </tbody>
</table>
<p>60 rows  5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">errors_binned</span>
 <span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
     <span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">errors_binned</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
 <span class="p">)</span>
 <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ORDER_MODELS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">METRIC</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th>MAE</th>
      <th>bin</th>
      <th>n_obs</th>
    </tr>
    <tr>
      <th>intensity binned by median of Gene Names</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30\n(N=65)</th>
      <td>2019_12_19_19_48_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ERP29</td>
      <td>0.000</td>
      <td>30</td>
      <td>65</td>
    </tr>
    <tr>
      <th>28\n(N=140)</th>
      <td>2020_05_04_11_39_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>NUP153</td>
      <td>0.001</td>
      <td>28</td>
      <td>140</td>
    </tr>
    <tr>
      <th>28\n(N=140)</th>
      <td>2020_05_14_14_46_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>LIG3</td>
      <td>0.002</td>
      <td>28</td>
      <td>140</td>
    </tr>
    <tr>
      <th>31\n(N=64)</th>
      <td>2020_02_13_03_11_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>CKAP4</td>
      <td>0.002</td>
      <td>31</td>
      <td>64</td>
    </tr>
    <tr>
      <th>29\n(N=90)</th>
      <td>2020_01_08_16_43_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>PSMD14</td>
      <td>0.002</td>
      <td>29</td>
      <td>90</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>26\n(N=173)</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>3.276</td>
      <td>26</td>
      <td>173</td>
    </tr>
    <tr>
      <th>27\n(N=160)</th>
      <td>2019_12_29_18_18_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>SUMO3</td>
      <td>3.525</td>
      <td>27</td>
      <td>160</td>
    </tr>
    <tr>
      <th>25\n(N=91)</th>
      <td>2020_05_28_04_06_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>PRRC2B</td>
      <td>3.527</td>
      <td>25</td>
      <td>91</td>
    </tr>
    <tr>
      <th>27\n(N=160)</th>
      <td>2020_01_03_20_10_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>DENR</td>
      <td>3.750</td>
      <td>27</td>
      <td>160</td>
    </tr>
    <tr>
      <th>26\n(N=173)</th>
      <td>2020_02_10_15_41_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>UTRN</td>
      <td>4.243</td>
      <td>26</td>
      <td>173</td>
    </tr>
  </tbody>
</table>
<p>859 rows  5 columns</p>
</div></div></div>
</div>
</section>
<section id="custom-model-selection">
<h3>Custom model selection<a class="headerlink" href="#custom-model-selection" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">SEL_MODELS</span><span class="p">:</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Metrics</span><span class="p">()</span>
    <span class="n">test_metrics</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">add_metrics</span><span class="p">(</span>
        <span class="n">pred_test</span><span class="p">[[</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">SEL_MODELS</span><span class="p">]],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;test data&#39;</span><span class="p">)</span>
    <span class="n">test_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_metrics</span><span class="p">)[</span><span class="n">SEL_MODELS</span><span class="p">]</span>
    <span class="n">test_metrics</span>

    <span class="n">n_in_comparison</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">test_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">n_in_comparison</span>

    <span class="n">_to_plot</span> <span class="o">=</span> <span class="n">test_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">METRIC</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
    <span class="n">_to_plot</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="n">_to_plot</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">model_configs</span><span class="p">[[</span><span class="s2">&quot;latent_dim&quot;</span><span class="p">,</span> <span class="s2">&quot;hidden_layers&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">build_text</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No PIMMS models in comparsion. Using empty text&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">model_configs</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
    <span class="n">_to_plot</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">_to_plot</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">METRIC</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">FEAT_NAME_DISPLAY</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">n_in_comparison</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> intensities)&quot;</span><span class="p">,</span>
        <span class="c1"># title=f&#39;performance on test data (based on {n_in_comparison:,} measurements)&#39;,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">assign_colors</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">SEL_MODELS</span><span class="p">)),</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">SEL_MODELS</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">add_height_to_barplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">add_text_to_barplot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_performance_test_sel.pdf&#39;</span>
    <span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
    <span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot</span><span class="o">.</span><span class="n">T</span>
    <span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot_long</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="p">{</span><span class="n">feature_names</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="s1">&#39;metric_value&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_to_plot_long</span><span class="p">[</span><span class="s1">&#39;data level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature_names</span><span class="o">.</span><span class="n">name</span>
    <span class="n">_to_plot_long</span> <span class="o">=</span> <span class="n">_to_plot_long</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;data level&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_to_plot_long</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># custom selection</span>
<span class="k">if</span> <span class="n">SEL_MODELS</span><span class="p">:</span>
    <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">make_large_descriptors</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">errors_binned</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">plot_errors_by_median</span><span class="p">(</span>
        <span class="n">pred</span><span class="o">=</span><span class="n">pred_test</span><span class="p">[</span>
            <span class="p">[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">SEL_MODELS</span>
        <span class="p">],</span>
        <span class="n">feat_medians</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">train_X</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span><span class="p">,</span>
        <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">assign_colors</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">SEL_MODELS</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="c1"># ax.set_ylim(0, 1.5)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">SEL_MODELS</span><span class="p">))</span>
    <span class="c1"># for text in ax.legend().get_texts():</span>
    <span class="c1">#     text.set_fontsize(6)</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_test_errors_binned_by_feat_medians_sel.pdf&#39;</span>
    <span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
    <span class="n">errors_binned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
    <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">make_large_descriptors</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="c1"># ax.xaxis.set_tick_params(rotation=0) # horizontal</span>

    <span class="c1"># ! only used for reporting</span>
    <span class="n">plotted</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get_data_for_errors_by_median</span><span class="p">(</span>
        <span class="n">errors</span><span class="o">=</span><span class="n">errors_binned</span><span class="p">,</span>
        <span class="n">feat_name</span><span class="o">=</span><span class="n">FEAT_NAME_DISPLAY</span><span class="p">,</span>
        <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span>
    <span class="p">)</span>
    <span class="n">plotted</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">plotted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>Error by non-decimal number of intensity<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>number of observations in parentheses.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">,</span> <span class="n">errors_binned</span> <span class="o">=</span> <span class="n">vaep</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">plot_errors_binned</span><span class="p">(</span>
    <span class="n">pred_test</span><span class="p">[</span>
        <span class="p">[</span><span class="n">TARGET_COL</span><span class="p">]</span> <span class="o">+</span> <span class="n">TOP_N_ORDER</span>
    <span class="p">],</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">TOP_N_COLOR_PALETTE</span><span class="p">,</span>
    <span class="n">metric_name</span><span class="o">=</span><span class="n">METRIC</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">TOP_N_ORDER</span><span class="p">))</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">out_figures</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;2_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1">_test_errors_binned_by_int.pdf&#39;</span>
<span class="n">figures</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span>
<span class="n">vaep</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vaep.plotting - INFO     Saved Figures to runs/example/figures/2_1_test_errors_binned_by_int.pdf
</pre></div>
</div>
<img alt="_images/c1843647e717b4f83451bfe4b40f009eded38d0be1bfa74d96d103707af16413.png" src="_images/c1843647e717b4f83451bfe4b40f009eded38d0be1bfa74d96d103707af16413.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dumps</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
<span class="n">errors_binned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
<span class="n">errors_binned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Gene Names</th>
      <th>model</th>
      <th>MAE</th>
      <th>intensity bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>TRKNN</td>
      <td>3.276</td>
      <td>23\n(N=21)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>DAE</td>
      <td>2.890</td>
      <td>23\n(N=21)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>RF</td>
      <td>3.095</td>
      <td>23\n(N=21)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>KNN</td>
      <td>2.614</td>
      <td>23\n(N=21)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019_12_18_14_35_Q-Exactive-HF-X-Orbitrap_6070</td>
      <td>ARAF</td>
      <td>KNN_IMPUTE</td>
      <td>3.388</td>
      <td>23\n(N=21)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="figures-dumped-to-disk">
<h2>Figures dumped to disk<a class="headerlink" href="#figures-dumped-to-disk" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;2_1_fake_na_val_test_splits&#39;: Path(&#39;runs/example/figures/2_1_fake_na_val_test_splits.png&#39;),
 &#39;2_1_pred_corr_val_per_sample&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_val_per_sample.pdf&#39;),
 &#39;2_1_errors_binned_by_feat_median_val&#39;: Path(&#39;runs/example/figures/2_1_errors_binned_by_feat_median_val.pdf&#39;),
 &#39;2_1_intensity_binned_top_4_models_test&#39;: Path(&#39;runs/example/figures/2_1_intensity_binned_top_4_models_test.pdf&#39;),
 &#39;2_1_pred_corr_test_per_sample&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_test_per_sample.pdf&#39;),
 &#39;2_1_pred_corr_test_per_feat&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_test_per_feat.pdf&#39;),
 &#39;2_1_performance_test&#39;: Path(&#39;runs/example/figures/2_1_performance_test.pdf&#39;),
 &#39;2_1_test_errors_binned_by_feat_medians&#39;: Path(&#39;runs/example/figures/2_1_test_errors_binned_by_feat_medians.pdf&#39;),
 &#39;2_1_test_errors_binned_by_int&#39;: Path(&#39;runs/example/figures/2_1_test_errors_binned_by_int.pdf&#39;)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dumps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;01_2_performance_summary&#39;: Path(&#39;runs/example/01_2_performance_summary.xlsx&#39;),
 &#39;2_1_pred_corr_val_per_sample&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_val_per_sample.xlsx&#39;),
 &#39;2_1_errors_binned_by_feat_median_val&#39;: Path(&#39;runs/example/figures/2_1_errors_binned_by_feat_median_val.csv&#39;),
 &#39;2_1_pred_corr_test_per_sample&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_test_per_sample.xlsx&#39;),
 &#39;2_1_pred_corr_test_per_feat&#39;: Path(&#39;runs/example/figures/2_1_pred_corr_test_per_feat.xlsx&#39;),
 &#39;2_1_performance_test&#39;: Path(&#39;runs/example/figures/2_1_performance_test.csv&#39;),
 &#39;2_1_test_errors_binned_by_feat_medians&#39;: Path(&#39;runs/example/figures/2_1_test_errors_binned_by_feat_medians.csv&#39;),
 &#39;2_1_test_errors_binned_by_int&#39;: Path(&#39;runs/example/figures/2_1_test_errors_binned_by_int.csv&#39;)}
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_1_train_NAGuideR_TRKNN.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">NAGuide R methods</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Compare models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-completeness-across-entire-data">data completeness across entire data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-specifications">Model specifications</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-predictions-on-validation-and-test-data-split">Load predictions on validation and test data split</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-data">Validation data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-top-n-for-plotting-and-set-colors">Select top N for plotting and set colors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-per-sample">Correlation per sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-plot">Error plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-by-non-decimal-number-of-intensity">Error by non-decimal number of intensity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-data">test data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intensity-distribution-as-histogram">Intensity distribution as histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Correlation per sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-per-feature">Correlation per feature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Error plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-error-by-median-feature-intensity">Plot error by median feature intensity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-model-selection">Custom model selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Error by non-decimal number of intensity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figures-dumped-to-disk">Figures dumped to disk</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PIMMS
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023, Henry Webel.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>